<!DOCTYPE html>
<html class="writer-html5" lang="pt-BR" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.3. A Linguagem de Programação Python &mdash; GeoCreditoRural</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/table_styling.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tutorial.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://geo-credito-rural.github.io/jupyter/python.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/translations.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Buscar" href="../search.html" />
    <link rel="next" title="3. Dados do Sicor" href="../sicor/index.html" />
    <link rel="prev" title="2.2. Jupyter Notebooks" href="notebooks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F0F8FF" >

          
          
          <a href="../index.html" class="icon icon-home">
            GeoCreditoRural
              <img src="../_static/logo.jpeg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Pesquisar documentos" aria-label="Pesquisar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Menu de navegação">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Monitoramento de Operações de Crédito Rural por meio de Geotecnologias</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Aulas:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../sql/index.html">1. Introdução à Linguagem de Consulta SQL</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">2. Ambiente de Computação Interativa</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introducao.html">2.1. Introdução</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks.html">2.2. Jupyter Notebooks</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.3. A Linguagem de Programação Python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#computando-ndvi">2.3.1. Computando NDVI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pandas">2.3.2. Pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usando-o-pandas">2.3.3. Usando o Pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="#criando-uma-serie">2.3.4. Criando uma Série</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selecionando-valores-da-serie">2.3.5. Selecionando Valores da Série</a></li>
<li class="toctree-l3"><a class="reference internal" href="#acessando-a-estrutura-de-uma-serie">2.3.6. Acessando a Estrutura de uma Série</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ordenando-os-valores-de-uma-serie">2.3.7. Ordenando os Valores de uma Série</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotando-uma-serie">2.3.8. Plotando uma Série</a></li>
<li class="toctree-l3"><a class="reference internal" href="#criando-um-dataframe">2.3.9. Criando um <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selecionando-colunas-de-um-dataframe">2.3.10. Selecionando Colunas de um <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#acessando-a-estrutura-de-um-dataframe">2.3.11. Acessando a Estrutura de um <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selecionando-valores-do-dataframe">2.3.12. Selecionando valores do <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#iterando-nas-colunas-e-linhas-de-um-dataframe">2.3.13. Iterando nas colunas e linhas de um <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#construindo-mascaras-booleanas-para-selecao-de-linhas">2.3.14. Construindo máscaras booleanas para seleção de linhas</a></li>
<li class="toctree-l3"><a class="reference internal" href="#leitura-de-arquivos-csv">2.3.15. Leitura de Arquivos CSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analise-de-dados-com-o-pandas">2.3.16. Análise de Dados com o Pandas</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sicor/index.html">3. Dados do Sicor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bases-vetoriais/index.html">4. Impedimentos Sociais, Ambientais e Climáticos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uso-cobertura-terra/index.html">5. Uso e Cobertura da Terra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acesso-imagens/index.html">6. Imagens de Satélites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../series-temporais/index.html">7. Séries Temporais de Imagens de Satélites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fenologia/index.html">8. Fenologia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../padroes-series-temporais/index.html">9. Padrões em Séries Temporais de Imagens de Satélites</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Referências Bibliográficas</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../referencias.html">Referências Bibliográficas</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Informações Gerais:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../licenca.html">Licença</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agradecimentos.html">Agradecimentos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Índice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossário</a></li>
<li class="toctree-l1"><a class="reference internal" href="../search.html">Página de Busca</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Menu de navegação móvel"  style="background: #F0F8FF" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GeoCreditoRural</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Navegação da página">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">2. </span>Ambiente de Computação Interativa</a></li>
      <li class="breadcrumb-item active"><span class="section-number">2.3. </span>A Linguagem de Programação Python</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Navegação sequencial da página">
        <a href="notebooks.html" class="btn btn-neutral float-left" title="2.2. Jupyter Notebooks" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="../sicor/index.html" class="btn btn-neutral float-right" title="3. Dados do Sicor" accesskey="n">Próximo <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="a-linguagem-de-programacao-python">
<span id="sec-jupyter-python"></span><h1><span class="section-number">2.3. </span>A Linguagem de Programação Python<a class="headerlink" href="#a-linguagem-de-programacao-python" title="Link permanente para este cabeçalho"></a></h1>
<p>A linguagem Python foi criada originalmente por Guido Van Rossum <span id="id1">[<a class="reference internal" href="../referencias.html#id157" title="G. van Rossum. Python tutorial. Technical Report CS-R9526, Centrum voor Wiskunde en Informatica (CWI), Amsterdam, May 1995. URL: https://ir.cwi.nl/pub/5007/05007D.pdf.">21</a>]</span>. Atualmente, seu desenvolvimento é coordenado através de uma fundação chamada <a class="reference external" href="https://www.python.org/psf-landing/">Python Software Foundation</a>, sob uma licença de código aberto. Pode ser classificada como uma linguagem de <em>script</em>, orientada a objetos e interpretada. A implementação oficial encontra-se disponível para as plataformas computacionais mais comuns no site <a class="reference external" href="https://www.python.org/">https://www.python.org/</a>.</p>
<p>O <strong>core</strong> desta linguagem, descrito em <span id="id2">[<a class="reference internal" href="../referencias.html#id158" title="Python Software Foundation. The python language reference. 2021. Online; acessado 07 de Março de 2021. URL: https://docs.python.org/3/reference/index.html.">22</a>]</span>, contém a gramática com as regras sintáticas e semânticas da linguagem, além das abstrações básicas tais como tipos de dados numéricos, sequências, dicionários, estruturas de repetição, comandos de decisão, funções, construtor de novos tipos (<code class="docutils literal notranslate"><span class="pre">class</span></code>), blocos para tratamento de exceções, entre outras abstrações.</p>
<p>A <strong>biblioteca padrão</strong> (<em>standard library</em>), descrita em <span id="id3">[<a class="reference internal" href="../referencias.html#id159" title="Python Software Foundation. The python standard library. 2021. Online; acessado 07 de Março de 2021. URL: https://docs.python.org/3/library/index.html.">23</a>]</span>, fornece inúmeros tipos de dados e funcionalidades, como tipos para manipulação de data e hora, manipulação de arquivos, comunicação em rede, entre outros.</p>
<p>Python apresenta as seguintes características:</p>
<ul class="open">
<li><p>Possui um sistema de tipos dinâmicos, ou seja, realiza checagem de tipos durante a execução dos programas.</p></li>
<li><p>Gerenciamento automático de memória (<em>garbage collector</em>).</p></li>
<li><p>A linguagem contém um conjunto básico de abstrações poderosas: sequências (listas e tuplas), dicionários (<em>hashes</em>), funções e classes.</p></li>
<li><p>Suporta orientação a objetos.</p></li>
<li><p>Possui mecanismo para tratamento de exceções.</p></li>
<li><p>Permite expressar conceitos e computações em poucas linhas de código.</p></li>
<li><p>Oferece uma notação inspirada na linguagem Haskell conhecida como <strong>list comprehensions</strong>, que é bastante poderosa para criar objetos como listas e dicionários.</p></li>
<li><p>Possui uma grande quantidade de bibliotecas de código aberto que cobrem um grande espectro de funcionalidades.</p></li>
<li><p>É extensível.</p></li>
<li><p>Suporta diversos paradigmas de programação: estruturado, orientado a objetos, funcional.</p></li>
</ul>
<section id="computando-ndvi">
<h2><span class="section-number">2.3.1. </span>Computando NDVI<a class="headerlink" href="#computando-ndvi" title="Link permanente para este cabeçalho"></a></h2>
<p>O índice de vegetação por diferença normalizada, conhecido como <strong>Normalized Difference Vegetation Index</strong> (<strong>NDVI</strong>), pode ser computado usando a reflectância das bandas do vermelho (<em>red</em>) e infravermelho próximo (<em>nir</em>), como mostrado na <a class="reference internal" href="#equation-eq-jupyter-ndvi">Equação 2.1</a>:</p>
<div class="math notranslate nohighlight" id="equation-eq-jupyter-ndvi">
<span class="eqno">(2.1)<a class="headerlink" href="#equation-eq-jupyter-ndvi" title="Link permanente para essa equação"></a></span>\[NDVI = \frac{\rho_{nir} - \rho_{red}}{\rho_{nir} + \rho_{red}}\]</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>A <a class="reference internal" href="#equation-eq-jupyter-ndvi">Equação 2.1</a> produz valores que variam entre <span class="math notranslate nohighlight">\(-1.0\)</span> a <span class="math notranslate nohighlight">\(1.0\)</span>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Dica</p>
<p>Para mais detalhes sobre o NDVI, consulte o Capítulo 11 em <span id="id4">[<a class="reference internal" href="../referencias.html#id160" title="John R. Jensen. Sensoriamento remoto da vegetação. In Keith C. Clarke, editor, Sensoriamento Remoto do Ambiente, chapter 11, pages 357–410. Parêntese Editora, São José dos Campos, São Paulo, Brasil, 2009.">24</a>]</span>.</p>
</div>
<p><strong>Exercício:</strong> Escrever um programa para computar o NDVI a partir dos valores de reflectância: <span class="math notranslate nohighlight">\(\rho_{red}=168\)</span> e <span class="math notranslate nohighlight">\(\rho_{nir}=2346\)</span>.</p>
<details class="summary-solucao">
<summary>Solução:</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">red</span> <span class="o">=</span> <span class="mi">168</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="n">nir</span> <span class="o">=</span> <span class="mi">2346</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="n">ndvi</span> <span class="o">=</span> <span class="p">(</span><span class="n">nir</span> <span class="o">-</span> <span class="n">red</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nir</span> <span class="o">+</span> <span class="n">red</span><span class="p">)</span>
<span class="linenos">6</span>
<span class="linenos">7</span><span class="nb">print</span><span class="p">(</span><span class="n">red</span><span class="p">,</span> <span class="n">nir</span><span class="p">,</span> <span class="n">ndvi</span><span class="p">)</span>
</pre></div>
</div>
</details></section>
<section id="pandas">
<h2><span class="section-number">2.3.2. </span>Pandas<a class="headerlink" href="#pandas" title="Link permanente para este cabeçalho"></a></h2>
<a class="reference internal image-reference" href="../_images/pandas.svg"><img alt="Pandas" class="align-right" src="../_images/pandas.svg" width="125" /></a>
<p>O Pandas fornece duas estruturas de dados básicas: <code class="docutils literal notranslate"><span class="pre">Series</span></code> e <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, ambas apoiadas na estrutura <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> da biblioteca NumPy. Para estas estruturas, existem diversas operações de alto nível disponíveis, tais como agregação de valores e visualização básica através da Matplotlib.</p>
<p>Um objeto do tipo <code class="docutils literal notranslate"><span class="pre">Series</span></code> representa um vetor (ou <em>array</em> unidimensional) capaz de armazenar qualquer tipo de dado, como números inteiros, strings ou objetos como data e hora. Uma <strong>série</strong> possui <strong>dois eixos</strong> (<code class="docutils literal notranslate"><span class="pre">axis</span></code>), um usado para rotular cada valor do vetor (linhas) e outro para rotular os valores das séries (colunas). Os rótulos do <code class="docutils literal notranslate"><span class="pre">eixo-0</span></code> funcionam como um índice para os valores da série. O rótulo do <code class="docutils literal notranslate"><span class="pre">eixo-1</span></code> se refere à coluna com os valores da série. A <a class="reference internal" href="#tbl-jupyter-series"><span class="std std-numref">Tabela 2.1</span></a> apresenta as características dessa estrutura de dados. Repare que há um eixo numérico na primeira coluna, com valores no intervalo <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">4]</span></code>, que forma a base de indexação dos valores da série (nomes de munícipio), e cuja coluna (<code class="docutils literal notranslate"><span class="pre">eixo-1</span></code>) possui um rótulo chamado <code class="docutils literal notranslate"><span class="pre">reb_bacen</span></code>.</p>
<table class="styled-table docutils align-center" id="tbl-jupyter-series">
<caption><span class="caption-number">Tabela 2.1 - </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">Series</span></code></span><a class="headerlink" href="#tbl-jupyter-series" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head left-align"></th>
<th class="head left-align"><p>ref_bacen</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="left-align"><p>0</p></td>
<td class="left-align"><p>517365140</p></td>
</tr>
<tr class="row-odd"><td class="left-align"><p>1</p></td>
<td class="left-align"><p>517257321</p></td>
</tr>
<tr class="row-even"><td class="left-align"><p>2</p></td>
<td class="left-align"><p>517256416</p></td>
</tr>
<tr class="row-odd"><td class="left-align"><p>3</p></td>
<td class="left-align"><p>517256416</p></td>
</tr>
<tr class="row-even"><td class="left-align"><p>4</p></td>
<td class="left-align"><p>517256501</p></td>
</tr>
</tbody>
</table>
<p>O segundo tipo de estrutura introduzido pelo Pandas é o <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, que representa uma matriz bidimensional, mais parecida com uma tabela, com capacidade de lidar com tipos heterogêneos, conforme mostrado na <a class="reference internal" href="#tbl-jupyter-dataframe"><span class="std std-numref">Tabela 2.2</span></a>. Essa estrutura possui eixos rotulados (linhas e colunas). O <code class="docutils literal notranslate"><span class="pre">eixo-0</span></code>, dos índices, refere-se à primeira coluna, com os rótulos no intervalo <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">4]</span></code>. Esses valores podem ser usados para acessar os elementos de cada linha. O <code class="docutils literal notranslate"><span class="pre">eixo-1</span></code>, das colunas, possui os rótulos: <code class="docutils literal notranslate"><span class="pre">ref_bacen</span></code>, <code class="docutils literal notranslate"><span class="pre">dt_emissao</span></code>, <code class="docutils literal notranslate"><span class="pre">dt_vencimento</span></code>, <code class="docutils literal notranslate"><span class="pre">cd_estado</span></code> e <code class="docutils literal notranslate"><span class="pre">vl_parc_credito</span></code>. Os rótulos do <code class="docutils literal notranslate"><span class="pre">eixo-1</span></code> se referem à identificação das séries das colunas.</p>
<table class="styled-table docutils align-center" id="tbl-jupyter-dataframe">
<caption><span class="caption-number">Tabela 2.2 - </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></span><a class="headerlink" href="#tbl-jupyter-dataframe" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head left-align"></th>
<th class="head left-align"><p>ref_bacen</p></th>
<th class="head left-align"><p>dt_emissao</p></th>
<th class="head left-align"><p>dt_vencimento</p></th>
<th class="head left-align"><p>cd_estado</p></th>
<th class="head left-align"><p>vl_parc_credito</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="left-align"><p>0</p></td>
<td class="left-align"><p>517365140</p></td>
<td class="left-align"><p>2024-01-29</p></td>
<td class="left-align"><p>2027-01-27</p></td>
<td class="left-align"><p>PI</p></td>
<td class="left-align"><p>4000.00</p></td>
</tr>
<tr class="row-odd"><td class="left-align"><p>1</p></td>
<td class="left-align"><p>517257321</p></td>
<td class="left-align"><p>2024-01-03</p></td>
<td class="left-align"><p>2027-01-03</p></td>
<td class="left-align"><p>MA</p></td>
<td class="left-align"><p>12000.00</p></td>
</tr>
<tr class="row-even"><td class="left-align"><p>2</p></td>
<td class="left-align"><p>517256416</p></td>
<td class="left-align"><p>2024-01-02</p></td>
<td class="left-align"><p>2027-01-02</p></td>
<td class="left-align"><p>MG</p></td>
<td class="left-align"><p>6000.00</p></td>
</tr>
<tr class="row-odd"><td class="left-align"><p>3</p></td>
<td class="left-align"><p>517256416</p></td>
<td class="left-align"><p>2024-01-02</p></td>
<td class="left-align"><p>2027-01-02</p></td>
<td class="left-align"><p>MG</p></td>
<td class="left-align"><p>2500.00</p></td>
</tr>
<tr class="row-even"><td class="left-align"><p>4</p></td>
<td class="left-align"><p>517256501</p></td>
<td class="left-align"><p>2024-01-03</p></td>
<td class="left-align"><p>2025-01-02</p></td>
<td class="left-align"><p>SC</p></td>
<td class="left-align"><p>61542.18</p></td>
</tr>
<tr class="row-odd"><td class="left-align"><p>5</p></td>
<td class="left-align"><p>517256502</p></td>
<td class="left-align"><p>2024-01-03</p></td>
<td class="left-align"><p>2025-01-02</p></td>
<td class="left-align"><p>SP</p></td>
<td class="left-align"><p>13327.57</p></td>
</tr>
<tr class="row-even"><td class="left-align"><p>6</p></td>
<td class="left-align"><p>517256503</p></td>
<td class="left-align"><p>2024-01-03</p></td>
<td class="left-align"><p>2024-12-23</p></td>
<td class="left-align"><p>PE</p></td>
<td class="left-align"><p>44986.50</p></td>
</tr>
<tr class="row-odd"><td class="left-align"><p>7</p></td>
<td class="left-align"><p>517256507</p></td>
<td class="left-align"><p>2024-01-03</p></td>
<td class="left-align"><p>2024-12-20</p></td>
<td class="left-align"><p>MT</p></td>
<td class="left-align"><p>38666.07</p></td>
</tr>
<tr class="row-even"><td class="left-align"><p>8</p></td>
<td class="left-align"><p>517256511</p></td>
<td class="left-align"><p>2024-01-03</p></td>
<td class="left-align"><p>2024-12-15</p></td>
<td class="left-align"><p>RS</p></td>
<td class="left-align"><p>5395.90</p></td>
</tr>
<tr class="row-odd"><td class="left-align"><p>9</p></td>
<td class="left-align"><p>517256511</p></td>
<td class="left-align"><p>2024-01-03</p></td>
<td class="left-align"><p>2024-12-15</p></td>
<td class="left-align"><p>RS</p></td>
<td class="left-align"><p>9216.72</p></td>
</tr>
</tbody>
</table>
</section>
<section id="usando-o-pandas">
<h2><span class="section-number">2.3.3. </span>Usando o Pandas<a class="headerlink" href="#usando-o-pandas" title="Link permanente para este cabeçalho"></a></h2>
<p>Por convenção importamos as funcionalidades do Pandas da seguinte forma:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</section>
<section id="criando-uma-serie">
<h2><span class="section-number">2.3.4. </span>Criando uma Série<a class="headerlink" href="#criando-uma-serie" title="Link permanente para este cabeçalho"></a></h2>
<p>Vamos criar uma série semelhante aos dados apresentados na <a class="reference internal" href="#tbl-jupyter-series"><span class="std std-numref">Tabela 2.1</span></a>, porém com os índices representados pelas letras de <code class="docutils literal notranslate"><span class="pre">a</span></code> a <code class="docutils literal notranslate"><span class="pre">e</span></code>, conforme o trecho de código abaixo:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [2]: </span><span class="n">dados</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;517365140&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;517257321&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;517256416&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;517256416&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;517256501&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span> <span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">serie</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dados</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">indices</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Operações&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>No ambiente de computação interativa do Jupyter, podemos apresentar os valores dessa série simplesmente criando uma célula com a seguinte expressão:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">serie</span>
<span class="gh">Out[5]:</span>
<span class="go">e    517365140</span>
<span class="go">b    517257321</span>
<span class="go">d    517256416</span>
<span class="go">c    517256416</span>
<span class="go">a    517256501</span>
<span class="go">Name: Operações, dtype: object</span>
</pre></div>
</div>
</section>
<section id="selecionando-valores-da-serie">
<h2><span class="section-number">2.3.5. </span>Selecionando Valores da Série<a class="headerlink" href="#selecionando-valores-da-serie" title="Link permanente para este cabeçalho"></a></h2>
<p>Podemos utilizar a função <code class="docutils literal notranslate"><span class="pre">head</span></code> para obter valores da série a partir do seu início:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">serie</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gh">Out[6]:</span>
<span class="go">e    517365140</span>
<span class="go">b    517257321</span>
<span class="go">Name: Operações, dtype: object</span>
</pre></div>
</div>
<p>A função <code class="docutils literal notranslate"><span class="pre">tail</span></code> permite obter valores ao final da série:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">serie</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gh">Out[7]:</span>
<span class="go">c    517256416</span>
<span class="go">a    517256501</span>
<span class="go">Name: Operações, dtype: object</span>
</pre></div>
</div>
<p>O <code class="docutils literal notranslate"><span class="pre">operador</span> <span class="pre">[]</span></code> (operador de indexação) permite acessar elementos específicos ou partes da série:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">serie</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="gh">Out[8]: </span><span class="go">&#39;517256501&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">serie</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gh">Out[9]:</span>
<span class="go">e    517365140</span>
<span class="go">b    517257321</span>
<span class="go">d    517256416</span>
<span class="go">Name: Operações, dtype: object</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">serie</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
<span class="gh">Out[10]:</span>
<span class="go">c    517256416</span>
<span class="go">a    517256501</span>
<span class="go">Name: Operações, dtype: object</span>
</pre></div>
</div>
<p>O atributo <code class="docutils literal notranslate"><span class="pre">loc</span></code> permite acessar grupos de valores da série (linhas) através de rótulos ou por um <em>array</em> de valores lógicos:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">serie</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="p">]</span>
<span class="gh">Out[11]:</span>
<span class="go">a    517256501</span>
<span class="go">b    517257321</span>
<span class="go">Name: Operações, dtype: object</span>
</pre></div>
</div>
<p>Vamos usar um <em>array</em> de valores lógicos para selecionar linhas alternadas da série através do atributo <code class="docutils literal notranslate"><span class="pre">loc</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">serie</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span> <span class="p">]</span>
<span class="gh">Out[12]:</span>
<span class="go">e    517365140</span>
<span class="go">d    517256416</span>
<span class="go">a    517256501</span>
<span class="go">Name: Operações, dtype: object</span>
</pre></div>
</div>
<p>A propriedade <code class="docutils literal notranslate"><span class="pre">iloc</span></code> permite a seleção dos valores da série de maneira posicional, isto é, utilizamos números inteiros para especificar uma ou mais linhas a serem selecionadas. De maneira semelhante à propriedade <code class="docutils literal notranslate"><span class="pre">loc</span></code>, aceita um <em>array</em> de valores lógicos para seleção:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [13]: </span><span class="n">serie</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="p">]</span>
<span class="gh">Out[13]:</span>
<span class="go">b    517257321</span>
<span class="go">c    517256416</span>
<span class="go">Name: Operações, dtype: object</span>
</pre></div>
</div>
</section>
<section id="acessando-a-estrutura-de-uma-serie">
<h2><span class="section-number">2.3.6. </span>Acessando a Estrutura de uma Série<a class="headerlink" href="#acessando-a-estrutura-de-uma-serie" title="Link permanente para este cabeçalho"></a></h2>
<p>Para acessar o eixo dos rótulos associados aos valores da série, utiliza-se o atributo <code class="docutils literal notranslate"><span class="pre">index</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="n">serie</span><span class="o">.</span><span class="n">index</span>
<span class="gh">Out[14]: </span><span class="go">Index([&#39;e&#39;, &#39;b&#39;, &#39;d&#39;, &#39;c&#39;, &#39;a&#39;], dtype=&#39;object&#39;)</span>
</pre></div>
</div>
<p>Os valores da série podem ser acessados na forma de um <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> do NumPy através do atributo <code class="docutils literal notranslate"><span class="pre">values</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">serie</span><span class="o">.</span><span class="n">values</span>
<span class="gh">Out[15]:</span>
<span class="go">array([&#39;517365140&#39;, &#39;517257321&#39;, &#39;517256416&#39;, &#39;517256416&#39;, &#39;517256501&#39;],</span>
<span class="go">      dtype=object)</span>
</pre></div>
</div>
<p>O retorno do atributo <code class="docutils literal notranslate"><span class="pre">values</span></code> é um <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, conforme podemos ver no exemplo abaixo:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="nb">type</span><span class="p">(</span><span class="n">serie</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="gh">Out[16]: </span><span class="go">numpy.ndarray</span>
</pre></div>
</div>
</section>
<section id="ordenando-os-valores-de-uma-serie">
<h2><span class="section-number">2.3.7. </span>Ordenando os Valores de uma Série<a class="headerlink" href="#ordenando-os-valores-de-uma-serie" title="Link permanente para este cabeçalho"></a></h2>
<p>Podemos ordenar a série pelos seus valores através da operação <code class="docutils literal notranslate"><span class="pre">sort_values</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">serie</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[17]:</span>
<span class="go">d   517256416</span>
<span class="go">c   517256416</span>
<span class="go">a   517256501</span>
<span class="go">b   517257321</span>
<span class="go">e   517365140</span>
<span class="go">Name: Operações, dtype: object</span>
</pre></div>
</div>
<p>Ou, podemos ordenar a série pelos rótulos do índice dos valores:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">serie</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="gh">Out[18]:</span>
<span class="go">a   517256501</span>
<span class="go">b   517257321</span>
<span class="go">c   517256416</span>
<span class="go">d   517256416</span>
<span class="go">e   517365140</span>
<span class="go">Name: Operações, dtype: object</span>
</pre></div>
</div>
<p>Note que as duas operações acima criam novas séries ordenadas. Para alterar a própria série, sem criar uma cópia, é necessário utilizar o parâmetro <code class="docutils literal notranslate"><span class="pre">inplace</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">serie</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">serie</span>
<span class="gh">Out[20]:</span>
<span class="go">d   517256416</span>
<span class="go">c   517256416</span>
<span class="go">a   517256501</span>
<span class="go">b   517257321</span>
<span class="go">e   517365140</span>
<span class="go">Name: Operações, dtype: object</span>
</pre></div>
</div>
</section>
<section id="plotando-uma-serie">
<h2><span class="section-number">2.3.8. </span>Plotando uma Série<a class="headerlink" href="#plotando-uma-serie" title="Link permanente para este cabeçalho"></a></h2>
<p>Podemos construir gráficos rapidamente a partir das séries. O tipo <code class="docutils literal notranslate"><span class="pre">Series</span></code> possui uma operação geral denominada <code class="docutils literal notranslate"><span class="pre">plot</span></code>. O trecho de código abaixo mostra como utilizar esta operação para apresentar um gráfico de barras com o número de empreendimentos iniciados em cada ano, ao longo do período de 1996 a 2024.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [21]: </span><span class="n">ano</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="mi">2002</span><span class="p">,</span> <span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">2017</span><span class="p">,</span> <span class="mi">2018</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2022</span><span class="p">,</span> <span class="mi">2023</span><span class="p">,</span> <span class="mi">2024</span> <span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="n">num_empreendimentos</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">373</span><span class="p">,</span> <span class="mi">147</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">65</span> <span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="n">serie_empreendimentos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">num_empreendimentos</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">ano</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;#Empreendimentos x Ano&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span><span class="n">serie_empreendimentos</span>
<span class="gh">Out[24]:</span>
<span class="go">2000    5</span>
<span class="go">2001    0</span>
<span class="go">2002    28</span>
<span class="go">2003    78</span>
<span class="go">2004    18</span>
<span class="go">2005    31</span>
<span class="go">2006    22</span>
<span class="go">2007    18</span>
<span class="go">2008    8</span>
<span class="go">2009    50</span>
<span class="go">2010    43</span>
<span class="go">2011    19</span>
<span class="go">2012    122</span>
<span class="go">2013    134</span>
<span class="go">2014    185</span>
<span class="go">2015    190</span>
<span class="go">2016    97</span>
<span class="go">2017    373</span>
<span class="go">2018    147</span>
<span class="go">2019    211</span>
<span class="go">2020    227</span>
<span class="go">2021    161</span>
<span class="go">2022    37</span>
<span class="go">2023    118</span>
<span class="go">2024    65</span>
<span class="go">Name: #Empreendimentos x Ano, dtype: int64</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [27]: </span><span class="n">serie_empreendimentos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>
</div>
<p>Saída:</p>
<a class="reference internal image-reference" href="../_images/empreendimentos-x-anos.png"><img alt="Plotando uma Série" class="align-left" src="../_images/empreendimentos-x-anos.png" style="width: 50%;" /></a>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Por padrão, o <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> utiliza a Matplotlib para gerar os gráficos. No entanto, é possível utilizar outras bibliotecas.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Consulte <a class="reference external" href="https://pandas.pydata.org/docs/reference/series.html#plotting">aqui</a> outras opções de construção de gráficos a partir de uma série.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Para saber as demais propriedades e operações disponíveis para a estrutura <code class="docutils literal notranslate"><span class="pre">Series</span></code>, consulte a seguinte documentação: <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html">pandas.Series</a>.</p>
</div>
</section>
<section id="criando-um-dataframe">
<h2><span class="section-number">2.3.9. </span>Criando um <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#criando-um-dataframe" title="Link permanente para este cabeçalho"></a></h2>
<p>Para compreender a estrutura de um <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, vamos criar um, baseando-se nos dados da <a class="reference internal" href="#tbl-jupyter-dataframe"><span class="std std-numref">Tabela 2.2</span></a>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="n">ref_bacens</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;517365140&#39;</span><span class="p">,</span> <span class="s1">&#39;517257321&#39;</span><span class="p">,</span> <span class="s1">&#39;517256416&#39;</span><span class="p">,</span> <span class="s1">&#39;517256416&#39;</span><span class="p">,</span> <span class="s1">&#39;517256501&#39;</span><span class="p">,</span> <span class="s1">&#39;517256502&#39;</span><span class="p">,</span> <span class="s1">&#39;517256503&#39;</span><span class="p">,</span> <span class="s1">&#39;517256507&#39;</span><span class="p">,</span> <span class="s1">&#39;517256511&#39;</span><span class="p">,</span> <span class="s1">&#39;517256511&#39;</span> <span class="p">]</span>

<span class="gp">In [29]: </span><span class="n">dts_emissao</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;2024-01-29&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-01-03&#39;</span> <span class="p">]</span>

<span class="gp">In [30]: </span><span class="n">dts_vencimento</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;2027-01-27&#39;</span><span class="p">,</span> <span class="s1">&#39;2027-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2027-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2027-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2025-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2025-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-12-23&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-12-20&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-12-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-12-15&#39;</span> <span class="p">]</span>

<span class="gp">In [32]: </span><span class="n">cd_estados</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;PI&#39;</span><span class="p">,</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;MG&#39;</span><span class="p">,</span> <span class="s1">&#39;MG&#39;</span><span class="p">,</span> <span class="s1">&#39;SC&#39;</span><span class="p">,</span> <span class="s1">&#39;SP&#39;</span><span class="p">,</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span> <span class="s1">&#39;MT&#39;</span><span class="p">,</span> <span class="s1">&#39;RS&#39;</span><span class="p">,</span> <span class="s1">&#39;RS&#39;</span> <span class="p">]</span>

<span class="gp">In [33]: </span><span class="n">vls_parc_credito</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;4000.00&#39;</span><span class="p">,</span> <span class="s1">&#39;12000.00&#39;</span><span class="p">,</span> <span class="s1">&#39;6000.00&#39;</span><span class="p">,</span> <span class="s1">&#39;2500.00&#39;</span><span class="p">,</span> <span class="s1">&#39;61542.18&#39;</span><span class="p">,</span> <span class="s1">&#39;13327.57&#39;</span><span class="p">,</span> <span class="s1">&#39;44986.50&#39;</span><span class="p">,</span> <span class="s1">&#39;38666.07&#39;</span><span class="p">,</span> <span class="s1">&#39;5395.90&#39;</span><span class="p">,</span> <span class="s1">&#39;9216.72&#39;</span> <span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="n">dados</span> <span class="o">=</span> <span class="p">{</span>
<span class="go">    ...:     &#39;ref_bacen&#39;: ref_bacens,</span>
<span class="go">    ...:     &#39;dt_emissao&#39;: dts_emissao,</span>
<span class="go">    ...:     &#39;dt_vencimento&#39;: dts_vencimento,</span>
<span class="go">    ...:     &#39;cd_estado&#39;: cd_estados,</span>
<span class="go">    ...:     &#39;vl_parc_credito&#39;: vls_parc_credito</span>
<span class="go">    ...: }</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dados</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [36]: </span><span class="n">df</span>
<span class="gh">Out[36]:</span>
<span class="go">    ref_bacen   dt_emissao  dt_vencimento   cd_estado   vl_parc_credito</span>
<span class="go">0   517365140   2024-01-29  2027-01-27      PI          4000.00</span>
<span class="go">1   517257321   2024-01-03  2027-01-03      MA          12000.00</span>
<span class="go">2   517256416   2024-01-02  2027-01-02      MG          6000.00</span>
<span class="go">3   517256416   2024-01-02  2027-01-02      MG          2500.00</span>
<span class="go">4   517256501   2024-01-03  2025-01-02      SC          61542.18</span>
<span class="go">5   517256502   2024-01-03  2025-01-02      SP          13327.57</span>
<span class="go">6   517256503   2024-01-03  2024-12-23      PE          44986.50</span>
<span class="go">7   517256507   2024-01-03  2024-12-20      MT          38666.07</span>
<span class="go">8   517256511   2024-01-03  2024-12-15      RS          5395.90</span>
<span class="go">9   517256511   2024-01-03  2024-12-15      RS          9216.72</span>
</pre></div>
</div>
</section>
<section id="selecionando-colunas-de-um-dataframe">
<h2><span class="section-number">2.3.10. </span>Selecionando Colunas de um <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#selecionando-colunas-de-um-dataframe" title="Link permanente para este cabeçalho"></a></h2>
<p>Para selecionar os valores da primeira coluna, rotulada com a string <code class="docutils literal notranslate"><span class="pre">ref_bacen</span></code>, podemos utilizar o <code class="docutils literal notranslate"><span class="pre">operador</span> <span class="pre">[]</span></code> (operador de indexação) como mostrado abaixo:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [37]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ref_bacen&#39;</span><span class="p">]</span>
<span class="gh">Out[37]:</span>
<span class="go">0   517365140</span>
<span class="go">1   517257321</span>
<span class="go">2   517256416</span>
<span class="go">3   517256416</span>
<span class="go">4   517256501</span>
<span class="go">5   517256502</span>
<span class="go">6   517256503</span>
<span class="go">7   517256507</span>
<span class="go">8   517256511</span>
<span class="go">9   517256511</span>
<span class="go">Name: ref_bacen, dtype: object</span>
</pre></div>
</div>
<p>A mesma seleção pode ser realizada com o uso do operador <code class="docutils literal notranslate"><span class="pre">.</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [38]: </span><span class="n">df</span><span class="o">.</span><span class="n">ref_bacen</span>
<span class="gh">Out[38]:</span>
<span class="go">0   517365140</span>
<span class="go">1   517257321</span>
<span class="go">2   517256416</span>
<span class="go">3   517256416</span>
<span class="go">4   517256501</span>
<span class="go">5   517256502</span>
<span class="go">6   517256503</span>
<span class="go">7   517256507</span>
<span class="go">8   517256511</span>
<span class="go">9   517256511</span>
<span class="go">Name: municipio, dtype: object</span>
</pre></div>
</div>
<p>Múltiplas colunas podem ser selecionadas. Podemos usar uma lista para especificar os rótulos das colunas desejada na seleção:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [39]: </span><span class="n">df</span><span class="p">[</span> <span class="p">[</span><span class="s1">&#39;ref_bacen&#39;</span><span class="p">,</span> <span class="s1">&#39;cd_estado&#39;</span> <span class="p">]</span> <span class="p">]</span>
<span class="gh">Out[39]:</span>
<span class="go">    ref_bacen   cd_estado</span>
<span class="go">0   517365140   PI</span>
<span class="go">1   517257321   MA</span>
<span class="go">2   517256416   MG</span>
<span class="go">3   517256416   MG</span>
<span class="go">4   517256501   SC</span>
<span class="go">5   517256502   SP</span>
<span class="go">6   517256503   PE</span>
<span class="go">7   517256507   MT</span>
<span class="go">8   517256511   RS</span>
<span class="go">9   517256511   RS</span>
</pre></div>
</div>
<p>Podemos usar o método <code class="docutils literal notranslate"><span class="pre">filter</span></code> para selecionar colunas baseada em seus nomes ou rótulos:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [40]: </span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">)</span>
<span class="gh">Out[40]:</span>
<span class="go">    dt_emissao  dt_vencimento</span>
<span class="go">0   2024-01-29  2027-01-27</span>
<span class="go">1   2024-01-03  2027-01-03</span>
<span class="go">2   2024-01-02  2027-01-02</span>
<span class="go">3   2024-01-02  2027-01-02</span>
<span class="go">4   2024-01-03  2025-01-02</span>
<span class="go">5   2024-01-03  2025-01-02</span>
<span class="go">6   2024-01-03  2024-12-23</span>
<span class="go">7   2024-01-03  2024-12-20</span>
<span class="go">8   2024-01-03  2024-12-15</span>
<span class="go">9   2024-01-03  2024-12-15</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Além do parâmetro <code class="docutils literal notranslate"><span class="pre">like</span></code>, podemos usar uma expressão regular através do parâmetro <code class="docutils literal notranslate"><span class="pre">regex</span></code>.</p>
</div>
</section>
<section id="acessando-a-estrutura-de-um-dataframe">
<h2><span class="section-number">2.3.11. </span>Acessando a Estrutura de um <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#acessando-a-estrutura-de-um-dataframe" title="Link permanente para este cabeçalho"></a></h2>
<p>Para acessar os índices ou rótulos das linhas, podemos utilizar a propriedade <code class="docutils literal notranslate"><span class="pre">index</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [41]: </span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
<span class="gh">Out[41]: </span><span class="go">RangeIndex((start=0, stop=10, step=1)</span>
</pre></div>
</div>
<p>Os rótulos das colunas podem ser recuperados através da propriedade <code class="docutils literal notranslate"><span class="pre">columns</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [42]: </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<span class="gh">Out[42]: </span><span class="go">Index([&#39;ref_bacen&#39;, &#39;dt_emissao&#39;, &#39;dt_vencimento&#39;, &#39;cd_estado&#39;, &#39;vl_parc_credito&#39;], dtype=&#39;object&#39;)</span>
</pre></div>
</div>
<p>A operação <code class="docutils literal notranslate"><span class="pre">to_numpy()</span></code> retorna uma representação <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, conforme podemos ver no exemplo abaixo:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [43]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="gh">Out[43]:</span>
<span class="go">array([[&#39;517365140&#39;, &#39;2024-01-29&#39;, &#39;2027-01-27&#39;, &#39;PI&#39;, &#39;4000.00&#39;],</span>
<span class="go">       [&#39;517257321&#39;, &#39;2024-01-03&#39;, &#39;2027-01-03&#39;, &#39;MA&#39;, &#39;12000.00&#39;],</span>
<span class="go">       [&#39;517256416&#39;, &#39;2024-01-02&#39;, &#39;2027-01-02&#39;, &#39;MG&#39;, &#39;6000.00&#39;],</span>
<span class="go">       [&#39;517256416&#39;, &#39;2024-01-02&#39;, &#39;2027-01-02&#39;, &#39;MG&#39;, &#39;2500.00&#39;],</span>
<span class="go">       [&#39;517256501&#39;, &#39;2024-01-03&#39;, &#39;2025-01-02&#39;, &#39;SC&#39;, &#39;61542.18&#39;],</span>
<span class="go">       [&#39;517256502&#39;, &#39;2024-01-03&#39;, &#39;2025-01-02&#39;, &#39;SP&#39;, &#39;13327.57&#39;],</span>
<span class="go">       [&#39;517256503&#39;, &#39;2024-01-03&#39;, &#39;2024-12-23&#39;, &#39;PE&#39;, &#39;44986.50&#39;],</span>
<span class="go">       [&#39;517256507&#39;, &#39;2024-01-03&#39;, &#39;2024-12-20&#39;, &#39;MT&#39;, &#39;38666.07&#39;],</span>
<span class="go">       [&#39;517256511&#39;, &#39;2024-01-03&#39;, &#39;2024-12-15&#39;, &#39;RS&#39;, &#39;5395.90&#39;],</span>
<span class="go">       [&#39;517256511&#39;, &#39;2024-01-03&#39;, &#39;2024-12-15&#39;, &#39;RS&#39;, &#39;9216.72&#39;]], dtype=object)</span>
</pre></div>
</div>
<p>O atributo <code class="docutils literal notranslate"><span class="pre">axes</span></code> retorna uma lista com os índices dos eixos do <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [44]: </span><span class="n">df</span><span class="o">.</span><span class="n">axes</span>
<span class="gh">Out[44]:</span>
<span class="go">[RangeIndex(start=0, stop=10, step=1),</span>
<span class="go"> Index([&#39;ref_bacen&#39;, &#39;dt_emissao&#39;, &#39;dt_vencimento&#39;, &#39;cd_estado&#39;, &#39;vl_parc_credito&#39;], dtype=&#39;object&#39;)]</span>
</pre></div>
</div>
<p>Podemos recuperar uma série com os tipos de dados de cada coluna. Nessa série, os índices serão os nomes das colunas e os valores, os tipos de dados de cada coluna:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [45]: </span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gh">Out[45]:</span>
<span class="go">ref_bacen        object</span>
<span class="go">dt_emissao        object</span>
<span class="go">dt_vencimento    object</span>
<span class="go">cd_estado        object</span>
<span class="go">vl_parc_credito  object</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Quando o <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> contém colunas de tipos diferentes (<em>mixed types</em>), o tipo definido pelo <code class="docutils literal notranslate"><span class="pre">dtype</span></code> é <code class="docutils literal notranslate"><span class="pre">object</span></code>.</p>
</div>
<p>As dimensões do <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> podem ser obtidas através da propriedade <code class="docutils literal notranslate"><span class="pre">shape</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [46]: </span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
<span class="gh">Out[46]: </span><span class="go">(10, 5)</span>
</pre></div>
</div>
</section>
<section id="selecionando-valores-do-dataframe">
<h2><span class="section-number">2.3.12. </span>Selecionando valores do <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#selecionando-valores-do-dataframe" title="Link permanente para este cabeçalho"></a></h2>
<p>A operação <code class="docutils literal notranslate"><span class="pre">head</span></code> permite obter valores do <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> a partir do seu início:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [47]: </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gh">Out[47]:</span>
<span class="go">    ref_bacen   dt_emissao  dt_vencimento   cd_estado   vl_parc_credito</span>
<span class="go">0   517365140   2024-01-29  2027-01-27      PI          4000.00</span>
<span class="go">1   517257321   2024-01-03  2027-01-03      MA          12000.00</span>
</pre></div>
</div>
<p>A operação <code class="docutils literal notranslate"><span class="pre">tail</span></code> obtém valores ao final do <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [48]: </span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gh">Out[48]:</span>
<span class="go">    ref_bacen   dt_emissao  dt_vencimento   cd_estado   vl_parc_credito</span>
<span class="go">8   517256511   2024-01-03  2024-12-15      RS          5395.90</span>
<span class="go">9   517256511   2024-01-03  2024-12-15      RS          9216.72</span>
</pre></div>
</div>
<p>Assim como na estrutura <code class="docutils literal notranslate"><span class="pre">Series</span></code>, podemos utilizar as propriedades <code class="docutils literal notranslate"><span class="pre">iloc</span></code> e <code class="docutils literal notranslate"><span class="pre">loc</span></code> para acessar grupos de linhas e colunas.</p>
<p>O trecho de código abaixo utiliza a propriedade <code class="docutils literal notranslate"><span class="pre">loc</span></code> para recuperar os valores compreendidos entre as linhas <code class="docutils literal notranslate"><span class="pre">1</span></code> e <code class="docutils literal notranslate"><span class="pre">3</span></code>, considerando apenas as colunas <code class="docutils literal notranslate"><span class="pre">cd_estado</span></code> e <code class="docutils literal notranslate"><span class="pre">vl_parc_credito</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [49]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;cd_estado&#39;</span><span class="p">,</span> <span class="s1">&#39;vl_parc_credito&#39;</span> <span class="p">]</span> <span class="p">]</span>
<span class="gh">Out[49]:</span>
<span class="go">    cd_estado   vl_parc_credito</span>
<span class="go">1   MA          12000.00</span>
<span class="go">2   MG          6000.00</span>
<span class="go">3   MG          2500.00</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>A propriedade <code class="docutils literal notranslate"><span class="pre">loc</span></code> utiliza os índices ou rótulos dos eixos das linhas e colunas como forma de endereçamento dos elementos. Já o operador <code class="docutils literal notranslate"><span class="pre">iloc</span></code> utiliza números inteiros correspondentes à posição dos eixos (linhas e colunas). No exemplo de <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> usado, os índices (rótulos) das linhas são números inteiros sequenciais e logo não há diferença na forma de acesso entre <code class="docutils literal notranslate"><span class="pre">loc</span></code> e <code class="docutils literal notranslate"><span class="pre">iloc</span></code> quando nos referimos às linhas desse exemplo. No entanto, para o eixo das colunas, temos diferença, conforme será visto abaixo.</p>
</div>
<p>Também podemos utilizar um <em>array</em> de valores lógicos nas propriedades <code class="docutils literal notranslate"><span class="pre">loc</span></code> e <code class="docutils literal notranslate"><span class="pre">iloc</span></code>. O trecho de código abaixo seleciona linhas alternadas do <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [50]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="s1">&#39;dt_vencimento&#39;</span><span class="p">:</span><span class="s1">&#39;vl_parc_credito&#39;</span> <span class="p">]</span>
<span class="gh">Out[50]:</span>
<span class="go">    dt_vencimento   cd_estado   vl_parc_credito</span>
<span class="go">0   2027-01-27      PI          4000.00</span>
<span class="go">1   2027-01-03      MA          12000.00</span>
<span class="go">2   2027-01-02      MG          6000.00</span>
<span class="go">8   2024-12-15      RS          5395.90</span>
<span class="go">9   2024-12-15      RS          9216.72</span>
</pre></div>
</div>
<p>A propriedade <code class="docutils literal notranslate"><span class="pre">iloc</span></code> permite a seleção dos valores da série de maneira posicional, isto é, utilizamos números inteiros para especificar uma ou mais linhas e colunas a serem selecionadas. De maneira semelhante à propriedade <code class="docutils literal notranslate"><span class="pre">loc</span></code>, aceita um array de valores lógicos para seleção:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [51]: </span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span> <span class="p">]</span>
<span class="gh">Out[51]:</span>
<span class="go">    dt_vencimento   cd_estado   vl_parc_credito</span>
<span class="go">0   2027-01-27      PI          4000.00</span>
<span class="go">1   2027-01-03      MA          12000.00</span>
<span class="go">2   2027-01-02      MG          6000.00</span>
<span class="go">8   2024-12-15      RS          5395.90</span>
<span class="go">9   2024-12-15      RS          9216.72</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Repare no exemplo acima que utilizamos um intervalo numérico (<code class="docutils literal notranslate"><span class="pre">2:5</span></code>) para definir as colunas que fariam parte do <em>slice</em> consultado.</p>
</div>
</section>
<section id="iterando-nas-colunas-e-linhas-de-um-dataframe">
<h2><span class="section-number">2.3.13. </span>Iterando nas colunas e linhas de um <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#iterando-nas-colunas-e-linhas-de-um-dataframe" title="Link permanente para este cabeçalho"></a></h2>
<p>A operação <code class="docutils literal notranslate"><span class="pre">items</span></code> permite iterarmos nos conjuntos de valores de cada coluna, como se fossem uma série individual:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [52]: </span><span class="k">for</span> <span class="n">rotulo</span><span class="p">,</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="go">    ...:     print(f&#39;Série da Coluna: {rotulo}&#39;)</span>
<span class="go">    ...:     print(serie)</span>
<span class="go">    ...:     print(&#39;--------\n&#39;)</span>
<span class="go">    ...:</span>
<span class="go">Série da Coluna: ref_bacen</span>
<span class="go">0    517365140</span>
<span class="go">1    517257321</span>
<span class="go">2    517256416</span>
<span class="go">3    517256416</span>
<span class="go">4    517256501</span>
<span class="go">5    517256502</span>
<span class="go">6    517256503</span>
<span class="go">7    517256507</span>
<span class="go">8    517256511</span>
<span class="go">9    517256511</span>
<span class="go">Name: ref_bacen, dtype: object</span>
<span class="gt">--------</span>
<span class="o">...</span>
<span class="gt">--------</span>

<span class="n">Série</span> <span class="n">da</span> <span class="n">Coluna</span><span class="p">:</span> <span class="n">vl_parc_credito</span>
<span class="mi">0</span>     <span class="mf">4000.00</span>
<span class="mi">1</span>    <span class="mf">12000.00</span>
<span class="mi">2</span>     <span class="mf">6000.00</span>
<span class="mi">3</span>     <span class="mf">2500.00</span>
<span class="mi">4</span>    <span class="mf">61542.18</span>
<span class="mi">5</span>    <span class="mf">13327.57</span>
<span class="mi">6</span>    <span class="mf">44986.50</span>
<span class="mi">7</span>    <span class="mf">38666.07</span>
<span class="mi">8</span>     <span class="mf">5395.90</span>
<span class="mi">9</span>     <span class="mf">9216.72</span>
<span class="ne">Name</span>: vl_parc_credito, dtype: object
<span class="gt">--------</span>
</pre></div>
</div>
<p>O operador <code class="docutils literal notranslate"><span class="pre">iterrows()</span></code> permite iterarmos nas linhas do <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> como se fossem uma série:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [53]: </span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<span class="go">    ...:     print(f&#39;Série da Linha: {index}&#39;)</span>
<span class="go">    ...:     print(row)</span>
<span class="go">    ...:     print(&#39;--------&#39;)</span>
<span class="go">    ...:</span>
<span class="go">Série da Linha: 0</span>
<span class="go">ref_bacen           517365140</span>
<span class="go">dt_emissao         2024-01-29</span>
<span class="go">dt_vencimento      2027-01-27</span>
<span class="go">cd_estado                  PI</span>
<span class="go">vl_parc_credito       4000.00</span>
<span class="go">Name: 0, dtype: object</span>
<span class="gt">--------</span>
<span class="o">...</span>
<span class="gt">--------</span>
<span class="n">Série</span> <span class="n">da</span> <span class="n">Linha</span><span class="p">:</span> <span class="mi">9</span>
<span class="n">ref_bacen</span>           <span class="mi">517256511</span>
<span class="n">dt_emissao</span>         <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span>
<span class="n">dt_vencimento</span>      <span class="mi">2024</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">15</span>
<span class="n">cd_estado</span>                  <span class="n">RS</span>
<span class="n">vl_parc_credito</span>       <span class="mf">9216.72</span>
<span class="ne">Name</span>: 9, dtype: object
<span class="gt">--------</span>
</pre></div>
</div>
<p>Uma forma melhor de iterar nas linhas é através da operação <code class="docutils literal notranslate"><span class="pre">itertuples</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">54</span><span class="p">]:</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="o">...</span><span class="p">:</span>     <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="o">...</span><span class="p">:</span>
<span class="n">Pandas</span><span class="p">(</span><span class="n">Index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ref_bacen</span><span class="o">=</span><span class="s1">&#39;517365140&#39;</span><span class="p">,</span> <span class="n">dt_emissao</span><span class="o">=</span><span class="s1">&#39;2024-01-29&#39;</span><span class="p">,</span> <span class="n">dt_vencimento</span><span class="o">=</span><span class="s1">&#39;2027-01-27&#39;</span><span class="p">,</span> <span class="n">cd_estado</span><span class="o">=</span><span class="s1">&#39;PI&#39;</span><span class="p">,</span> <span class="n">vl_parc_credito</span><span class="o">=</span><span class="s1">&#39;4000.00&#39;</span><span class="p">)</span>
<span class="n">Pandas</span><span class="p">(</span><span class="n">Index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ref_bacen</span><span class="o">=</span><span class="s1">&#39;517257321&#39;</span><span class="p">,</span> <span class="n">dt_emissao</span><span class="o">=</span><span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="n">dt_vencimento</span><span class="o">=</span><span class="s1">&#39;2027-01-03&#39;</span><span class="p">,</span> <span class="n">cd_estado</span><span class="o">=</span><span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="n">vl_parc_credito</span><span class="o">=</span><span class="s1">&#39;12000.00&#39;</span><span class="p">)</span>
<span class="n">Pandas</span><span class="p">(</span><span class="n">Index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ref_bacen</span><span class="o">=</span><span class="s1">&#39;517256416&#39;</span><span class="p">,</span> <span class="n">dt_emissao</span><span class="o">=</span><span class="s1">&#39;2024-01-02&#39;</span><span class="p">,</span> <span class="n">dt_vencimento</span><span class="o">=</span><span class="s1">&#39;2027-01-02&#39;</span><span class="p">,</span> <span class="n">cd_estado</span><span class="o">=</span><span class="s1">&#39;MG&#39;</span><span class="p">,</span> <span class="n">vl_parc_credito</span><span class="o">=</span><span class="s1">&#39;6000.00&#39;</span><span class="p">)</span>
<span class="n">Pandas</span><span class="p">(</span><span class="n">Index</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ref_bacen</span><span class="o">=</span><span class="s1">&#39;517256416&#39;</span><span class="p">,</span> <span class="n">dt_emissao</span><span class="o">=</span><span class="s1">&#39;2024-01-02&#39;</span><span class="p">,</span> <span class="n">dt_vencimento</span><span class="o">=</span><span class="s1">&#39;2027-01-02&#39;</span><span class="p">,</span> <span class="n">cd_estado</span><span class="o">=</span><span class="s1">&#39;MG&#39;</span><span class="p">,</span> <span class="n">vl_parc_credito</span><span class="o">=</span><span class="s1">&#39;2500.00&#39;</span><span class="p">)</span>
<span class="n">Pandas</span><span class="p">(</span><span class="n">Index</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ref_bacen</span><span class="o">=</span><span class="s1">&#39;517256501&#39;</span><span class="p">,</span> <span class="n">dt_emissao</span><span class="o">=</span><span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="n">dt_vencimento</span><span class="o">=</span><span class="s1">&#39;2025-01-02&#39;</span><span class="p">,</span> <span class="n">cd_estado</span><span class="o">=</span><span class="s1">&#39;SC&#39;</span><span class="p">,</span> <span class="n">vl_parc_credito</span><span class="o">=</span><span class="s1">&#39;61542.18&#39;</span><span class="p">)</span>
<span class="n">Pandas</span><span class="p">(</span><span class="n">Index</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ref_bacen</span><span class="o">=</span><span class="s1">&#39;517256502&#39;</span><span class="p">,</span> <span class="n">dt_emissao</span><span class="o">=</span><span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="n">dt_vencimento</span><span class="o">=</span><span class="s1">&#39;2025-01-02&#39;</span><span class="p">,</span> <span class="n">cd_estado</span><span class="o">=</span><span class="s1">&#39;SP&#39;</span><span class="p">,</span> <span class="n">vl_parc_credito</span><span class="o">=</span><span class="s1">&#39;13327.57&#39;</span><span class="p">)</span>
<span class="n">Pandas</span><span class="p">(</span><span class="n">Index</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ref_bacen</span><span class="o">=</span><span class="s1">&#39;517256503&#39;</span><span class="p">,</span> <span class="n">dt_emissao</span><span class="o">=</span><span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="n">dt_vencimento</span><span class="o">=</span><span class="s1">&#39;2024-12-23&#39;</span><span class="p">,</span> <span class="n">cd_estado</span><span class="o">=</span><span class="s1">&#39;PE&#39;</span><span class="p">,</span> <span class="n">vl_parc_credito</span><span class="o">=</span><span class="s1">&#39;44986.50&#39;</span><span class="p">)</span>
<span class="n">Pandas</span><span class="p">(</span><span class="n">Index</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ref_bacen</span><span class="o">=</span><span class="s1">&#39;517256507&#39;</span><span class="p">,</span> <span class="n">dt_emissao</span><span class="o">=</span><span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="n">dt_vencimento</span><span class="o">=</span><span class="s1">&#39;2024-12-20&#39;</span><span class="p">,</span> <span class="n">cd_estado</span><span class="o">=</span><span class="s1">&#39;MT&#39;</span><span class="p">,</span> <span class="n">vl_parc_credito</span><span class="o">=</span><span class="s1">&#39;38666.07&#39;</span><span class="p">)</span>
<span class="n">Pandas</span><span class="p">(</span><span class="n">Index</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ref_bacen</span><span class="o">=</span><span class="s1">&#39;517256511&#39;</span><span class="p">,</span> <span class="n">dt_emissao</span><span class="o">=</span><span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="n">dt_vencimento</span><span class="o">=</span><span class="s1">&#39;2024-12-15&#39;</span><span class="p">,</span> <span class="n">cd_estado</span><span class="o">=</span><span class="s1">&#39;RS&#39;</span><span class="p">,</span> <span class="n">vl_parc_credito</span><span class="o">=</span><span class="s1">&#39;5395.90&#39;</span><span class="p">)</span>
<span class="n">Pandas</span><span class="p">(</span><span class="n">Index</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">ref_bacen</span><span class="o">=</span><span class="s1">&#39;517256511&#39;</span><span class="p">,</span> <span class="n">dt_emissao</span><span class="o">=</span><span class="s1">&#39;2024-01-03&#39;</span><span class="p">,</span> <span class="n">dt_vencimento</span><span class="o">=</span><span class="s1">&#39;2024-12-15&#39;</span><span class="p">,</span> <span class="n">cd_estado</span><span class="o">=</span><span class="s1">&#39;RS&#39;</span><span class="p">,</span> <span class="n">vl_parc_credito</span><span class="o">=</span><span class="s1">&#39;9216.72&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Repare que o índice da linha aparece como primeiro atributo da tupla retornada. Se informarmos o argumento <code class="docutils literal notranslate"><span class="pre">index=False</span></code> na operação <code class="docutils literal notranslate"><span class="pre">itertuples</span></code>, esse elemento será suprimido do resultado.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>O parâmetro <code class="docutils literal notranslate"><span class="pre">name</span></code> pode ser usado para controlar o nome da tupla retornada, que por padrão utiliza o nome <code class="docutils literal notranslate"><span class="pre">Pandas</span></code>.</p>
</div>
</section>
<section id="construindo-mascaras-booleanas-para-selecao-de-linhas">
<h2><span class="section-number">2.3.14. </span>Construindo máscaras booleanas para seleção de linhas<a class="headerlink" href="#construindo-mascaras-booleanas-para-selecao-de-linhas" title="Link permanente para este cabeçalho"></a></h2>
<p>Uma técnica útil para construir uma máscara de valores booleanos é utilizar expressões que retornem séries com valores booleanos:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [55]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;dt_vencimento&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="s1">&#39;2025-01-01&#39;</span>
<span class="gh">Out[55]:</span>
<span class="go">0   True</span>
<span class="go">1   True</span>
<span class="go">2   True</span>
<span class="go">3   True</span>
<span class="go">4   True</span>
<span class="go">5   True</span>
<span class="go">6   False</span>
<span class="go">7   False</span>
<span class="go">8   False</span>
<span class="go">9   False</span>
<span class="go">Name: dt_vencimento, dtype: bool</span>
</pre></div>
</div>
<p>Podemos usar uma expressão como acima para selecionar as linhas de um <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [56]: </span><span class="n">df</span><span class="p">[</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dt_vencimento&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="s1">&#39;2025-01-01&#39;</span> <span class="p">]</span>
<span class="gh">Out[56]:</span>
<span class="go">    ref_bacen   dt_emissao   dt_vencimento   cd_estado   vl_parc_credito</span>
<span class="go">0   517365140   2024-01-29   2027-01-27      PI          4000.00</span>
<span class="go">1   517257321   2024-01-03   2027-01-03      MA          12000.00</span>
<span class="go">2   517256416   2024-01-02   2027-01-02      MG          6000.00</span>
<span class="go">3   517256416   2024-01-02   2027-01-02      MG          2500.00</span>
<span class="go">4   517256501   2024-01-03   2025-01-02      SC          61542.18</span>
<span class="go">5   517256502   2024-01-03   2025-01-02      SP          13327.57</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Para saber as demais propriedades e operações disponíveis para a estrutura <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, consulte a seguinte documentação: <a class="reference external" href="https://pandas.pydata.org/docs/reference/frame.html">pandas.DataFrame</a>.</p>
</div>
</section>
<section id="leitura-de-arquivos-csv">
<h2><span class="section-number">2.3.15. </span>Leitura de Arquivos CSV<a class="headerlink" href="#leitura-de-arquivos-csv" title="Link permanente para este cabeçalho"></a></h2>
<p>Para abrir um arquivo <code class="docutils literal notranslate"><span class="pre">CSV</span></code> basta utilizar a função <code class="docutils literal notranslate"><span class="pre">read_csv</span></code>. Como a estrutura do arquivo csv pode ter um separador diferente, como <code class="docutils literal notranslate"><span class="pre">;</span></code>, usamos o parâmetro <code class="docutils literal notranslate"><span class="pre">sep</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [57]: </span><span class="n">operacoes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;operacoes-2024-subconjunto.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Baixe o arquivo <a class="reference download internal" download="" href="../_downloads/2712f32639df6033deb5638cdcc477da/operacoes-2024-subconjunto.csv"><code class="xref download docutils literal notranslate"><span class="pre">operacoes-2024-subconjunto.csv</span></code></a>, o qual contém um subconjunto de 1024 registros de operações de crédito rural contratadas com recursos públicos ou privados, no ano de 2024.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>O Pandas fornece diversas funções de entrada/saída. Consulte o seguinte documento para maiores informações: <a class="reference external" href="https://pandas.pydata.org/docs/reference/io.html">Input/output</a>.</p>
</div>
</section>
<section id="analise-de-dados-com-o-pandas">
<h2><span class="section-number">2.3.16. </span>Análise de Dados com o Pandas<a class="headerlink" href="#analise-de-dados-com-o-pandas" title="Link permanente para este cabeçalho"></a></h2>
<p>Vamos começar nossa análise, do conjunto de dados lido do arquivo <code class="docutils literal notranslate"><span class="pre">operacoes-2024-subconjunto.csv</span></code>, por uma estatística descritiva. Vamos combinar a operação <code class="docutils literal notranslate"><span class="pre">filter()</span></code>, já vista anteriormente, para escolher somente algumas colunas e apresentar um resumo dos valores presentes em todas as linhas.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">operacoes</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>

        <span class="n">vl_area_financ</span>   <span class="n">vl_area_informada</span>
<span class="n">count</span>   <span class="mf">1023.000000</span>      <span class="mf">1023.000000</span>
<span class="n">mean</span>    <span class="mf">11.663998</span>        <span class="mf">11.852356</span>
<span class="n">std</span>     <span class="mf">40.405765</span>        <span class="mf">40.606350</span>
<span class="nb">min</span>     <span class="mf">0.000000</span>         <span class="mf">0.000000</span>
<span class="mi">25</span><span class="o">%</span>     <span class="mf">0.000000</span>         <span class="mf">0.000000</span>
<span class="mi">50</span><span class="o">%</span>     <span class="mf">0.000000</span>         <span class="mf">0.000000</span>
<span class="mi">75</span><span class="o">%</span>     <span class="mf">6.915000</span>         <span class="mf">7.035000</span>
<span class="nb">max</span>     <span class="mf">667.410000</span>       <span class="mf">667.410000</span>
</pre></div>
</div>
<p>A operação <code class="docutils literal notranslate"><span class="pre">describe</span></code> apresenta um sumário do conjunto de dados do <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, mostrando sua tendência central, dispersão e forma. Essa operação cosidera apenas valores numéricos ou que possam ser transformados em valores numéricos, excluindo valores que não possam ser convertidos para números válidos. Além disso, existe um valor especial chamado <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (<code class="docutils literal notranslate"><span class="pre">Not-a-Number</span></code>) que indica a ausência de valor naquela célula.</p>
<p>Na saída da operação <code class="docutils literal notranslate"><span class="pre">describe()</span></code> podemos ver que o resultado inclui um sumário por coluna:</p>
<ul class="open">
<li><p><code class="docutils literal notranslate"><span class="pre">count</span></code>: Número de elementos da coluna com valores diferentes de <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>: Média dos valores nas colunas.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">std</span></code>: Desvio padrão dos valores nas colunas.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min</span></code>: Valor mínimo na coluna.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max</span></code>: Valor máximo na coluna.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">percentis</span></code>: primeiro quartil (25% das observações abaixo e 75% acima), segundo quartil (mediana, deixa 50% das observações abaixo e 50% das observações acima) e terceiro quartil (75% das observações abaixo e 25% acima).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Q1.</strong> Quantos valores diferentes existem em cada coluna do <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">operacoes</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
<p>Saída:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">python</span>
</pre></div>
</div>
<blockquote>
<div><p>ref_bacen                    781
nu_ordem                     6
cnpj_if                      96
dt_emissao                   4
dt_vencimento                179
cd_inst_credito              7
cd_categ_emitente            3
cd_fonte_recurso             14
cnpj_agente_invest           2
cd_estado                    22
cd_ref_bacen_investimento    10
cd_tipo_seguro               4
cd_empreendimento            127
cd_programa                  6
cd_tipo_encarg_financ        4
cd_tipo_irrigacao            6
cd_tipo_agricultura          4
cd_fase_ciclo_producao       11
cd_tipo_cultivo              3
cd_tipo_intgr_consor         3
cd_tipo_grao_semente         3
vl_aliq_proagro              13
vl_juros                     53
vl_prestacao_investimento    8
vl_prev_prod                 346
vl_quantidade                111
vl_receita_bruta_esperada    363
vl_parc_credito              555
vl_rec_proprio               107
vl_perc_risco_stn            1
vl_perc_risco_fundo_const    3
vl_rec_proprio_srv           50
vl_area_financ               378
cd_subprograma               12
vl_produtiv_obtida           19
dt_fim_colheita              83
dt_fim_plantio               57
dt_inic_colheita             76
dt_inic_plantio              69
vl_juros_enc_finan_posfix    3
vl_perc_custo_efet_total     164
cd_contrato_stn              51
cd_cnpj_cadastrante          6
vl_area_informada            373
cd_ciclo_cultivar            5
cd_tipo_solo                 8
pc_bonus_car                 0
dtype: int64</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>A operação <code class="docutils literal notranslate"><span class="pre">nunique</span></code> conta o número de observações distintas e retorna uma série com essa contagem. Por padrão, a contagem é realizada ao longo do eixo das linhas (<code class="docutils literal notranslate"><span class="pre">axis=0</span></code> ou índice), como mostrado na saída acima. Podemos realizar a contagem no eixo da colunas usando o argumento <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>,</p>
</div>
<hr class="docutils" />
<p><strong>Q2.</strong> Quantos valores diferentes existem para a coluna <code class="docutils literal notranslate"><span class="pre">ref_bacen</span></code>?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">operacoes</span><span class="p">[</span><span class="s1">&#39;ref_bacen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
<p>Saída:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">781</span>
</pre></div>
</div>
<p>Para obter os valores únicos podemos utilizar a operação <code class="docutils literal notranslate"><span class="pre">unique</span></code> como mostrado abaixo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">operacoes</span><span class="p">[</span><span class="s1">&#39;cd_estado&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
<p>Saída:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">python</span>
</pre></div>
</div>
<blockquote>
<div><dl class="simple">
<dt>array([‘PI’, ‘MA’, ‘MG’, ‘SC’, ‘ES’, ‘MT’, ‘RS’, ‘PR’, ‘PB’, ‘GO’, ‘MS’,</dt><dd><p>‘PE’, ‘CE’, ‘RO’, ‘BA’, ‘SP’, ‘TO’, ‘AL’, ‘SE’, ‘RN’, ‘RJ’, ‘PA’], dtype=object)</p>
</dd>
</dl>
</div></blockquote>
<hr class="docutils" />
<p><strong>Q3.</strong> Quantas linhas de cada <code class="docutils literal notranslate"><span class="pre">cd_estado</span></code> existem no <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>?</p>
<p>Nesse caso, precisamos realizar uma operação que agrupe as linha pelos valores da coluna <code class="docutils literal notranslate"><span class="pre">cd_estado</span></code> e então relize a contagem. O trecho de código abaixo utiliza o operador <code class="docutils literal notranslate"><span class="pre">groupby</span></code> para retornar um objeto que contém informação sobre grupos. Esse objeto é associado ao identificador <code class="docutils literal notranslate"><span class="pre">grupo_linhas</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grupo_linhas</span> <span class="o">=</span> <span class="n">operacoes</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;cd_estado&#39;</span><span class="p">)</span>

<span class="n">grupo_linhas</span><span class="p">[</span><span class="s1">&#39;ref_bacen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<p>Saída:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">python</span>
</pre></div>
</div>
<blockquote>
<div><blockquote>
<div><p>ref_bacen</p>
</div></blockquote>
<p>cd_estado
AL           3
BA           196
CE           11
ES           8
GO           16
MA           31
MG           109
MS           10
MT           11
PA           2
PB           175
PE           8
PI           43
PR           122
RJ           7
RN           35
RO           6
RS           142
SC           57
SE           8
SP           18
TO           6</p>
</div></blockquote>
<p>Veja que utilizamos a contagem somente da coluna <code class="docutils literal notranslate"><span class="pre">ref_bacen</span></code> para reduzir o tamanho da saída. Se você estiver interessado na contagem apenas de todas as colunas, pode usar a seguinte estratégia:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grupo_linhas</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Para maiores informações sobre operações com objetos do tipo <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code>, consulte a <a class="reference external" href="https://pandas.pydata.org/docs/reference/groupby.html">seguinte documentação</a>.</p>
</div>
<hr class="docutils" />
<p><strong>Q4.</strong> Apresentar um gráfico de barras com a contagem de quantas operações estão registradas para cada estado:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">contagem</span> <span class="o">=</span> <span class="n">grupo_linhas</span><span class="p">[</span><span class="s1">&#39;cd_estado&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="n">contagem</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Saída:</p>
<a class="reference internal image-reference" href="../_images/operacoes-x-estados.png"><img alt="Plot" src="../_images/operacoes-x-estados.png" style="width: 50%;" /></a>
<hr class="docutils" />
<p><strong>Q5.</strong> Quantos valores estão faltando em cada coluna?</p>
<p>Os métodos <code class="docutils literal notranslate"><span class="pre">isnull</span></code> e <code class="docutils literal notranslate"><span class="pre">notnull</span></code> das estruturas de dados do <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> possibilitam trabalhar a ocorrência de valores nulos. Essas duas operações retornam uma máscara booleana, onde valores <code class="docutils literal notranslate"><span class="pre">True</span></code> para o método <code class="docutils literal notranslate"><span class="pre">isnull</span></code> indicam valores faltantes, ou nulos; e <code class="docutils literal notranslate"><span class="pre">False</span></code> valores presentes. O contrário ocorre para o método <code class="docutils literal notranslate"><span class="pre">notnull</span></code>. Podemos combinar essas operações com o método <code class="docutils literal notranslate"><span class="pre">sum()</span></code> que realiza uma contagem por coluna, e assim conseguimos ter uma informação compilada sobre a quantidade de valores faltantes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">operacoes</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<p>Saída:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ref_bacen</span>                  <span class="mi">0</span>
<span class="n">nu_ordem</span>                   <span class="mi">0</span>
<span class="n">cnpj_if</span>                    <span class="mi">0</span>
<span class="n">dt_emissao</span>                 <span class="mi">0</span>
<span class="n">dt_vencimento</span>              <span class="mi">0</span>
<span class="n">cd_inst_credito</span>            <span class="mi">0</span>
<span class="n">cd_categ_emitente</span>          <span class="mi">0</span>
<span class="n">cd_fonte_recurso</span>           <span class="mi">0</span>
<span class="n">cnpj_agente_invest</span>         <span class="mi">1014</span>
<span class="n">cd_estado</span>                  <span class="mi">0</span>
<span class="n">cd_ref_bacen_investimento</span>  <span class="mi">1014</span>
<span class="o">...</span>
<span class="n">vl_area_informada</span>          <span class="mi">1</span>
<span class="n">cd_ciclo_cultivar</span>          <span class="mi">875</span>
<span class="n">cd_tipo_solo</span>               <span class="mi">875</span>
<span class="n">pc_bonus_car</span>               <span class="mi">1024</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">operacoes</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<p>Saída:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ref_bacen</span>                   <span class="mi">1024</span>
<span class="n">nu_ordem</span>                    <span class="mi">1024</span>
<span class="n">cnpj_if</span>
<span class="n">dt_emissao</span>                  <span class="mi">1024</span>
<span class="n">dt_vencimento</span>               <span class="mi">1024</span>
<span class="n">cd_inst_credito</span>             <span class="mi">1024</span>
<span class="n">cd_categ_emitente</span>           <span class="mi">1024</span>
<span class="n">cd_fonte_recurso</span>            <span class="mi">1024</span>
<span class="n">cnpj_agente_invest</span>          <span class="mi">10</span>
<span class="n">cd_estado</span>                   <span class="mi">1024</span>
<span class="n">cd_ref_bacen_investimento</span>   <span class="mi">10</span>
<span class="o">...</span>
<span class="n">vl_area_informada</span>           <span class="mi">1023</span>
<span class="n">cd_ciclo_cultivar</span>           <span class="mi">149</span>
<span class="n">cd_tipo_solo</span>                <span class="mi">149</span>
<span class="n">pc_bonus_car</span>                <span class="mi">0</span>
</pre></div>
</div>
<hr class="docutils" />
<p><strong>Q6.</strong> Quais as linhas que possuem <code class="docutils literal notranslate"><span class="pre">NaN</span></code> na coluna <code class="docutils literal notranslate"><span class="pre">cnpj_agente_invest</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">operacoes</span><span class="p">[</span> <span class="n">operacoes</span><span class="p">[</span><span class="s1">&#39;cnpj_agente_invest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="p">]</span>
</pre></div>
</div>
<p>Saída:</p>
<a class="reference internal image-reference" href="../_images/dataframe-rows-nan.png"><img alt="isnull" src="../_images/dataframe-rows-nan.png" style="width: 100%;" /></a>
<hr class="docutils" />
<p><strong>Q7.</strong> Quantas observações estão completas, isto é, não estão faltando valores?</p>
<p>Através da operação <code class="docutils literal notranslate"><span class="pre">dropna</span></code> podemos criar um novo <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> contendo apenas colunas que não contenham valores <code class="docutils literal notranslate"><span class="pre">NaN</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ndf</span> <span class="o">=</span> <span class="n">operacoes</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ndf</span>
</pre></div>
</div>
<p>Saída:</p>
<a class="reference internal image-reference" href="../_images/dataframe-dropna.png"><img alt="isnull" src="../_images/dataframe-dropna.png" style="width: 50%;" /></a>
<hr class="docutils" />
<p><strong>Q8.</strong> Adicionar uma nova coluna chamada <code class="docutils literal notranslate"><span class="pre">porcentagem_area_financiada</span></code> que seja a relação entre as colunas <code class="docutils literal notranslate"><span class="pre">vl_area_financ</span></code> e <code class="docutils literal notranslate"><span class="pre">vl_area_informada</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">operacoes</span><span class="p">[</span><span class="s1">&#39;porcentagem_area_financiada&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">operacoes</span><span class="p">[</span><span class="s1">&#39;vl_area_financ&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">operacoes</span><span class="p">[</span><span class="s1">&#39;vl_area_informada&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Podemos utilizar a nova coluna <code class="docutils literal notranslate"><span class="pre">porcentagem_area_financiada</span></code> do nosso <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, e realizar consultas sobre ela, como por exemplo saber a quantidade (método <code class="docutils literal notranslate"><span class="pre">len</span></code>) de operações com a porcentagem inferior a 60%:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">operacoes</span><span class="p">[</span><span class="n">operacoes</span><span class="p">[</span><span class="s1">&#39;porcentagem_area_financiada&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">])</span>
</pre></div>
</div>
<p>Saída:</p>
<blockquote>
<div><p>5</p>
</div></blockquote>
<hr class="docutils" />
<p><strong>Q9.</strong> Copiar um <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">copia_df</span> <span class="o">=</span> <span class="n">operacoes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Rodapé">
        <a href="notebooks.html" class="btn btn-neutral float-left" title="2.2. Jupyter Notebooks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="../sicor/index.html" class="btn btn-neutral float-right" title="3. Dados do Sicor" accesskey="n" rel="next">Próximo <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Time.</p>
  </div>

  
<jinja2.runtime.BlockReference object at 0x7ff6bd9f7070>
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-nc-sa.png" width="117" height="41"/></a> This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons “Attribution-NonCommercial-ShareAlike 4.0 International” license</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>