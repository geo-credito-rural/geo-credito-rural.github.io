.. include:: ../def.rst


.. _sec_bases_vetoriais_unidades_conservacao:

Unidades de Conservação
=======================


As **áreas protegidas** são espaços territorialmente demarcados cuja principal função é a conservação e/ou a preservação de recursos naturais e/ou culturais, a elas associados. Elas podem ser definidas como uma área terrestre e/ou marinha especialmente dedicada à proteção e manutenção da diversidade biológica e dos recursos naturais e culturais associados, manejados através de instrumentos legais ou outros instrumentos efetivos. Desta maneira, as áreas protegidas foram criadas com o objetivo de preservar e conservar o patrimônio natural de nossos ecossistemas, garantindo seus aspectos ecológicos, geológicos, históricos e culturais :cite:`medeiros:2006:a`.  No Brasil, essas áreas estão asseguradas pela `Lei Federal nº 9.985 de 18 de julho de 2000 <https://www.planalto.gov.br/ccivil_03/leis/l9985.htm>`__, que institui o Sistema Nacional de Unidades de Conservação da Natureza (SNUC) :cite:`brasil:2024:a`. Ela também estabelece critérios e normas para a criação, implantação e gestão das unidades de conservação. A lei define *Unidade de Conservação* como um espaço territorial com objetivos de conservação e limites definidos. Seus recursos ambientais, incluindo as águas jurisdicionais, com características naturais relevantes, legalmente instituído pelo poder público, sob regime especial de administração, ao qual se aplicam garantias adequadas de proteção. Assim, unidades de conservação são áreas protegidas por lei federal, estadual, distrital ou municipal, com objetivo de conservar a biodiversidade e outros atributos naturais neles contidos, com o mínimo de impacto.


As unidade de conservação podem ser divididas em dois grupos:

.. rst-class:: open

-  **Unidades de Proteção Integral:**  com o objetivo de preservar a natureza, sendo admitido apenas o uso indireto dos seus recursos naturais, com exceção dos casos previstos em lei;

-  **Unidades de Uso Sustentável:** cujo objetivo é o de compatibilizar a conservação da natureza com o uso sustentável de parcela dos seus recursos naturais.


Estes dois tipos de unidades de conservação são compostos por diversas categorias e objetivos. A :numref:`Tabela %s <tbl:bases-vetoriais:uc>` apresenta as categorias de unidade de conservação integrantes do SNUC e a descrição de cada uma delas.


.. table:: Categorias de unidades de conservação. |br| **Fonte:** :cite:`brasil:2024:a` :cite:`wikipedia:2024:a`.
    :header-alignment: center center center 
    :column-alignment: center center center 
    :name: tbl:bases-vetoriais:uc

    +--------------+-----------------+-----------------------------------------------------------------------------------+
    | Grupo        | Categoria SNUC  |  Descrição                                                                        |
    +==============+=================+===================================================================================+
    | Proteção     | Estação         | Servem à preservação da natureza e à realização de pesquisas científicas. A       |
    |              |                 | visitação pública não é permitida a exceção de visitas com objetivo educacional.  |
    | Integral     | ecológica       | As pesquisas científicas dependem de autorização prévia do órgão responsável.     |
    +              +-----------------+-----------------------------------------------------------------------------------+
    |              | Reserva         | Visam a preservação integral da biota e demais atributos naturais existentes em   | 
    |              |                 | seus limites, sem interferência humana direta ou modificações ambientais,         |
    |              |                 | excetuando-se as medidas de recuperação de seus ecossistemas alterados e as       |
    |              | Biológica       | ações de manejo necessárias para recuperar e preservar o equilíbrio natural,      |
    |              |                 | a diversidade biológica e os processos ecológicos naturais.                       |
    +              +-----------------+-----------------------------------------------------------------------------------+
    |              | Parque          | Têm como objetivo básico a preservação de ecossistemas naturais de grande         | 
    |              |                 | relevância ecológica e beleza cênica, possibilitando a realização de pesquisas,   |
    |              |                 | científicas e o desenvolvimento de atividades de educação e interpretação         |
    |              | Nacional        | ambiental, de recreação em contato com a natureza e de turismo ecológico.         |
    +              +-----------------+-----------------------------------------------------------------------------------+
    |              | Monumento       | Têm por objetivo a preservação de sítios naturais raros, singulares ou de         | 
    |              | Natural         | grande beleza cênica.                                                             |
    +              +-----------------+-----------------------------------------------------------------------------------+
    |              | Refúgio         | Objetivam a proteção de ambientes naturais que asseguram condições para a         | 
    |              | de Vida         | existência ou reprodução de espécies ou comunidades da flora local e da fauna     |
    |              | Silvestre       | residente ou migratória.                                                          |
    +--------------+-----------------+-----------------------------------------------------------------------------------+
    | Uso          | Área de         | Áreas com pouca ou nenhuma ocupação humana, exibindo características naturais     | 
    |              | Relevante       | extraordinárias ou que abrigam exemplares raros da biota regional, tendo como     |
    | Sustentável  | Interesse       | objetivo manter os ecossistemas naturais de importância regional ou local         |
    |              | Ecológico       | e regular o uso admissível dessas áreas, de modo a compatibilizá-lo com os        |
    |              |                 | objetivos de conservação da natureza.                                             |
    +              +-----------------+-----------------------------------------------------------------------------------+
    |              | Reserva         | São de posse privada e têm por objetivo conservar a diversidade ecológica.        | 
    |              | particular      |                                                                                   |
    |              | do patrimônio   |                                                                                   |
    |              | natural         |                                                                                   |
    +              +-----------------+-----------------------------------------------------------------------------------+
    |              | Área de         | São áreas geralmente extensas, com um certo grau de ocupação humana, dotadas de   |
    |              | proteção        | atributos abióticos, bióticos, estéticos ou culturais especialmente importantes   |
    |              | ambiental       | para a qualidade de vida e o bem-estar das populações humanas, e têm como         |
    |              |                 | objetivos básicos proteger a diversidade biológica, disciplinar o processo de     |
    |              |                 | ocupação e assegurar a sustentabilidade do uso dos recursos naturais.             |
    +              +-----------------+-----------------------------------------------------------------------------------+
    |              | Floresta        | É uma área com cobertura florestal de espécies predominantemente nativas e tem    |
    |              | Nacional        | como objetivo básico o uso múltiplo sustentável dos recursos florestais e a       |
    |              |                 | pesquisa científica, com ênfase em métodos para exploração sustentável de         |
    |              |                 | florestas nativas.                                                                |
    +              +-----------------+-----------------------------------------------------------------------------------+
    |              | Reserva de      | São áreas naturais que abrigam populações tradicionais, cuja existência baseia-se |
    |              | desenvolvimento | em sistemas sustentáveis de exploração dos recursos naturais, desenvolvidos ao    |
    |              | sustentável     | longo de gerações, adaptados às condições ecológicas locais, que desempenham um   |
    |              |                 | papel fundamental na proteção da natureza e na manutenção da diversidade          |
    |              |                 | biológica.                                                                        |
    +              +-----------------+-----------------------------------------------------------------------------------+
    |              | Reserva de      | São áreas naturais com populações animais de espécies nativas, terrestres ou      |
    |              | fauna           | aquáticas, residentes ou migratórias, adequadas para estudos técnico-científicos  |
    |              |                 | sobre o manejo econômico sustentável de recursos faunísticos.                     |
    +              +-----------------+-----------------------------------------------------------------------------------+
    |              | Reserva         | Utilizadas por populações locais, cuja subsistência baseia-se no extrativismo e,  | 
    |              | extrativista    | complementarmente, na agricultura de subsistência e na criação de animais de      |
    |              |                 | pequeno porte, áreas dessa categoria têm como objetivos básicos proteger          |
    |              |                 | os meios de vida e a cultura dessas populações, e assegurar o uso sustentável     |
    |              |                 | dos recursos naturais da unidade.                                                 |
    +--------------+-----------------+-----------------------------------------------------------------------------------+


Os limites das unidades de conservação são disponibilizados em diversos formatos pelo Ministério do Meio Ambiente e Mudança do Clima (MMA). Para este estudo foi acessado o conjunto de arquivos *Esri Shapefile* `shp_cnuc_2024_02.zip <https://dados.mma.gov.br/dataset/44b6dc8a-dc82-4a84-8d95-1b0da7c85dac/resource/9ec98f66-44ad-4397-8583-a1d9cc3a9835/download/shp_cnuc_2024_02.zip>`__, que possui aproximadamente 32MB. A :numref:`Figura %s <fig:bases-vetoriais:cnuc>` apresenta a distribuição destas áreas por categoria no Brasil.


.. figure:: ../img/bases-vetoriais/cnuc.png
    :alt: Distribuição das áreas protegidas por categoria no Brasil
    :width: 80%
    :figclass: align-center
    :name: fig:bases-vetoriais:cnuc

    Distribuição das áreas protegidas por categoria no Brasil.


A :numref:`Tabela %s <tbl:bases-vetoriais:cnuc-shp>` apresenta a estrutura desse conjunto de dados. As colunas alfanuméricas encontram-se codificadas em UTF8. O sistema de referência espacial utilizado é baseado em coordenadas geográficas (LAT/LONG) no sistema geodésico de referência SIRGAS 2000 (EPSG:4674).


.. table:: Estrutura do do conjunto de arquivos *Esri Shapefile* `shp_cnuc_2024_02.zip <https://dados.mma.gov.br/dataset/44b6dc8a-dc82-4a84-8d95-1b0da7c85dac/resource/9ec98f66-44ad-4397-8583-a1d9cc3a9835/download/shp_cnuc_2024_02.zip>`__.
    :align: center
    :header-alignment: center center center center
    :column-alignment: center left center left
    :name: tbl:bases-vetoriais:cnuc-shp

    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | nome         | tipo                        | descrição                                             |
    +=========+==============+=============================+=======================================================+
    | **PK**  | gid          | integer                     |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | gml_id       | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | uc_id        | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | cd_cnuc      | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | wdpa_pid     | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | nome_uc      | varchar(121)                |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | cria_ano     | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | cria_ato     | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | outro_ato    | varchar(254)                |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | pl_manejo    | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | co_gestor    | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | quali_pol    | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | ppgr         | varchar(160)                |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | ha_total     | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | ha_ato       | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | esfera       | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | uf           | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | municipio    | varchar(254)                |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | org_gestor   | varchar(158)                |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | grupo        | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | categoria    | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | cat_iucn     | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | amazonia     | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | caatinga     | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | cerrado      | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | matlantica   | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | pampa        | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | pantanal     | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | marinho      | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | situacao     | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | limite       | varchar(80)                 |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | area_ha      | double precision            |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | nomeabrev    | varchar(121)                |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+
    |         | geom         | geometry(MultiPolygon,4674) |                                                       |
    +---------+--------------+-----------------------------+-------------------------------------------------------+


.. note::

    O conjunto de arquivos *Esri Shapefile* `shp_cnuc_2024_02.zip <https://dados.mma.gov.br/dataset/44b6dc8a-dc82-4a84-8d95-1b0da7c85dac/resource/9ec98f66-44ad-4397-8583-a1d9cc3a9835/download/shp_cnuc_2024_02.zip>`__ encontra-se carregado na tabela ``cnuc_2024_02`` do banco de dados PostgreSQL.


Consultas
---------


**Consulta 1.** Recuperar o número de unidades de conservação.


.. collapse:: Solução:


    .. tabs::


        .. tab:: SQL


            .. code-block:: sql

                  SELECT  COUNT(*) AS num_unidades_conservacao
                    FROM cnuc_2024_02;


.. collapse:: Resultado:


    .. tabs::


        .. tab:: SQL


            .. code-block:: text

                 num_unidades_conservacao
                --------------------------
                                     2742
                (1 row)


-----


**Consulta 2.** Recuperar o número de unidades de conservação por grupo e categoria.


.. collapse:: Solução:


    .. tabs::


        .. tab:: SQL


            .. code-block:: sql

                  SELECT grupo, categoria, COUNT(*) AS num_unidades_conservacao
                    FROM cnuc_2024_02
                GROUP BY grupo, categoria
                ORDER BY grupo, categoria;


.. collapse:: Resultado:


    .. tabs::


        .. tab:: SQL


            .. code-block:: text

                       grupo       |                categoria                 | num_unidades_conservacao
                -------------------+------------------------------------------+--------------------------
                 Proteção Integral | Estação Ecológica                        |                      102
                 Proteção Integral | Monumento Natural                        |                       83
                 Proteção Integral | Parque                                   |                      528
                 Proteção Integral | Refúgio de Vida Silvestre                |                       97
                 Proteção Integral | Reserva Biológica                        |                       63
                 Uso Sustentável   | Área de Proteção Ambiental               |                      428
                 Uso Sustentável   | Área de Relevante Interesse Ecológico    |                       89
                 Uso Sustentável   | Floresta                                 |                      103
                 Uso Sustentável   | Reserva de Desenvolvimento Sustentável   |                       46
                 Uso Sustentável   | Reserva Extrativista                     |                       96
                 Uso Sustentável   | Reserva Particular do Patrimônio Natural |                     1107
                (11 rows)


-----


**Consulta 3.** Recuperar informações sobre as geometrias das unidades de conservação (nome da coluna geométrica, SRID e tipo geométrico).


.. collapse:: Solução:


    .. tabs::


        .. tab:: SQL


            .. code-block:: sql

                SELECT *
                  FROM geometry_columns
                  WHERE f_table_name = 'cnuc_2024_02'


.. collapse:: Resultado:


    .. tabs::


        .. tab:: SQL


            .. code-block:: text

                 f_table_catalog | f_table_schema | f_table_name | f_geometry_column | coord_dimension | srid |     type
                -----------------+----------------+--------------+-------------------+-----------------+------+--------------
                 sicor           | public         | cnuc_2024_02 | geom              |               2 | 4674 | MULTIPOLYGON
                (1 row)


-----


**Consulta 4.** Recuperar o número de polígonos usados na demarcação das unidades de conservação.


.. collapse:: Solução:


    .. tabs::


        .. tab:: SQL


            .. code-block:: sql

                  SELECT ST_NumGeometries(geom) AS num_poligonos,
                         COUNT(*) AS num_unidades_conservacao
                    FROM cnuc_2024_02
                GROUP BY num_poligonos
                ORDER BY num_poligonos;


.. collapse:: Resultado:


    .. tabs::


        .. tab:: SQL


            .. code-block:: text

                 num_poligonos | num_unidades_conservacao
                ---------------+--------------------------
                             1 |                     2361
                             2 |                      196
                             3 |                       79
                             4 |                       36
                             5 |                       12
                             6 |                       12
                             7 |                        6
                             8 |                        5
                             9 |                        3
                            10 |                        1
                            11 |                        1
                            12 |                        1
                            13 |                        4
                            14 |                        3
                            15 |                        2
                            18 |                        2
                            19 |                        1
                            20 |                        2
                            22 |                        1
                            23 |                        1
                            31 |                        1
                            33 |                        1
                            38 |                        1
                            43 |                        1
                            47 |                        1
                            56 |                        1
                            67 |                        1
                            74 |                        1
                            86 |                        1
                           132 |                        1
                           139 |                        1
                           159 |                        1
                           200 |                        1
                (33 rows)


-----


**Consulta 5.** Validar as geometrias dos limites das unidades de conservação.


.. collapse:: Solução:


    .. tabs::


        .. tab:: SQL


            .. code-block:: sql

                SELECT COUNT(*) AS num_geometrias_invalidas
                  FROM cnuc_2024_02
                 WHERE NOT ST_IsValid(geom);


        .. tab:: Python


            O pacote `geobr` permite acessar a camada de informação contendo as unidades de conservação e obtém um ``GeoDataFrame`` do `GeoPandas`:


            .. code-block:: python

                import geobr

                ucs = geobr.unidades_conservacao()

                print(ucs.valid())


.. collapse:: Resultado:


    .. tabs::


        .. tab:: SQL


            .. code-block:: text

                NOTICE:  Self-intersection at or near point -55.357336254237282 -20.184060898305084
                 num_geometrias_invalidas
                --------------------------
                                        1
                (1 row)


        .. tab:: Python


-----


**Consulta 6.** Corrigir automaticamente as geometrias dos limites das unidades de conservação detectadas como inválidas.


.. collapse:: Solução:


    .. tabs::


        .. tab:: SQL


            .. code-block:: sql

                UPDATE cnuc_2024_02
                   SET geom = ST_MakeValid(geom)
                 WHERE NOT ST_IsValid(geom);


.. collapse:: Resultado:


    .. tabs::


        .. tab:: SQL


            .. code-block:: text

                NOTICE:  Self-intersection at or near point -55.357336254237282 -20.184060898305084
                UPDATE 1


-----


**Consulta 7.** Alterar o tipo de dados da coluna ``cria_ano`` da tabela ``cnuc_2024_02`` para o tipo :sql:`DATE`.


.. collapse:: Solução:


    .. tabs::


        .. tab:: SQL


            .. code-block:: sql

                ALTER TABLE cnuc_2024_02
                    ALTER COLUMN cria_ano SET DATA TYPE DATE
                        USING TO_DATE(cria_ano,'DD-MM-YYYY');


.. collapse:: Resultado:


    .. tabs::


        .. tab:: SQL


            .. code-block:: text

                ALTER TABLE


-----


.. _sec_bases_vetoriais_unidades_conservacao_consulta_8:

**Consulta 8.** Selecionar as glebas (a partir de 2021) que possuem intersecção com unidades de conservação criadas anteriormente à operação de crédito associada à gleba.


.. collapse:: Solução:


    .. tabs::


        .. tab:: SQL


            .. code-block:: sql

                CREATE TABLE glebas_x_ucs AS

                     SELECT ROW_NUMBER () OVER () AS gid,
                            gle.gid AS gid_gleba,
                            gle.ref_bacen AS ref_bacen,
                            gle.nu_ordem AS nu_ordem,
                            gle.nu_indice AS nu_indice,
                            ucs.gid AS gid_uc,
                            ST_Intersection(gle.geom, ucs.geom) AS geom

                       FROM sicor_glebas AS gle,
                            cnuc_2024_02 AS ucs

                      WHERE ST_INTERSECTS(gle.geom, ucs.geom)
                        AND gle.data_emissao_contrato >= ucs.cria_ano
                        AND extract(YEAR FROM gle.data_emissao_contrato) >= 2020

                   ORDER BY gle.data_emissao_contrato, gle.gid, ucs.gid;


.. collapse:: Resultado:


    .. tabs::


        .. tab:: SQL


            .. code-block:: text

                SELECT 67485


    A :numref:`Figura %s <fig:bases-vetoriais:glebas_x_ucs>` apresenta em destque as glebas com intersecção na área de proteção ambiental da Ilha do Bananal/Cantão.


    .. figure:: ../img/bases-vetoriais/glebas_x_ucs.png
        :alt: Destaque da intersecção de glebas com a unidade de conservação da Ilha do Bananal/Cantão
        :width: 80%
        :figclass: align-center
        :name: fig:bases-vetoriais:glebas_x_ucs

        Destaque da intersecção de glebas com a unidade de conservação da Ilha do Bananal/Cantão.


-----


**Consulta 9.** Quais os tipos geométricos resultantes da :ref:`Consulta 8 <sec_bases_vetoriais_unidades_conservacao_consulta_8>`?



.. collapse:: Solução:


    .. tabs::


        .. tab:: SQL


            .. code-block:: sql

                  SELECT ST_GeometryType(geom) AS tipo_geometrico,
                         COUNT(*) AS quantidade
                    FROM glebas_x_ucs
                GROUP BY tipo_geometrico
                ORDER BY tipo_geometrico;


.. collapse:: Resultado:


    .. tabs::


        .. tab:: SQL


            .. code-block:: text

                    tipo_geometrico    | quantidade
                -----------------------+------------
                 ST_GeometryCollection |          1
                 ST_MultiPolygon       |       1174
                 ST_Point              |        209
                 ST_Polygon            |      66101
                (4 rows)



-----


**Consulta 10.** Quais glebas selecionadas na :ref:`Consulta 8 <sec_bases_vetoriais_unidades_conservacao_consulta_8>` fazem intersecção com mais de uma unidade de conservação?


.. collapse:: Solução:


    .. tabs::


        .. tab:: SQL


            .. code-block:: sql

                  SELECT gid_gleba,
                         COUNT(*) AS numero_ucs

                    FROM glebas_x_ucs

                GROUP BY gid_gleba

                  HAVING COUNT(*) > 1

                ORDER BY numero_ucs DESC;


.. collapse:: Resultado:


    .. tabs::


        .. tab:: SQL


            .. code-block:: text

                 gid_gleba | numero_ucs
                -----------+------------
                   4688793 |          4
                   5439751 |          3
                    233968 |          3
                   4763247 |          3
                   2940431 |          3
                       ... |        ...
                   3614765 |          2
                   2790845 |          2
                   4384385 |          2
                   2920350 |          2
                   4549027 |          2
                (1664 rows)