<!DOCTYPE html>
<html class="writer-html5" lang="pt-BR" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.1.10. Glebas de Operações Contratadas com Recursos Públicos &mdash; GeoCreditoRural</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/table_styling.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tutorial.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="canonical" href="https://geo-credito-rural.github.io/sicor/microdados/glebas.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/translations.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Buscar" href="../../search.html" />
    <link rel="next" title="3.1.11. Verificação Topológica das Geometrias das Glebas" href="glebas-topologia.html" />
    <link rel="prev" title="3.1.9. Operações Contratadas com Recursos Públicos e Privados" href="operacoes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F0F8FF" >

          
          
          <a href="../../index.html" class="icon icon-home">
            GeoCreditoRural
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Pesquisar documentos" aria-label="Pesquisar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Menu de navegação">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Monitoramento de Operações de Crédito Rural por meio de Geotecnologias</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Aulas:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../sql/index.html">1. Introdução à Linguagem de Consulta SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jupyter/index.html">2. Ambiente de Computação Interativa</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">3. Acesso e Análise dos Dados do Sicor</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">3.1. Sicor - Tabelas e Microdados do Crédito Rural e do Proagro</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="preparacao-base-dados.html">3.1.1. Preparação da Base de Dados Sicor</a></li>
<li class="toctree-l3"><a class="reference internal" href="empreendimentos.html">3.1.2. Empreendimentos de Contratos de Crédito Rural</a></li>
<li class="toctree-l3"><a class="reference internal" href="ifs.html">3.1.3. Instituições Financeiras (IFs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="instrumento-credito.html">3.1.4. Instrumento de Crédito</a></li>
<li class="toctree-l3"><a class="reference internal" href="emitente.html">3.1.5. Categoria de Emitente</a></li>
<li class="toctree-l3"><a class="reference internal" href="fontes-recursos.html">3.1.6. Fontes de Recursos</a></li>
<li class="toctree-l3"><a class="reference internal" href="seguro.html">3.1.7. Garantia do Empreendimento</a></li>
<li class="toctree-l3"><a class="reference internal" href="programa.html">3.1.8. Programas ou Linhas de Crédito</a></li>
<li class="toctree-l3"><a class="reference internal" href="operacoes.html">3.1.9. Operações Contratadas com Recursos Públicos e Privados</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3.1.10. Glebas de Operações Contratadas com Recursos Públicos</a></li>
<li class="toctree-l3"><a class="reference internal" href="glebas-topologia.html">3.1.11. Verificação Topológica das Geometrias das Glebas</a></li>
<li class="toctree-l3"><a class="reference internal" href="glebas-forma.html">3.1.12. Avaliação da Forma das Glebas</a></li>
<li class="toctree-l3"><a class="reference internal" href="pedidos-cobertura-proagro.html">3.1.13. Pedidos de cobertura do Proagro (COP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mutuarios.html">3.1.14. Mutuários</a></li>
<li class="toctree-l3"><a class="reference internal" href="cooperados.html">3.1.15. Cooperados</a></li>
<li class="toctree-l3"><a class="reference internal" href="propriedades.html">3.1.16. Propriedades</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../zarc-db.html">3.2. Zoneamento Agrícola de Risco Climático (ZARC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analises.html">3.3. Análise da Qualidade dos Dados do Sicor</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../bases-vetoriais/index.html">4. Análise dos Dados do Sicor com base em Dados Vetoriais</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Referências Bibliográficas</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../referencias.html">Referências Bibliográficas</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Informações Gerais:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../licenca.html">Licença</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../agradecimentos.html">Agradecimentos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Índice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossário</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../search.html">Página de Busca</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Menu de navegação móvel"  style="background: #F0F8FF" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoCreditoRural</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Navegação da página">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><span class="section-number">3. </span>Acesso e Análise dos Dados do Sicor</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">3.1. </span>Sicor - Tabelas e Microdados do Crédito Rural e do Proagro</a></li>
      <li class="breadcrumb-item active"><span class="section-number">3.1.10. </span>Glebas de Operações Contratadas com Recursos Públicos</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Navegação sequencial da página">
        <a href="operacoes.html" class="btn btn-neutral float-left" title="3.1.9. Operações Contratadas com Recursos Públicos e Privados" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="glebas-topologia.html" class="btn btn-neutral float-right" title="3.1.11. Verificação Topológica das Geometrias das Glebas" accesskey="n">Próximo <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="glebas-de-operacoes-contratadas-com-recursos-publicos">
<span id="sec-sicor-microdados-glebas"></span><h1><span class="section-number">3.1.10. </span>Glebas de Operações Contratadas com Recursos Públicos<a class="headerlink" href="#glebas-de-operacoes-contratadas-com-recursos-publicos" title="Link permanente para este cabeçalho"></a></h1>
<p>Como parte dos microdados do Sicor disponibilizados publicamente, encontram-se as glebas associadas às operações de crédito contratadas com recursos públicos. As figuras mostradas na <a class="reference internal" href="#tbl-sicor-microdados-mapa-glebas-mg-2022"><span class="std std-numref">Tabela 3.10</span></a> são um recorte temporal (2022) e espacial (Minas Gerais e Triângulo Mineiro) dessas glebas.</p>
<table class="styled-table docutils align-center" id="tbl-sicor-microdados-mapa-glebas-mg-2022" style="width: 100%">
<caption><span class="caption-number">Tabela 3.10 - </span><span class="caption-text">Glebas das operações contratadas com recursos públicos do ano de 2022 localizadas no Estado de Minas Gerais.</span><a class="headerlink" href="#tbl-sicor-microdados-mapa-glebas-mg-2022" title="Link Permanente para essa tabela"></a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td class="center-align"><p><img alt="fig:sicor:microdados:glebas:mapa-glebas-mg-2022" src="../../_images/mapa-glebas-mg-2022.png" /></p></td>
<td class="center-align"><p><img alt="fig:sicor:microdados:glebas:mapa-glebas-triangulo-mg-2022" src="../../_images/mapa-glebas-triangulo-mg-2022.png" /></p></td>
</tr>
</tbody>
</table>
<p>Esses microdados são disponibilizados no sítio do Banco Central em arquivos no formato CSV, particionados por ano, entre 2013 e 2024, como mostrado abaixo:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/sicor_glebas_wkt_2013.gz">SICOR_GLEBAS_WKT_2013.gz</a></p></li>
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/sicor_glebas_wkt_2014.gz">SICOR_GLEBAS_WKT_2014.gz</a></p></li>
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/sicor_glebas_wkt_2015.gz">SICOR_GLEBAS_WKT_2015.gz</a></p></li>
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/sicor_glebas_wkt_2016.gz">SICOR_GLEBAS_WKT_2016.gz</a></p></li>
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/sicor_glebas_wkt_2017.gz">SICOR_GLEBAS_WKT_2017.gz</a></p></li>
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/sicor_glebas_wkt_2018.gz">SICOR_GLEBAS_WKT_2018.gz</a></p></li>
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/sicor_glebas_wkt_2019.gz">SICOR_GLEBAS_WKT_2019.gz</a></p></li>
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/sicor_glebas_wkt_2020.gz">SICOR_GLEBAS_WKT_2020.gz</a></p></li>
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/sicor_glebas_wkt_2021.gz">SICOR_GLEBAS_WKT_2021.gz</a></p></li>
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/sicor_glebas_wkt_2022.gz">SICOR_GLEBAS_WKT_2022.gz</a></p></li>
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/sicor_glebas_wkt_2023.gz">SICOR_GLEBAS_WKT_2023.gz</a></p></li>
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/sicor_glebas_wkt_2024.gz">SICOR_GLEBAS_WKT_2024.gz</a></p></li>
</ul>
<p>A estrutura desses arquivos pode ser vista na <a class="reference internal" href="#tbl-sicor-microdados-sicor-glebas-wkt"><span class="std std-numref">Tabela 3.11</span></a>.</p>
<table class="styled-table docutils align-center" id="tbl-sicor-microdados-sicor-glebas-wkt">
<caption><span class="caption-number">Tabela 3.11 - </span><span class="caption-text">Estrutura dos arquivos contendo os limites das glebas de contratos com recursos públicos.</span><a class="headerlink" href="#tbl-sicor-microdados-sicor-glebas-wkt" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head center-align"></th>
<th class="head center-align"><p>nome</p></th>
<th class="head center-align"><p>tipo</p></th>
<th class="head center-align"><p>descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong>, FK</p></td>
<td class="left-align"><p>ref_bacen</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número mascarado de referência do contrato</p></td>
</tr>
<tr class="row-odd"><td class="center-align"><p><strong>PK</strong>, FK</p></td>
<td class="left-align"><p>nu_ordem</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número da destinação/finalidade dentro do contrato</p></td>
</tr>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong></p></td>
<td class="left-align"><p>nu_indice</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Identificador da gleba dentro da operação</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>gt_geometria</p></td>
<td class="center-align"><p>text</p></td>
<td class="left-align"><p>Geometria da gleba no formato Well-Know Text (WKT)</p></td>
</tr>
</tbody>
</table>
<p>No Sicor, as glebas são representadas textualmente utilizando uma notação conhecida por <strong>Well-Know Text</strong> ou <a class="reference internal" href="../../glossary.html#term-WKT"><span class="xref std std-term">WKT</span></a>, que permite representar elementos geométricos tais como geometrias elementares (pontos, linhas e polígonos) e coleções homogêneas de geometrias (coleção de pontos, coleção de linhas e coleção de polígonos), conforme pode ser visto na <a class="reference internal" href="#tbl-sicor-microdados-glebas-wkt-geom"><span class="std std-numref">Tabela 3.12</span></a>.</p>
<table class="styled-table docutils align-center" id="tbl-sicor-microdados-glebas-wkt-geom" style="width: 100%">
<caption><span class="caption-number">Tabela 3.12 - </span><span class="caption-text">Exemplos de geometrias.</span><a class="headerlink" href="#tbl-sicor-microdados-glebas-wkt-geom" title="Link Permanente para essa tabela"></a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td class="center-align"><p>( a ) Geometrias Simples</p></td>
<td class="center-align"><p>( b ) Coleções Pontos e Linhas</p></td>
<td class="center-align"><p>( c ) Coleções Polígonos</p></td>
</tr>
<tr class="row-even"><td class="center-align"><p><img alt="fig:sicor:microdados:glebas:wkt-pt-lin-pol" src="../../_images/wkt-pt-lin-pol.png" /></p></td>
<td class="center-align"><p><img alt="fig:sicor:microdados:glebas:wkt-mpt-mlin" src="../../_images/wkt-mpt-mlin.png" /></p></td>
<td class="center-align"><p><img alt="fig:sicor:microdados:glebas:wkt-mpoly" src="../../_images/wkt-mpoly.png" /></p></td>
</tr>
</tbody>
</table>
<p>Na notação WKT, o ponto de coordenadas <span class="math notranslate nohighlight">\(x = 1\)</span> e <span class="math notranslate nohighlight">\(y = 8\)</span> mostrado na <a class="reference internal" href="#tbl-sicor-microdados-glebas-wkt-geom"><span class="std std-numref">Tabela 3.12a</span></a>, é descrito pela seguinte cadeia de caracteres ou <em>string</em>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;POINT(1 8)&#39;</span>
</pre></div>
</div>
<p>A linha definida a partir de interpolações lineares de três vértices consecutivos mostrada na <a class="reference internal" href="#tbl-sicor-microdados-glebas-wkt-geom"><span class="std std-numref">Tabela 3.12a</span></a> é descrita pela seguinte string:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;LINESTRING(1 5, 3 6, 4 5)&#39;</span>
</pre></div>
</div>
<p>O polígono simples, formado por um anel externo e um anel interno, mostrado na <a class="reference internal" href="#tbl-sicor-microdados-glebas-wkt-geom"><span class="std std-numref">Tabela 3.12a</span></a> é descrito pela seguinte string:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;POLYGON( (1 1, 2 3, 5 4, 5 1, 1 1), (3 2, 4 3, 4 2, 3 2) )&#39;</span>
</pre></div>
</div>
<p>A coleção de pontos mostrada na <a class="reference internal" href="#tbl-sicor-microdados-glebas-wkt-geom"><span class="std std-numref">Tabela 3.12b</span></a>, é descrita por:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;MULTIPOINT(1 8, 3 7, 4 9, 2 9)&#39;</span>
</pre></div>
</div>
<p>A coleção de linhas (<a class="reference internal" href="#tbl-sicor-microdados-glebas-wkt-geom"><span class="std std-numref">Tabela 3.12b</span></a>), é descrita por:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;MULTILINESTRING( (1 2, 3 3, 4 2), (4 3, 6 2) )&#39;</span>
</pre></div>
</div>
<p>Finalmente, a coleção de polígonos (<a class="reference internal" href="#tbl-sicor-microdados-glebas-wkt-geom"><span class="std std-numref">Tabela 3.12c</span></a>), é descrita por:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;MULTIPOLYGON( ( (1 4, 2 6, 4 5, 3 4, 1 4) ),</span>
<span class="s1">               ( (1 1, 2 3, 5 4, 5 1, 1 1), (3 2, 4 3, 4 2, 3 2) ) )&#39;</span>
</pre></div>
</div>
<p>A coluna <code class="docutils literal notranslate"><span class="pre">gt_geometria</span></code> , portanto, pode conter elementos geométricos descritos no formato WKT. As geometrias no Sicor são codificadas em coordenadas geográficas (LAT/LONG) no sistema geodésico de referência SIRGAS 2000.</p>
<div class="admonition tip">
<p class="admonition-title">Dica</p>
<p>As geotecnologias que utilizam códigos EPSG para referenciar <strong>sistemas de referecial espacial (SRS)</strong> definem o código EPSG:4674 para coordenadas geográficas (LAT/LONG) no sistema geodésico de referência SIRGAS 2000.</p>
</div>
<p>Os arquivos listados acima foram carregados na tabela <code class="docutils literal notranslate"><span class="pre">sicor_glebas_wkt</span></code> do banco de dados PostgreSQL. A <a class="reference internal" href="#fig-sicor-microdados-er-sicor-glebas-wkt"><span class="std std-numref">Figura 3.3</span></a> apresenta o relacionamento dessa tabela com a tabela de operações contratadas.</p>
<figure class="align-center align-default" id="fig-sicor-microdados-er-sicor-glebas-wkt">
<a class="reference internal image-reference" href="../../_images/er-sicor-glebas-wkt.png"><img alt="Diagrama Entidade-Relacionamento das glebas de contratações com recursos públicos (simplificado)" src="../../_images/er-sicor-glebas-wkt.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-number">Figura 3.3 - </span><span class="caption-text">Diagrama Entidade-Relacionamento das glebas de contratações com recursos públicos (simplificado).</span><a class="headerlink" href="#fig-sicor-microdados-er-sicor-glebas-wkt" title="Link Permanente para essa imagem"></a></p>
</figcaption>
</figure>
<p>No diagrama acima, as colunas <code class="docutils literal notranslate"><span class="pre">ref_bacen</span></code> e <code class="docutils literal notranslate"><span class="pre">nu_ordem</span></code> relacionam com as respectivas colunas da tabela <code class="docutils literal notranslate"><span class="pre">sicor_operacao_basica_estado</span></code>, ligando a geometria de uma gleba à operação de contratação de crédito (<a class="reference internal" href="operacoes.html#sec-sicor-microdados-operacoes"><span class="std std-numref">Seção 3.1.9 - Operações Contratadas com Recursos Públicos e Privados</span></a>).</p>
<p>A organização dos dados nessa tabela de glebas permite que mais de uma geometria seja associada a uma mesma operação, por isso a coluna <code class="docutils literal notranslate"><span class="pre">nu_indice</span></code> faz parte da chave primária da tabela.</p>
<div class="admonition tip">
<p class="admonition-title">Dica</p>
<p>O comando SQL para definição dessa tabela no PostgreSQL é apresentado no <a class="reference internal" href="#code-sicor-microdados-glebas-sql-create-table-sicor-glebas-wkt"><span class="std std-numref">Trecho de Código 3.8</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="code-sicor-microdados-glebas-sql-create-table-sicor-glebas-wkt">
<div class="code-block-caption"><span class="caption-number">Trecho de Código 3.8 - </span><span class="caption-text">Criação da tabela <code class="docutils literal notranslate"><span class="pre">sicor_glebas_wkt</span></code>.</span><a class="headerlink" href="#code-sicor-microdados-glebas-sql-create-table-sicor-glebas-wkt" title="Link Permanente para esse código"></a></div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">--</span>
<span class="c1">-- Tabela: Glebas de operações em formato WKT.</span>
<span class="c1">--</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">sicor_glebas_wkt</span>
<span class="p">(</span>
<span class="w">  </span><span class="n">ref_bacen</span><span class="w">     </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">  </span><span class="n">nu_ordem</span><span class="w">      </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">  </span><span class="n">nu_indice</span><span class="w">     </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">  </span><span class="n">gt_geometria</span><span class="w">  </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
<span class="p">);</span>

<span class="c1">--</span>
<span class="c1">-- Definição de chave primária formada pelos campos ref_bacen, nu_ordem e nu_indice.</span>
<span class="c1">--</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">sicor_glebas_wkt</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">sicor_glebas_wkt_pkey</span><span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">ref_bacen</span><span class="p">,</span><span class="w"> </span><span class="n">nu_ordem</span><span class="p">,</span><span class="w"> </span><span class="n">nu_indice</span><span class="p">);</span>

<span class="c1">--</span>
<span class="c1">-- Definição de integridade referencial entre as sicor_operacao_basica_estado e tabelas sicor_glebas_wkt</span>
<span class="c1">--</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">sicor_glebas_wkt</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">sicor_glebas_wkt_ref_bacen_fkey</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">ref_bacen</span><span class="p">,</span><span class="w"> </span><span class="n">nu_ordem</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">sicor_operacao_basica_estado</span><span class="p">(</span><span class="n">ref_bacen</span><span class="p">,</span><span class="w"> </span><span class="n">nu_ordem</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">NO</span><span class="w"> </span><span class="n">ACTION</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Dica</p>
<p>O PostgreSQL fornece um comando para uso via SQL chamado <code class="docutils literal notranslate"><span class="pre">COPY</span></code> que permite mover dados de arquivos para tabelas do banco de dados e vice-versa. Este comando permite lidar com arquivos texto, CSV e binários. Esse comando de importação e exportação de dados é usado pelo meta-comando <code class="docutils literal notranslate"><span class="pre">\copy</span></code> dos aplicativos <em>psql</em> e <em>pgAdmin</em>. Portanto, para carregar o arquivo CSV contendo as glebas do ano de 2022 para a tabela <code class="docutils literal notranslate"><span class="pre">sicor_glebas_wkt</span></code> podemos usar o seguinte comando:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="kp">\copy</span><span class="w"> </span><span class="ss">sicor_glebas_wkt</span><span class="w"> </span><span class="ss">FROM</span><span class="w"> </span><span class="s1">&#39;/dados/sicor_glebas_wkt_2022.csv&#39;</span>
<span class="go">                       WITH (DELIMITER &#39;;&#39;, FORMAT CSV, HEADER, ENCODING &#39;WIN1252&#39;);</span>
</pre></div>
</div>
</div>
<p>A representação WKT trata-se apenas de um texto e como tal, não permite realizar operações geométricas diretamente, como o cálculo de área e de perímetro. Logo, o formato WKT usado pelo Sicor na representação das glebas precisa ser transformado em um tipo de dado do PostgreSQL que permita realizar essas operações. O tipo <strong>PostGIS Geometry</strong> permite representar geometrias no <strong>Plano Cartesiano</strong> e pode ser construído a partir de um texto WKT através de uma operação de <strong>coerção de tipo</strong>, que consiste na transformação da string WKT em um objeto geométrico do PostGIS utilizando o operador de <strong>cast</strong> <code class="docutils literal notranslate"><span class="pre">::</span></code>. Por exemplo, para converter um polígono representado em WKT para uma geometria do PostGIS do tipo <em>polygon</em> associado ao <em>SRS 4674</em>, podemos fazer:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;POLYGON( (1 1, 2 3, 5 4, 5 1, 1 1), (3 2, 4 3, 4 2, 3 2) )&#39;</span><span class="p">::</span><span class="n">geometry</span><span class="p">(</span><span class="n">POLYGON</span><span class="p">,</span><span class="w"> </span><span class="mi">4674</span><span class="p">);</span>
</pre></div>
</div>
<p>O resultado do comando acima é uma geometria no formato binário do PostGIS (EWKB) que é apresentado na forma de uma string codificada em hexadecimal (HEXEWKB):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                 geometry
----------------------------------------------------------------------------------------------
 0103000020421200000200000005000000000000000000F03F00000000...00000000000008400000000000000040
(1 row)
</pre></div>
</div>
<p>O tipo PostGIS Geometry suporta diversas operações, entre elas:</p>
<ul class="open">
<li><p><strong>Entrada e Saída:</strong> <code class="docutils literal notranslate"><span class="pre">ST_GeomFromText</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_AsWKT</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_AsGeoJSON</span></code>.</p></li>
<li><p><strong>Propriedades:</strong> <code class="docutils literal notranslate"><span class="pre">ST_GeometryType</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_IsSimple</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_Envelope</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_Zmflag</span></code>.</p></li>
<li><p><strong>Métricas:</strong> <code class="docutils literal notranslate"><span class="pre">ST_Area</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_Perimeter</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_Distance</span></code>.</p></li>
<li><p><strong>Relacionamentos espaciais ou relacionamentos topológicos:</strong>  <code class="docutils literal notranslate"><span class="pre">ST_Contains</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_Within</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_Covers</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_CoveredBy`</span> <span class="pre">,</span> <span class="pre">``ST_Crosses</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_Overlaps</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_Equals</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_Disjoint</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_Intersects</span></code>.</p></li>
<li><p><strong>Conjunto:</strong> <code class="docutils literal notranslate"><span class="pre">ST_Intersection</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_Union</span></code> <code class="docutils literal notranslate"><span class="pre">ST_Difference</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_SymDifference</span></code>.</p></li>
<li><p><strong>Construções geométricas:</strong> <code class="docutils literal notranslate"><span class="pre">ST_Buffer</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_Centroid</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_PointOnSurface</span></code>,  <code class="docutils literal notranslate"><span class="pre">ST_GeneratePoints</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_MinimumBoundingCircle</span></code>, <code class="docutils literal notranslate"><span class="pre">ST_OrientedEnvelope</span></code>.</p></li>
</ul>
<p>Para ilustrar o uso do tipo PostGIS Geometry, vamos construir uma consulta SQL que compute o total de geometrias de cada tipo (<a class="reference internal" href="#code-sicor-microdados-glebas-sql-tipos-geometricos"><span class="std std-numref">Trecho de Código 3.9</span></a>). Para isso, iremos transformar o texto WKT da coluna <code class="docutils literal notranslate"><span class="pre">gt_geometria</span></code> em um objeto geométrico e, em seguida, utilizar a função <code class="docutils literal notranslate"><span class="pre">ST_GeometryType</span></code> para determinar o seu tipo.</p>
<div class="literal-block-wrapper docutils container" id="code-sicor-microdados-glebas-sql-tipos-geometricos">
<div class="code-block-caption"><span class="caption-number">Trecho de Código 3.9 - </span><span class="caption-text">Tipos geométricos das glebas.</span><a class="headerlink" href="#code-sicor-microdados-glebas-sql-tipos-geometricos" title="Link Permanente para esse código"></a></div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">ST_GeometryType</span><span class="p">(</span><span class="n">gt_geometria</span><span class="p">::</span><span class="n">GEOMETRY</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tipo_geometrico</span><span class="p">,</span>
<span class="w">         </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_geometrias</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_glebas_wkt</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">tipo_geometrico</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">tipo_geometrico</span><span class="p">;</span>
</pre></div>
</div>
</div>
<p>Saída:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> tipo_geometrico | num_geometrias
-----------------+----------------
 ST_MultiPolygon |          11159
 ST_Point        |           3940
 ST_Polygon      |        5801274
(3 rows)
</pre></div>
</div>
<p>Portanto, considerando todos os microdados de glebas<a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, pode ser observado a existência de 5.816.381 geometrias divididas nos seguintes tipos:</p>
<ul class="open">
<li><p><strong>Point:</strong> 3.940</p></li>
<li><p><strong>Polygon:</strong> 5.801.274</p></li>
<li><p><strong>MultiPolygon:</strong> 11.159</p></li>
</ul>
<p>Para obter os tipos geométricos das glebas e o total desses tipos em cada ano, é necessário construir uma consulta incluindo a tabela <code class="docutils literal notranslate"><span class="pre">sicor_operacao_basica_estado</span></code>, que se relaciona com a tabela <code class="docutils literal notranslate"><span class="pre">sicor_glebas_wkt</span></code> e possui a coluna <code class="docutils literal notranslate"><span class="pre">dt_emissao</span></code> que contém o registro das datas de contratação dos financiamentos. Portanto, esta consulta precisa utilizar as tabelas <code class="docutils literal notranslate"><span class="pre">sicor_glebas_wkt</span></code> e <code class="docutils literal notranslate"><span class="pre">sicor_operacao_basica_estado</span></code>, relacionando os campos associados, <code class="docutils literal notranslate"><span class="pre">ref_bacen</span></code> e <code class="docutils literal notranslate"><span class="pre">nu_ordem</span></code> e deve usar o ano da data de contratação (<code class="docutils literal notranslate"><span class="pre">dt_emissao</span></code>) e o tipo geométrico (<code class="docutils literal notranslate"><span class="pre">ST_GeometryType</span></code>) para definir o agrupamento para a totalização dos tipos geométricos (<a class="reference internal" href="#code-sicor-microdados-glebas-sql-tipos-geometricos-ano"><span class="std std-numref">Trecho de Código 3.10</span></a>).</p>
<div class="literal-block-wrapper docutils container" id="code-sicor-microdados-glebas-sql-tipos-geometricos-ano">
<div class="code-block-caption"><span class="caption-number">Trecho de Código 3.10 - </span><span class="caption-text">Tipos geométricos das glebas.</span><a class="headerlink" href="#code-sicor-microdados-glebas-sql-tipos-geometricos-ano" title="Link Permanente para esse código"></a></div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="k">Extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">contratos</span><span class="p">.</span><span class="n">dt_emissao</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span>
<span class="w">         </span><span class="n">ST_GeometryType</span><span class="p">(</span><span class="n">gt_geometria</span><span class="p">::</span><span class="n">GEOMETRY</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tipo_geometrico</span><span class="p">,</span>
<span class="w">         </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_geometrias</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_glebas_wkt</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">glebas</span><span class="p">,</span>
<span class="w">         </span><span class="n">sicor_operacao_basica_estado</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">contratos</span>
<span class="w">   </span><span class="k">WHERE</span><span class="w"> </span><span class="n">glebas</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contratos</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">     </span><span class="k">AND</span><span class="w"> </span><span class="n">glebas</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contratos</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span><span class="w"> </span><span class="n">tipo_geometrico</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span><span class="w"> </span><span class="n">tipo_geometrico</span><span class="p">;</span>
</pre></div>
</div>
</div>
<p>A consulta acima irá retornar uma saída semelhante à mostrada abaixo:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> ano  | tipo_geometrico | num_geometrias
------+-----------------+----------------
 2013 | ST_MultiPolygon |             63
 2013 | ST_Polygon      |            584
 2014 | ST_MultiPolygon |            761
 2014 | ST_Polygon      |           1210
 2015 | ST_MultiPolygon |           6360
 2015 | ST_Polygon      |           2589
 2016 | ST_MultiPolygon |           3419
 2016 | ST_Polygon      |          87055
 2017 | ST_MultiPolygon |            387
 2017 | ST_Polygon      |         315406
 2018 | ST_MultiPolygon |             28
 2018 | ST_Point        |            182
 2018 | ST_Polygon      |         397443
 2019 | ST_MultiPolygon |             12
 2019 | ST_Point        |            539
 2019 | ST_Polygon      |         611944
 2020 | ST_MultiPolygon |             25
 2020 | ST_Point        |           3166
 2020 | ST_Polygon      |         889510
 2021 | ST_MultiPolygon |             29
 2021 | ST_Point        |             53
 2021 | ST_Polygon      |         991082
 2022 | ST_MultiPolygon |             39
 2022 | ST_Polygon      |        1073743
 2023 | ST_MultiPolygon |             36
 2023 | ST_Polygon      |        1131550
 2024 | ST_Polygon      |         299158
(27 rows)
</pre></div>
</div>
<p>Outra avaliação que podemos fazer sobre as geometrias das glebas diz respeito à dimensão de suas coordenadas, isto é, se temos geometrias 2D e 3D. A função <code class="docutils literal notranslate"><span class="pre">ST_Zmflag</span></code> do PostGIS retorna um código informando se a dimensão das coordenadas é 2D, 3D, 4D ou 3D-M (no caso de uma das dimensões estar associada a medidas). A consulta apresentada no <a class="reference internal" href="#code-sicor-microdados-glebas-sql-dimensao-geometrias"><span class="std std-numref">Techo de Código 3.11</span></a> mostra como obter essa informação.</p>
<div class="literal-block-wrapper docutils container" id="code-sicor-microdados-glebas-sql-dimensao-geometrias">
<div class="code-block-caption"><span class="caption-number">Trecho de Código 3.11 - </span><span class="caption-text">Tipos geométricos das glebas.</span><a class="headerlink" href="#code-sicor-microdados-glebas-sql-dimensao-geometrias" title="Link Permanente para esse código"></a></div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="k">Extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">contratos</span><span class="p">.</span><span class="n">dt_emissao</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span>
<span class="w">         </span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">ST_Zmflag</span><span class="p">(</span><span class="n">gt_geometria</span><span class="p">::</span><span class="n">GEOMETRY</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;2D&#39;</span>
<span class="w">              </span><span class="k">WHEN</span><span class="w"> </span><span class="n">ST_Zmflag</span><span class="p">(</span><span class="n">gt_geometria</span><span class="p">::</span><span class="n">GEOMETRY</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;3D-M&#39;</span>
<span class="w">              </span><span class="k">WHEN</span><span class="w"> </span><span class="n">ST_Zmflag</span><span class="p">(</span><span class="n">gt_geometria</span><span class="p">::</span><span class="n">GEOMETRY</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;3D-Z&#39;</span>
<span class="w">              </span><span class="k">WHEN</span><span class="w"> </span><span class="n">ST_Zmflag</span><span class="p">(</span><span class="n">gt_geometria</span><span class="p">::</span><span class="n">GEOMETRY</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;4D&#39;</span>
<span class="w">              </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;ERRO&#39;</span>
<span class="w">         </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dimensao</span><span class="p">,</span>
<span class="w">         </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_geometrias</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_glebas_wkt</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">glebas</span><span class="p">,</span>
<span class="w">         </span><span class="n">sicor_operacao_basica_estado</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">contratos</span>
<span class="w">   </span><span class="k">WHERE</span><span class="w"> </span><span class="n">glebas</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contratos</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">     </span><span class="k">AND</span><span class="w"> </span><span class="n">glebas</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contratos</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span><span class="w"> </span><span class="n">dimensao</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span><span class="w"> </span><span class="n">dimensao</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> ano  | dimensao | num_geometrias
------+----------+----------------
 2013 | 2D       |            263
 2013 | 3D       |            384
 2014 | 2D       |            819
 2014 | 3D       |           1152
 2015 | 2D       |           6643
 2015 | 3D       |           2306
 2016 | 2D       |           3639
 2016 | 3D       |          86835
 2017 | 2D       |            518
 2017 | 3D       |         315275
 2018 | 2D       |             46
 2018 | 3D       |         397607
 2019 | 2D       |             30
 2019 | 3D       |         612465
 2020 | 2D       |             30
 2020 | 3D       |         892671
 2021 | 2D       |             41
 2021 | 3D       |         991123
 2022 | 2D       |             52
 2022 | 3D       |        1073730
 2023 | 2D       |             68
 2023 | 3D       |        1131518
 2024 | 3D       |         299158
(23 rows)
</pre></div>
</div>
<p>As geometrias são formadas em alguns casos por mais de uma parte, como pode ser observado no resultado da consulta mostrada no <a class="reference internal" href="#code-sicor-microdados-glebas-sql-geometrias-multiparte"><span class="std std-numref">Techo de Código 3.12</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="code-sicor-microdados-glebas-sql-geometrias-multiparte">
<div class="code-block-caption"><span class="caption-number">Trecho de Código 3.12 - </span><span class="caption-text">Tipos geométricos das glebas.</span><a class="headerlink" href="#code-sicor-microdados-glebas-sql-geometrias-multiparte" title="Link Permanente para esse código"></a></div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="k">Extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">contratos</span><span class="p">.</span><span class="n">dt_emissao</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span>
<span class="w">         </span><span class="n">ST_GeometryType</span><span class="p">(</span><span class="n">gt_geometria</span><span class="p">::</span><span class="n">geometry</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tipo_geometrico</span><span class="p">,</span>
<span class="w">         </span><span class="n">ST_NumGeometries</span><span class="p">(</span><span class="n">gt_geometria</span><span class="p">::</span><span class="n">geometry</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_partes</span><span class="p">,</span>
<span class="w">         </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_geometrias</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_glebas_wkt</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">glebas</span><span class="p">,</span>
<span class="w">         </span><span class="n">sicor_operacao_basica_estado</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">contratos</span>
<span class="w">   </span><span class="k">WHERE</span><span class="w"> </span><span class="n">glebas</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contratos</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">     </span><span class="k">AND</span><span class="w"> </span><span class="n">glebas</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contratos</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span><span class="w"> </span><span class="n">tipo_geometrico</span><span class="p">,</span><span class="w"> </span><span class="n">num_partes</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span><span class="w"> </span><span class="n">tipo_geometrico</span><span class="p">,</span><span class="w"> </span><span class="n">num_partes</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> ano  | tipo_geometrico | num_partes | num_geometrias
------+-----------------+------------+----------------
 2013 | ST_MultiPolygon |          2 |             57
 2013 | ST_MultiPolygon |          3 |              5
 2013 | ST_MultiPolygon |          4 |              1
 2013 | ST_Polygon      |          1 |            584
 2014 | ST_MultiPolygon |          2 |            295
 2014 | ST_MultiPolygon |          3 |             77
 2014 | ST_MultiPolygon |          4 |             62
 ...
 2014 | ST_MultiPolygon |         42 |              1
 2014 | ST_MultiPolygon |         46 |              1
 2014 | ST_MultiPolygon |         50 |              1
 2014 | ST_MultiPolygon |         58 |              1
 ...
 2021 | ST_MultiPolygon |          2 |             27
 2021 | ST_MultiPolygon |          3 |              1
 2021 | ST_MultiPolygon |          4 |              1
 2021 | ST_Point        |          1 |             53
 2021 | ST_Polygon      |          1 |         991082
 2022 | ST_MultiPolygon |          2 |             35
 2022 | ST_MultiPolygon |          3 |              4
 2022 | ST_Polygon      |          1 |        1073743
 2023 | ST_MultiPolygon |          2 |             36
 2023 | ST_Polygon      |          1 |        1131550
 2024 | ST_Polygon      |          1 |         299158
(207 rows)
</pre></div>
</div>
<hr class="docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Considerando os dados baixados em 11 de Junho de 2024.</p>
</aside>
</aside>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Rodapé">
        <a href="operacoes.html" class="btn btn-neutral float-left" title="3.1.9. Operações Contratadas com Recursos Públicos e Privados" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="glebas-topologia.html" class="btn btn-neutral float-right" title="3.1.11. Verificação Topológica das Geometrias das Glebas" accesskey="n" rel="next">Próximo <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Time.</p>
  </div>

  
<jinja2.runtime.BlockReference object at 0x7f20e64c50d0>
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-nc-sa.png" width="117" height="41"/></a> This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons “Attribution-NonCommercial-ShareAlike 4.0 International” license</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>