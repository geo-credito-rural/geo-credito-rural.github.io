<!DOCTYPE html>
<html class="writer-html5" lang="pt-BR" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.1.13. Pedidos de cobertura do Proagro (COP) &mdash; GeoCreditoRural</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/table_styling.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tutorial.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="canonical" href="https://geo-credito-rural.github.io/sicor/microdados/pedidos-cobertura-proagro.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/tabs.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Buscar" href="../../search.html" />
    <link rel="next" title="3.1.14. Mutuários" href="mutuarios.html" />
    <link rel="prev" title="3.1.12. Avaliação da Forma das Glebas" href="glebas-forma.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F0F8FF" >

          
          
          <a href="../../index.html" class="icon icon-home">
            GeoCreditoRural
              <img src="../../_static/logo.jpeg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Pesquisar documentos" aria-label="Pesquisar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Menu de navegação">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Monitoramento de Operações de Crédito Rural por meio de Geotecnologias</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Aulas:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../sql/index.html">1. Introdução à Linguagem de Consulta SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jupyter/index.html">2. Ambiente de Computação Interativa</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">3. Dados do Sicor</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">3.1. Sicor - Tabelas e Microdados do Crédito Rural e do Proagro</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="preparacao-base-dados.html">3.1.1. Preparação da Base de Dados Sicor</a></li>
<li class="toctree-l3"><a class="reference internal" href="empreendimentos.html">3.1.2. Empreendimentos de Contratos de Crédito Rural</a></li>
<li class="toctree-l3"><a class="reference internal" href="ifs.html">3.1.3. Instituições Financeiras (IFs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="instrumento-credito.html">3.1.4. Instrumento de Crédito</a></li>
<li class="toctree-l3"><a class="reference internal" href="emitente.html">3.1.5. Categoria de Emitente</a></li>
<li class="toctree-l3"><a class="reference internal" href="fontes-recursos.html">3.1.6. Fontes de Recursos</a></li>
<li class="toctree-l3"><a class="reference internal" href="seguro.html">3.1.7. Garantia do Empreendimento</a></li>
<li class="toctree-l3"><a class="reference internal" href="programa.html">3.1.8. Programas ou Linhas de Crédito</a></li>
<li class="toctree-l3"><a class="reference internal" href="operacoes.html">3.1.9. Operações Contratadas com Recursos Públicos e Privados</a></li>
<li class="toctree-l3"><a class="reference internal" href="glebas.html">3.1.10. Glebas de Operações Contratadas com Recursos Públicos</a></li>
<li class="toctree-l3"><a class="reference internal" href="glebas-topologia.html">3.1.11. Verificação Topológica das Geometrias das Glebas</a></li>
<li class="toctree-l3"><a class="reference internal" href="glebas-forma.html">3.1.12. Avaliação da Forma das Glebas</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3.1.13. Pedidos de cobertura do Proagro (COP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mutuarios.html">3.1.14. Mutuários</a></li>
<li class="toctree-l3"><a class="reference internal" href="cooperados.html">3.1.15. Cooperados</a></li>
<li class="toctree-l3"><a class="reference internal" href="propriedades.html">3.1.16. Propriedades</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../zarc.html">3.2. Zoneamento Agrícola de Risco Climático (ZARC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../consultas.html">3.3. Consultas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../consideracoes.html">3.4. Considerações Finais</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../bases-vetoriais/index.html">4. Impedimentos Sociais, Ambientais e Climáticos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../uso-cobertura-terra/index.html">5. Uso e Cobertura da Terra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acesso-imagens/index.html">6. Imagens de Satélites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../series-temporais/index.html">7. Séries Temporais de Imagens de Satélites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fenologia/index.html">8. Fenologia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../padroes-series-temporais/index.html">9. Padrões em Séries Temporais de Imagens de Satélites</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Referências Bibliográficas</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../referencias.html">Referências Bibliográficas</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Informações Gerais:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../licenca.html">Licença</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../agradecimentos.html">Agradecimentos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Índice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossário</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../search.html">Página de Busca</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Menu de navegação móvel"  style="background: #F0F8FF" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeoCreditoRural</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Navegação da página">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><span class="section-number">3. </span>Dados do Sicor</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">3.1. </span>Sicor - Tabelas e Microdados do Crédito Rural e do Proagro</a></li>
      <li class="breadcrumb-item active"><span class="section-number">3.1.13. </span>Pedidos de cobertura do Proagro (COP)</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Navegação sequencial da página">
        <a href="glebas-forma.html" class="btn btn-neutral float-left" title="3.1.12. Avaliação da Forma das Glebas" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="mutuarios.html" class="btn btn-neutral float-right" title="3.1.14. Mutuários" accesskey="n">Próximo <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pedidos-de-cobertura-do-proagro-cop">
<span id="sec-sicor-microdados-pedidos-cobertura-proagro"></span><h1><span class="section-number">3.1.13. </span>Pedidos de cobertura do Proagro (COP)<a class="headerlink" href="#pedidos-de-cobertura-do-proagro-cop" title="Link permanente para este cabeçalho"></a></h1>
<p>O <a class="reference internal" href="../../glossary.html#term-Proagro"><span class="xref std std-term">Proagro</span></a> é um programa do Governo Federal que garante o pagamento de financiamentos rurais de custeio agrícola quando a lavoura amparada tiver sua receita reduzida por causa de eventos climáticos ou pragas e doenças sem controle <span id="id1">[<a class="reference internal" href="../../referencias.html#id13" title="Banco Central do Brasil. Proagro – programa de garantia da atividade agropecuária. Technical Report 8, Banco Central do Brasil, Outubro 2023. URL: https://www.bcb.gov.br/content/estabilidadefinanceira/proagro_docs/resumo_instrucoes_Proagro.pdf.">27</a>]</span>. Ele é uma das formas de garantia do financiamento e quando da ocorrência de um evento adverso o produtor rural que optou por essa garantia pode solicitar seu pagamento.</p>
<p>No Sicor, os microdados sobre os pedidos de cobertura do Proagro (<a class="reference internal" href="../../glossary.html#term-COP"><span class="xref std std-term">COP</span></a>) estão disponíveis no formato CSV no arquivo <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_COP_BASICO.gz">SICOR_COP_BASICO.gz</a>. Esses pedidos registram:</p>
<ul class="open">
<li><p>O evento adverso originador da solicitação, como geada, granizo, seca e enchentes, entre outros. A lista completa dos tipos de eventos adversos geradores de pedidos de cobertura encontra-se disponível no arquivo <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/EventoProagro.csv">EventoProagro.csv</a>, cuja estrutura é apresentada na <a class="reference internal" href="#tbl-sicor-microdados-eventoproagro"><span class="std std-numref">Tabela 3.14</span></a>.</p>
<blockquote>
<div><table class="styled-table docutils align-center" id="tbl-sicor-microdados-eventoproagro">
<caption><span class="caption-number">Tabela 3.14 - </span><span class="caption-text">Estrutura do arquivo com os possíveis eventos geradores de pedidos do Proagro.</span><a class="headerlink" href="#tbl-sicor-microdados-eventoproagro" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head center-align"></th>
<th class="head center-align"><p>nome</p></th>
<th class="head center-align"><p>tipo</p></th>
<th class="head center-align"><p>descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong></p></td>
<td class="left-align"><p>cd_evento</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Código do evento do proagro</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>nome_evento</p></td>
<td class="center-align"><p>text</p></td>
<td class="left-align"><p>Descrição do evento do proagro</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
<li><p>O tipo de solo relacionado ao ZARC (<a class="reference internal" href="../zarc.html#sec-sicor-zarc"><span class="std std-numref">Seção 3.2 - Zoneamento Agrícola de Risco Climático</span></a>), que possibilita verificar se o empreendimento foi realizado em uma época propícia. A lista completa dos tipos de solos encontra-se disponível no arquivo <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/TipoSoloProagro.csv">TipoSoloProagro.csv</a>, cuja estrutura é apresentada na <a class="reference internal" href="#tbl-sicor-microdados-tiposoloproagro"><span class="std std-numref">Tabela 3.15</span></a>.</p>
<blockquote>
<div><table class="styled-table docutils align-center" id="tbl-sicor-microdados-tiposoloproagro">
<caption><span class="caption-number">Tabela 3.15 - </span><span class="caption-text">Estrutura do arquivo com os tipos de solo.</span><a class="headerlink" href="#tbl-sicor-microdados-tiposoloproagro" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head center-align"></th>
<th class="head center-align"><p>nome</p></th>
<th class="head center-align"><p>tipo</p></th>
<th class="head center-align"><p>descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong></p></td>
<td class="left-align"><p>cd_tipo_solo</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Código do tipo de solo</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>descricao_tipo_solo</p></td>
<td class="center-align"><p>text</p></td>
<td class="left-align"><p>Descrição do tipo de solo</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
<li><p>O ciclo do cultivar relacionado ao ZARC (<a class="reference internal" href="../zarc.html#sec-sicor-zarc"><span class="std std-numref">Seção 3.2 - Zoneamento Agrícola de Risco Climático</span></a>), que também é usado para verificar se o empreendimento foi realizado em uma época propícia, de acordo com o recomendado. A lista completa dos tipos de solos encontra-se disponível no arquivo <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/CicloCultivarProagro.csv">CicloCultivarProagro.csv</a>, cuja estrutura é apresentada na <a class="reference internal" href="#tbl-sicor-microdados-ciclocultivarproagro"><span class="std std-numref">Tabela 3.16</span></a>.</p>
<blockquote>
<div><table class="styled-table docutils align-center" id="tbl-sicor-microdados-ciclocultivarproagro">
<caption><span class="caption-number">Tabela 3.16 - </span><span class="caption-text">Estrutura do arquivo com o ciclo do cultivar relacionado ao ZARC.</span><a class="headerlink" href="#tbl-sicor-microdados-ciclocultivarproagro" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head center-align"></th>
<th class="head center-align"><p>nome</p></th>
<th class="head center-align"><p>tipo</p></th>
<th class="head center-align"><p>descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong></p></td>
<td class="left-align"><p>cd_ciclo_cultivar</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Código do ciclo do cultivar</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>descricao_ciclo</p></td>
<td class="center-align"><p>text</p></td>
<td class="left-align"><p>Descrição do ciclo do cultivar</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
<li><p>Situação do pedido de cobertura: <code class="docutils literal notranslate"><span class="pre">em</span> <span class="pre">análise</span></code>, <code class="docutils literal notranslate"><span class="pre">deferida</span></code>, <code class="docutils literal notranslate"><span class="pre">indeferida</span></code>, <code class="docutils literal notranslate"><span class="pre">desistida</span></code>, <code class="docutils literal notranslate"><span class="pre">cancelada</span></code> e <code class="docutils literal notranslate"><span class="pre">inválida</span></code>. A lista completa dos possíveis estados de um pedido de cobertura encontra-se disponível no arquivo <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/StatusCOPProagro.csv">StatusCOPProagro.csv</a>, cuja estrutura é apresentada na <a class="reference internal" href="#tbl-sicor-microdados-statuscopproagro"><span class="std std-numref">Tabela 3.17</span></a>.</p>
<blockquote>
<div><table class="styled-table docutils align-center" id="tbl-sicor-microdados-statuscopproagro">
<caption><span class="caption-number">Tabela 3.17 - </span><span class="caption-text">Estrutura do arquivo com os possíveis estados dos pedidos de cobertura do Proagro.</span><a class="headerlink" href="#tbl-sicor-microdados-statuscopproagro" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head center-align"></th>
<th class="head center-align"><p>nome</p></th>
<th class="head center-align"><p>tipo</p></th>
<th class="head center-align"><p>descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong></p></td>
<td class="left-align"><p>cd_status</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Código do status da COP</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>descricao</p></td>
<td class="center-align"><p>text</p></td>
<td class="left-align"><p>Descrição do status da COP</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
</ul>
<p>A <a class="reference internal" href="#tbl-sicor-microdados-sicor-cop-basico"><span class="std std-numref">Tabela 3.18</span></a> apresenta a estrutura do arquivo contendo os registros de pedido de Proagro (<a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_COP_BASICO.gz">SICOR_COP_BASICO.gz</a>).</p>
<table class="styled-table docutils align-center" id="tbl-sicor-microdados-sicor-cop-basico">
<caption><span class="caption-number">Tabela 3.18 - </span><span class="caption-text">Estrutura do arquivo contendo os registros de pedidos de cobertura do Proagro (COP).</span><a class="headerlink" href="#tbl-sicor-microdados-sicor-cop-basico" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head center-align"></th>
<th class="head center-align"><p>nome</p></th>
<th class="head center-align"><p>tipo</p></th>
<th class="head center-align"><p>descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong>, FK<sub>1</sub></p></td>
<td class="left-align"><p>ref_bacen</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número mascarado de referência do contrato</p></td>
</tr>
<tr class="row-odd"><td class="center-align"><p><strong>PK</strong>, FK<sub>1</sub></p></td>
<td class="left-align"><p>nu_ordem</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número da destinação/finalidade dentro do contrato</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>dt_comunicacao</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Data de comunicação da COP</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>dt_fim_colheita</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Fim de colheita</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>dt_fim_plantio</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Fim de plantio</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>dt_inicio_colheita</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Início de colheita</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>dt_inicio_plantio</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Início de plantio</p></td>
</tr>
<tr class="row-odd"><td class="center-align"><p>FK<sub>2</sub></p></td>
<td class="left-align"><p>cd_status</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Código do status da COP</p></td>
</tr>
<tr class="row-even"><td class="center-align"><p>FK<sub>3</sub></p></td>
<td class="left-align"><p>cd_ciclo_cultivar</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Código do ciclo do cultivar</p></td>
</tr>
<tr class="row-odd"><td class="center-align"><p>FK<sub>4</sub></p></td>
<td class="left-align"><p>cd_tipo_solo</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Código do tipo de solo</p></td>
</tr>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong>, FK<sub>5</sub></p></td>
<td class="left-align"><p>cd_evento</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Código do evento da COP</p></td>
</tr>
</tbody>
</table>
<p>Outro microdado complementar ao dos pedidos de Proagro é o registro das periciadoras e peritos, disponíveis no arquivo <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_COMPLEMENTO_COP.gz">SICOR_COMPLEMENTO_COP.gz</a>, cuja estrutura é apresentada na <a class="reference internal" href="#tbl-sicor-microdados-sicor-complemento-cop"><span class="std std-numref">Tabela 3.19</span></a>.</p>
<table class="styled-table docutils align-center" id="tbl-sicor-microdados-sicor-complemento-cop">
<caption><span class="caption-number">Tabela 3.19 - </span><span class="caption-text">Estrutura dos dados complementares dos pedidos de cobertura do Proagro.</span><a class="headerlink" href="#tbl-sicor-microdados-sicor-complemento-cop" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head center-align"></th>
<th class="head center-align"><p>nome</p></th>
<th class="head center-align"><p>tipo</p></th>
<th class="head center-align"><p>descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong>, FK</p></td>
<td class="left-align"><p>ref_bacen</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número mascarado de referência do contrato</p></td>
</tr>
<tr class="row-odd"><td class="center-align"><p><strong>PK</strong>, FK</p></td>
<td class="left-align"><p>nu_ordem</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número da destinação/finalidade dentro do contrato</p></td>
</tr>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong>, FK</p></td>
<td class="left-align"><p>cd_evento</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Código do evento da COP</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>cd_cpf_cnpj_periciadora</p></td>
<td class="center-align"><p>text</p></td>
<td class="left-align"><p>CPF do perito da empresa periciadora</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>cd_cpf_perito</p></td>
<td class="center-align"><p>text</p></td>
<td class="left-align"><p>CPF/CNPJ do perito</p></td>
</tr>
</tbody>
</table>
<p>Os arquivos listados acima foram carregados nas tabelas <code class="docutils literal notranslate"><span class="pre">sicor_cop_basico</span></code>, <code class="docutils literal notranslate"><span class="pre">eventoproagro</span></code>, <code class="docutils literal notranslate"><span class="pre">statuscopproagro</span></code>, <code class="docutils literal notranslate"><span class="pre">ciclocultivarproagro</span></code>, <code class="docutils literal notranslate"><span class="pre">tiposoloproagro</span></code> e <code class="docutils literal notranslate"><span class="pre">sicor_complemento_cop</span></code> do banco de dados PostgreSQL. A <a class="reference internal" href="#fig-sicor-microdados-er-cop"><span class="std std-numref">Figura 3.17</span></a> apresenta os relacionamentos dessas tabelas.</p>
<figure class="align-center align-default" id="fig-sicor-microdados-er-cop">
<a class="reference internal image-reference" href="../../_images/er-cop.png"><img alt="Diagrama Entidade-Relacionamento dos pedidos de cobertura do Proagro (simplificado)" src="../../_images/er-cop.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Figura 3.17 - </span><span class="caption-text">Diagrama Entidade-Relacionamento dos pedidos de cobertura do Proagro (simplificado).</span><a class="headerlink" href="#fig-sicor-microdados-er-cop" title="Link Permanente para essa imagem"></a></p>
</figcaption>
</figure>
<p>Os microdados do relatório de comprovação de perdas do Proagro estão disponíveis no arquivo <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_RCP_BASICO.gz">SICOR_RCP_BASICO.gz</a>, que possui a estrutura mostrada na <a class="reference internal" href="#tbl-sicor-microdados-sicor-rcp-basico"><span class="std std-numref">Tabela 3.20</span></a>.</p>
<table class="styled-table docutils align-center" id="tbl-sicor-microdados-sicor-rcp-basico">
<caption><span class="caption-number">Tabela 3.20 - </span><span class="caption-text">Estrutura dos dados dos relatórios de comprovação de perdas do Proagro.</span><a class="headerlink" href="#tbl-sicor-microdados-sicor-rcp-basico" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head center-align"></th>
<th class="head center-align"><p>nome</p></th>
<th class="head center-align"><p>tipo</p></th>
<th class="head center-align"><p>descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong>, FK<sub>1</sub></p></td>
<td class="left-align"><p>ref_bacen</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número mascarado de referência do contrato</p></td>
</tr>
<tr class="row-odd"><td class="center-align"><p><strong>PK</strong>, FK<sub>1</sub></p></td>
<td class="left-align"><p>nu_ordem</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número da destinação/finalidade dentro do contrato</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>dt_entrega</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Data de entrega do RCP</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>dt_fim_colheita</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Fim de colheita</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>dt_fim_evento</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Fim de evento</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>dt_fim_plantio</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Fim de plantio</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>dt_inicio_colheita</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Início de colheita</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>dt_inicio_evento</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Início de evento</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>dt_inicio_plantio</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Início de plantio</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_area</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Área</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>vl_prev_prod</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Previsão de produção</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_rec_prev</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Valor da receita prevista correspondente</p></td>
</tr>
<tr class="row-even"><td class="center-align"><p>FK<sub>2</sub></p></td>
<td class="left-align"><p>cd_status</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Código do status do RCP</p></td>
</tr>
<tr class="row-odd"><td class="center-align"><p>FK<sub>3</sub></p></td>
<td class="left-align"><p>cd_tipo</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Código do tipo de solo</p></td>
</tr>
<tr class="row-even"><td class="center-align"><p>FK<sub>4</sub></p></td>
<td class="left-align"><p>cd_evento</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Código do evento do RCP</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>dt_visita</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Data de visita do perito</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>nu_dias_ciclo_cultivar</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número de ciclos do cultivar</p></td>
</tr>
</tbody>
</table>
<p>Assim como os pedidos de cobertura, os relatórios de comprovação de perdas possuem um microdado complementar, com registro das periciadoras e peritos. Esta infromação encontra-se disponível no arquivo <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_COMPLEMENTO_RCP.gz">SICOR_COMPLEMENTO_RCP.gz</a>, cuja estrutura é apresentada na <a class="reference internal" href="#tbl-sicor-microdados-sicor-complemento-rcp"><span class="std std-numref">Tabela 3.21</span></a>.</p>
<table class="styled-table docutils align-center" id="tbl-sicor-microdados-sicor-complemento-rcp">
<caption><span class="caption-number">Tabela 3.21 - </span><span class="caption-text">Estrutura dos dados complementares dos relatórios de comprovação de perdas.</span><a class="headerlink" href="#tbl-sicor-microdados-sicor-complemento-rcp" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head center-align"></th>
<th class="head center-align"><p>nome</p></th>
<th class="head center-align"><p>tipo</p></th>
<th class="head center-align"><p>descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong>, FK</p></td>
<td class="left-align"><p>ref_bacen</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número mascarado de referência do contrato</p></td>
</tr>
<tr class="row-odd"><td class="center-align"><p><strong>PK</strong>, FK</p></td>
<td class="left-align"><p>nu_ordem</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número da destinação/finalidade dentro do contrato</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>cd_cpf_cnpj_periciadora</p></td>
<td class="center-align"><p>text</p></td>
<td class="left-align"><p>CPF do perito da empresa periciadora</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>cd_cpf_perito</p></td>
<td class="center-align"><p>text</p></td>
<td class="left-align"><p>CPF/CNPJ do perito</p></td>
</tr>
</tbody>
</table>
<p>Os relatórios de comprovação de perdas em operações contratadas podem apresentar glebas da comprovação. Esses microdados são disponibilizados em dois arquivos:</p>
<ul class="open">
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_RCP_GLEBAS_2015_2020.gz">SICOR_RCP_GLEBAS_2015_2020.gz</a>: Glebas da comprovação de perdas de operações contratadas entre os anos de 2015 e 2020.</p></li>
<li><p><a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_RCP_GLEBAS_2021.gz">SICOR_RCP_GLEBAS_2021.gz</a>: Glebas da comprovação de perdas de operações contratadas a partir de 2021.</p></li>
</ul>
<p>A <a class="reference internal" href="#tbl-sicor-microdados-sicor-rcp-glebas-wkt"><span class="std std-numref">Tabela 3.22</span></a> apresenta a estrutura desses arquivos. Conforme pode ser observado, é utilizada uma estrutura semelhante à apresentada na <a class="reference internal" href="glebas.html#sec-sicor-microdados-glebas"><span class="std std-numref">Seção 3.1.10 - Glebas de Operações Contratadas com Recursos Públicos</span></a>, com as geometrias das glebas representadas textualmente no formato <a class="reference internal" href="../../glossary.html#term-WKT"><span class="xref std std-term">WKT</span></a>.</p>
<table class="styled-table docutils align-center" id="tbl-sicor-microdados-sicor-rcp-glebas-wkt">
<caption><span class="caption-number">Tabela 3.22 - </span><span class="caption-text">Estrutura do arquivo contendo glebas da comprovação de perdas de operações contratadas.</span><a class="headerlink" href="#tbl-sicor-microdados-sicor-rcp-glebas-wkt" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head center-align"></th>
<th class="head center-align"><p>nome</p></th>
<th class="head center-align"><p>tipo</p></th>
<th class="head center-align"><p>descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong>, FK</p></td>
<td class="left-align"><p>ref_bacen</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número mascarado de referência do contrato</p></td>
</tr>
<tr class="row-odd"><td class="center-align"><p><strong>PK</strong>, FK</p></td>
<td class="left-align"><p>nu_ordem</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número da destinação/finalidade dentro do contrato</p></td>
</tr>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong></p></td>
<td class="left-align"><p>nu_indice</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Identificador da gleba dentro da operação</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>gt_geometria</p></td>
<td class="center-align"><p>text</p></td>
<td class="left-align"><p>Geometria da gleba no formato Well-Know Text (WKT)</p></td>
</tr>
</tbody>
</table>
<p>Os arquivos <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_RCP_BASICO.gz">SICOR_RCP_BASICO.gz</a>, <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_COMPLEMENTO_RCP.gz">SICOR_COMPLEMENTO_RCP.gz</a> e <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_RCP_GLEBAS_2021.gz">SICOR_RCP_GLEBAS_2021.gz</a> foram carregados, respectivamente, para as tabelas <code class="docutils literal notranslate"><span class="pre">sicor_rcp_basico</span></code>, <code class="docutils literal notranslate"><span class="pre">sicor_complemento_rcp</span></code> e <code class="docutils literal notranslate"><span class="pre">sicor_rcp_glebas_wkt</span></code> do banco de dados PostgreSQL. A <a class="reference internal" href="#fig-sicor-microdados-er-rcp"><span class="std std-numref">Figura 3.18</span></a> apresenta os relacionamentos dessas tabelas.</p>
<figure class="align-center align-default" id="fig-sicor-microdados-er-rcp">
<a class="reference internal image-reference" href="../../_images/er-rcp.png"><img alt="Diagrama Entidade-Relacionamento dos relatórios de comprovação de perdas em operações contratadas (simplificado)" src="../../_images/er-rcp.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Figura 3.18 - </span><span class="caption-text">Diagrama Entidade-Relacionamento dos relatórios de comprovação de perdas em operações contratadas (simplificado).</span><a class="headerlink" href="#fig-sicor-microdados-er-rcp" title="Link Permanente para essa imagem"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>O diagrama mostrado na <a class="reference internal" href="#fig-sicor-microdados-er-rcp"><span class="std std-numref">Figura 3.18</span></a> também inclui uma tabela denominada <code class="docutils literal notranslate"><span class="pre">sicor_rcp_glebas</span></code> com estrutura similiar à tabela <code class="docutils literal notranslate"><span class="pre">sicor_rcp_glebas_wkt</span></code> mas já com uma coluna geométrica para representação das glebas dos relatórios.</p>
</div>
<p>As informações das súmulas do julgamento são disponibilizadas no arquivo <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_SUMULA_JULGAMENTO.gz">SICOR_SUMULA_JULGAMENTO.gz</a>, cuja estrutura é mostrada na <a class="reference internal" href="#tbl-sicor-microdados-sicor-sumula-julgamento-basico"><span class="std std-numref">Tabela 3.23</span></a>.</p>
<table class="styled-table docutils align-center" id="tbl-sicor-microdados-sicor-sumula-julgamento-basico">
<caption><span class="caption-number">Tabela 3.23 - </span><span class="caption-text">Estrutura do arquivo <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_SUMULA_JULGAMENTO.gz">SICOR_SUMULA_JULGAMENTO.gz</a>.</span><a class="headerlink" href="#tbl-sicor-microdados-sicor-sumula-julgamento-basico" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head center-align"></th>
<th class="head center-align"><p>nome</p></th>
<th class="head center-align"><p>tipo</p></th>
<th class="head center-align"><p>descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong>, FK<sub>1</sub></p></td>
<td class="left-align"><p>ref_bacen</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número mascarado de referência do contrato</p></td>
</tr>
<tr class="row-odd"><td class="center-align"><p><strong>PK</strong>, FK<sub>1</sub></p></td>
<td class="left-align"><p>nu_ordem</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número da destinação/finalidade dentro do contrato</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>vl_cob_ant_parcela_invest_proagro_mais</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Cobertura da parcela de investimento do Proagro Mais</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_remu_encarr_comprov_perdas</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Remuneração do encarregado da comprovação de perdas</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>cd_status</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Status da súmula de julgamento</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_receitas_consideradas</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Receitas consideradas</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>vl_cobertura_ant_rec_proprios</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Cobertura anterior dos recursos próprios</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_demais_despesas_comprov_perd</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Demais despesas da comprovação de perdas</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>vl_cred_custeio_usado</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Crédito de custeio utilizado</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_demais_desp_ant_comp_per</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Demais despesas anteriores da comprovação de perdas</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>vl_rec_prop_usado</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Recursos próprios utilizados</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_cob_ant_garantia_renda_min</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Cobertura da garantia de renda mínima do Proagro Mais</p></td>
</tr>
<tr class="row-even"><td class="center-align"><p>FK<sub>2</sub></p></td>
<td class="left-align"><p>cd_instancia</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Instância da súmula de julgamento</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_perdas_nao_amparadas</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Perdas não amparadas</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>vl_encargos_sob_credito</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Encargos financeiros sobre o crédito utilizado</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>dt_inclusao</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Data de inclusão da súmula de julgamento</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>vl_perc_redutor_cobertura</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Percentual do redutor de cobertura</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_remu_ant_encarg_comp_perdas</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Remuneração anterior do encarregado da comprovação de perdas</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>cd_decisao</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Início de plantio</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>dt_decisao</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Data da decisão na súmula de julgamento</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>dt_base</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Data base da súmula de julgamento</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_cobertura_ant_credito_custeio</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Cobertura anterior do crédito de custeio</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>vl_bonus_pgaf</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_deducoes_legais</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>vl_orcamento_enquadrado</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>nu_dias_uteis_atraso_perito</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>ib_segunda_vistoria</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"></td>
</tr>
</tbody>
</table>
<p>Os valores pagos pelo Proagro são disponibilizados no arquivo <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_PARCELAS_PROAGRO.gz">SICOR_PARCELAS_PROAGRO.gz</a>, que possui a estrutura apresentada na <a class="reference internal" href="#tbl-sicor-microdados-sicor-parcelas-proagro"><span class="std std-numref">Tabela 3.24</span></a>.</p>
<table class="styled-table docutils align-center" id="tbl-sicor-microdados-sicor-parcelas-proagro">
<caption><span class="caption-number">Tabela 3.24 - </span><span class="caption-text">Estrutura dos dados de valores pagos pelo Proagro.</span><a class="headerlink" href="#tbl-sicor-microdados-sicor-parcelas-proagro" title="Link Permanente para essa tabela"></a></caption>
<thead>
<tr class="row-odd"><th class="head center-align"></th>
<th class="head center-align"><p>nome</p></th>
<th class="head center-align"><p>tipo</p></th>
<th class="head center-align"><p>descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="center-align"><p><strong>PK</strong>, FK<sub>1</sub></p></td>
<td class="left-align"><p>ref_bacen</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número mascarado de referência do contrato</p></td>
</tr>
<tr class="row-odd"><td class="center-align"><p><strong>PK</strong>, FK<sub>1</sub></p></td>
<td class="left-align"><p>nu_ordem</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Número da destinação/finalidade dentro do contrato</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>dt_base</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Data base de parcela do Proagro</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>dt_pagamento</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Data de pagamento de parcela do Proagro</p></td>
</tr>
<tr class="row-even"><td class="center-align"><p>FK<sub>2</sub></p></td>
<td class="left-align"><p>cd_instancia</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Instância de parcela do Proagro</p></td>
</tr>
<tr class="row-odd"><td class="center-align"><p>FK<sub>3</sub></p></td>
<td class="left-align"><p>cd_status</p></td>
<td class="center-align"><p>integer</p></td>
<td class="left-align"><p>Status de parcela do Proagro</p></td>
</tr>
<tr class="row-even"><td class="center-align"><p>FK<sub>4</sub></p></td>
<td class="left-align"><p>cd_natureza_parcela</p></td>
<td class="center-align"><p>char(3)</p></td>
<td class="left-align"><p>Natureza de parcela do Proagro</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>dt_atualizacao</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Data de atualização de parcela do Proagro</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>vl_atual</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Valor atual de parcela do Proagro</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_base</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Valor base de parcela do Proagro</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>vl_pago</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Valor pago de parcela do Proagro</p></td>
</tr>
<tr class="row-odd"><td class="center-align"></td>
<td class="left-align"><p>vl_imposto</p></td>
<td class="center-align"><p>numeric</p></td>
<td class="left-align"><p>Valor do imposto de parcela do Proagro</p></td>
</tr>
<tr class="row-even"><td class="center-align"></td>
<td class="left-align"><p>dt_remessa</p></td>
<td class="center-align"><p>date</p></td>
<td class="left-align"><p>Data de remessa de parcela do Proagro</p></td>
</tr>
</tbody>
</table>
<p>O arquivo <a class="reference external" href="https://www.bcb.gov.br/htms/sicor/DadosBrutos/SICOR_PARCELAS_PROAGRO.gz">SICOR_PARCELAS_PROAGRO.gz</a> foi carregado para a tabela <code class="docutils literal notranslate"><span class="pre">sicor_parcelas_proagro</span></code> do banco de dados PostgreSQL. A <a class="reference internal" href="#fig-sicor-microdados-parcelas-proagro"><span class="std std-numref">Figura 3.19</span></a> apresenta os relacionamentos dessa tabela.</p>
<figure class="align-center align-default" id="fig-sicor-microdados-parcelas-proagro">
<a class="reference internal image-reference" href="../../_images/parcelas-proagro.png"><img alt="Diagrama Entidade-Relacionamento dos valores pagos pelo Proagro nos contratos de financiamento (simplificado)" src="../../_images/parcelas-proagro.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Figura 3.19 - </span><span class="caption-text">Diagrama Entidade-Relacionamento dos valores pagos pelo Proagro nos contratos de financiamento (simplificado).</span><a class="headerlink" href="#fig-sicor-microdados-parcelas-proagro" title="Link Permanente para essa imagem"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>A tabela <code class="docutils literal notranslate"><span class="pre">naturezaproagro</span></code> foi estendida com a coluna denominada <code class="docutils literal notranslate"><span class="pre">sinal</span></code>. O comando SQL abaixo pode ser usado para criar essa coluna:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">naturezaproagro</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">sinal</span><span class="w"> </span><span class="nb">NUMERIC</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>A idéia básica dessa coluna é auxiliar na definição de valores positivos ou negativos da coluna <code class="docutils literal notranslate"><span class="pre">vl_pago</span></code> nos dados da tabela <code class="docutils literal notranslate"><span class="pre">sicor_parcelas_proagro</span></code>. As naturezas de parcela cuja descrição contenha a cadeia de caracteres <code class="docutils literal notranslate"><span class="pre">devolução</span></code> (ou similar) deve ter o valor da coluna <code class="docutils literal notranslate"><span class="pre">sinal</span></code> com valor <code class="docutils literal notranslate"><span class="pre">-1</span></code>. Podemos usar o comando SQL abaixo para definir esses valores:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">naturezaproagro</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">sinal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">descricao</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%devolu%&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<section id="consultas">
<h2><span class="section-number">3.1.13.1. </span>Consultas<a class="headerlink" href="#consultas" title="Link permanente para este cabeçalho"></a></h2>
<p><strong>Consulta 1.</strong> Existem contratos/destinaçõs com mais de um evento reportado no pedido de Proagro?</p>
<details class="summary-solucao">
<summary>Solução:</summary><p>A lista dos tipos de eventos que aparecem nos registros de pedidos de cobertura podem ser encontrados na tabela <code class="docutils literal notranslate"><span class="pre">eventoproagro</span></code>.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">ref_bacen</span><span class="p">,</span><span class="w"> </span><span class="n">nu_ordem</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_eventos</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_cop_basico</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ref_bacen</span><span class="p">,</span><span class="w"> </span><span class="n">nu_ordem</span>
<span class="w">  </span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">num_eventos</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</pre></div>
</div>
</div></div>
</details><details class="summary-resultado">
<summary>Resultado:</summary><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><div class="highlight-text notranslate"><div class="highlight"><pre><span></span> ref_bacen | nu_ordem | num_eventos
-----------+----------+-------------
 515729598 |        1 |           4
 516068998 |        1 |           4
 516533502 |        2 |           4
       ... |      ... |         ...
 513259304 |        1 |           2
 513511692 |        1 |           2
 515290913 |        1 |           2
(5398 rows)
</pre></div>
</div>
</div></div>
</details><hr class="docutils" />
<p><strong>Consulta 2.</strong> Quais são os eventos geradores de pedido de Proagro?</p>
<details class="summary-solucao">
<summary>Solução:</summary><p>A lista dos tipos de eventos, que aparecem nos registros de pedidos de cobertura, pode ser encontrada na tabela <code class="docutils literal notranslate"><span class="pre">eventoproagro</span></code>.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">eventoproagro</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">nome_evento</span><span class="p">;</span>
</pre></div>
</div>
</div></div>
</details><details class="summary-resultado">
<summary>Resultado:</summary><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><div class="highlight-text notranslate"><div class="highlight"><pre><span></span> cd_evento |             nome_evento
-----------+-------------------------------------
        17 | Chuva excessiva
       135 | Chuva na colheita
       110 | Doença ou praga
       127 | Enchentes
        24 | Geada
        31 | Granizo
       103 | Outros fenômenos naturais fortuitos
        93 | Raio
        48 | Seca
        55 | Tromba de água
        86 | Variação excessiva de temperatura
        61 | Vendaval
        79 | Vento forte
        62 | Vento frio
(14 rows)
</pre></div>
</div>
</div></div>
</details><hr class="docutils" />
<p><strong>Consulta 3.</strong> Quais são os eventos que geram o maior número de pedidos de Proagro?</p>
<details class="summary-solucao">
<summary>Solução:</summary><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-4-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-4-4-0" name="4-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-4-4-0" class="sphinx-tabs-panel" id="panel-4-4-0" name="4-0" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="w">   </span><span class="k">SELECT</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dt_comunicacao</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span>
<span class="w">          </span><span class="n">eventoproagro</span><span class="p">.</span><span class="n">nome_evento</span><span class="p">,</span>
<span class="w">          </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_pedidos</span>

<span class="w">     </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_cop_basico</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">cop</span>

<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">eventoproagro</span>
<span class="w">       </span><span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">cop</span><span class="p">.</span><span class="n">cd_evento</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eventoproagro</span><span class="p">.</span><span class="n">cd_evento</span><span class="p">)</span>

<span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dt_comunicacao</span><span class="p">),</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">cd_evento</span><span class="p">,</span><span class="w"> </span><span class="n">eventoproagro</span><span class="p">.</span><span class="n">nome_evento</span>

<span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w"> </span><span class="n">total_pedidos</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</pre></div>
</div>
</div></div>
</details><details class="summary-resultado">
<summary>Resultado:</summary><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-5-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-5-5-0" name="5-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-5-5-0" class="sphinx-tabs-panel" id="panel-5-5-0" name="5-0" role="tabpanel" tabindex="0"><div class="highlight-text notranslate"><div class="highlight"><pre><span></span> ano  |             nome_evento             | total_pedidos
------+-------------------------------------+---------------
 2013 | Geada                               |          8211
 2013 | Chuva excessiva                     |          3497
 2013 | Seca                                |          2776
 2013 | Granizo                             |          1405
 2013 | Vento forte                         |           647
 2013 | Doença ou praga                     |           245
 2013 | Variação excessiva de temperatura   |           179
 2013 | Vento frio                          |            25
 2014 | Chuva excessiva                     |         33198
 2014 | Seca                                |         23049
 2014 | Vento forte                         |          2269
 2014 | Granizo                             |          2242
 2014 | Geada                               |          1161
 2014 | Doença ou praga                     |           952
 2014 | Variação excessiva de temperatura   |           308
 2014 | Vento frio                          |            29
  ... | ...                                 |           ...
 2024 | Seca                                |         38799
 2024 | Chuva excessiva                     |         23723
 2024 | Geada                               |          7430
 2024 | Doença ou praga                     |          3627
 2024 | Variação excessiva de temperatura   |          3266
 2024 | Vento forte                         |          1974
 2024 | Granizo                             |           940
 2024 | Chuva na colheita                   |           190
 2024 | Vendaval                            |           125
 2024 | Enchentes                           |            32
 2024 | Tromba de água                      |            29
 2024 | Vento frio                          |            22
 2024 | Outros fenômenos naturais fortuitos |            11
(137 rows)
</pre></div>
</div>
</div></div>
</details><hr class="docutils" />
<p><strong>Consulta 4.</strong> Qual a proporção no ano de cada evento gerador de pedido de Proagro?</p>
<details class="summary-solucao">
<summary>Solução:</summary><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-6-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-6-6-0" name="6-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-6-6-0" class="sphinx-tabs-panel" id="panel-6-6-0" name="6-0" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="w">     </span><span class="k">WITH</span><span class="w"> </span><span class="n">total_pedidos_ano</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">           </span><span class="k">SELECT</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dt_comunicacao</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span>
<span class="w">                  </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">pedidos</span>
<span class="w">             </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_cop_basico</span>
<span class="w">         </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dt_comunicacao</span><span class="p">)</span>
<span class="w">     </span><span class="p">)</span>


<span class="w">   </span><span class="k">SELECT</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dt_comunicacao</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span>
<span class="w">          </span><span class="n">eventoproagro</span><span class="p">.</span><span class="n">nome_evento</span><span class="p">,</span>
<span class="w">          </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_pedidos</span><span class="p">,</span>
<span class="w">          </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)::</span><span class="nb">numeric</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_pedidos_ano</span><span class="p">.</span><span class="n">pedidos</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">percentagem_ano</span>

<span class="w">     </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_cop_basico</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">cop</span>

<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">eventoproagro</span>
<span class="w">       </span><span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">cop</span><span class="p">.</span><span class="n">cd_evento</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eventoproagro</span><span class="p">.</span><span class="n">cd_evento</span><span class="p">)</span>

<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">total_pedidos_ano</span>
<span class="w">       </span><span class="k">ON</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dt_comunicacao</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_pedidos_ano</span><span class="p">.</span><span class="n">ano</span>

<span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dt_comunicacao</span><span class="p">),</span>
<span class="w">          </span><span class="n">cop</span><span class="p">.</span><span class="n">cd_evento</span><span class="p">,</span>
<span class="w">          </span><span class="n">eventoproagro</span><span class="p">.</span><span class="n">nome_evento</span><span class="p">,</span>
<span class="w">          </span><span class="n">total_pedidos_ano</span><span class="p">.</span><span class="n">pedidos</span>

<span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w"> </span><span class="n">percentagem_ano</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</pre></div>
</div>
</div></div>
</details><details class="summary-resultado">
<summary>Resultado:</summary><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-7-7-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-7-7-0" name="7-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-7-7-0" class="sphinx-tabs-panel" id="panel-7-7-0" name="7-0" role="tabpanel" tabindex="0"><div class="highlight-text notranslate"><div class="highlight"><pre><span></span> ano  |             nome_evento             | total_pedidos |       percentagem_ano
------+-------------------------------------+---------------+-----------------------------
 2013 | Geada                               |          8211 |    48.342655284074183103000
 2013 | Chuva excessiva                     |          3497 |    20.588754783632617015000
 2013 | Seca                                |          2776 |    16.343832793641448337000
 2013 | Granizo                             |          1405 |     8.272004710038269061000
 2013 | Vento forte                         |           647 |     3.809243450103032087000
 2013 | Doença ou praga                     |           245 |     1.442449219899911687000
 2013 | Variação excessiva de temperatura   |           179 |     1.053871062702384457000
 2013 | Vento frio                          |            25 |     0.147188695908154254000
 2014 | Chuva excessiva                     |         33198 |    52.521832679407669915000
 2014 | Seca                                |         23049 |    36.465320845462599671000
 2014 | Vento forte                         |          2269 |     3.589735476521959246000
 2014 | Granizo                             |          2242 |     3.547019364637387672000
 2014 | Geada                               |          1161 |     1.836792811036577648000
 2014 | Doença ou praga                     |           952 |     1.506138463485634730000
 2014 | Variação excessiva de temperatura   |           308 |     0.487280091127705354000
 2014 | Vento frio                          |            29 |     0.045880268320465764000
  ... | ...                                 |           ... |                         ...
 2024 | Seca                                |         38799 |    48.397116056281808203000
 2024 | Chuva excessiva                     |         23723 |    29.591607623989621794000
 2024 | Geada                               |          7430 |     9.268037122043708213000
 2024 | Doença ou praga                     |          3627 |     4.524249076938429298000
 2024 | Variação excessiva de temperatura   |          3266 |     4.073944716096197984000
 2024 | Vento forte                         |          1974 |     2.462329108871370123000
 2024 | Granizo                             |           940 |     1.172537670891128630000
 2024 | Chuva na colheita                   |           190 |     0.237002295180121744000
 2024 | Vendaval                            |           125 |     0.155922562618501148000
 2024 | Enchentes                           |            32 |     0.039916176030336294000
 2024 | Tromba de água                      |            29 |     0.036174034527492266000
 2024 | Vento frio                          |            22 |     0.027442371020856202000
 2024 | Outros fenômenos naturais fortuitos |            11 |     0.013721185510428101000
(137 rows)
</pre></div>
</div>
</div></div>
</details><hr class="docutils" />
<p><strong>Consulta 5.</strong> Quais as culturas que mais solicitam Proagro?</p>
<details class="summary-solucao">
<summary>Solução:</summary><p>Os empreendimentos que serão avaliados consistem de financiamentos de custeio agrícola para lavoura.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-8-8-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-8-8-0" name="8-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-8-8-0" class="sphinx-tabs-panel" id="panel-8-8-0" name="8-0" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span>
<span class="w">               </span><span class="n">dense_rank</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">valor_total</span><span class="w"> </span><span class="k">DESC</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">rank_valor</span><span class="p">,</span>
<span class="w">               </span><span class="n">dense_rank</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">num_pedidos_proagro</span><span class="w"> </span><span class="k">DESC</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">rank_pedidos</span><span class="p">,</span>
<span class="w">               </span><span class="n">dense_rank</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">valor_medio_proagro</span><span class="w"> </span><span class="k">DESC</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">rank_valor_medio</span>
<span class="w">          </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>


<span class="w">               </span><span class="k">SELECT</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">op</span><span class="p">.</span><span class="n">dt_emissao</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span>
<span class="w">                      </span><span class="n">produto</span><span class="p">,</span>
<span class="w">                      </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_pedidos_proagro</span><span class="p">,</span>
<span class="w">                      </span><span class="k">SUM</span><span class="p">(</span><span class="n">valor_pago_proagro</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">valor_total</span><span class="p">,</span>
<span class="w">                      </span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">valor_pago_proagro</span><span class="p">)</span><span class="o">/</span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">valor_medio_proagro</span>
<span class="w">                 </span><span class="k">FROM</span>
<span class="w">                     </span><span class="p">(</span>
<span class="w">                         </span><span class="k">SELECT</span><span class="w"> </span><span class="n">ref_bacen</span><span class="p">,</span>
<span class="w">                                </span><span class="n">nu_ordem</span><span class="p">,</span>
<span class="w">                                </span><span class="k">SUM</span><span class="p">(</span><span class="n">parcelas</span><span class="p">.</span><span class="n">vl_pago</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">natureza</span><span class="p">.</span><span class="n">sinal</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">valor_pago_proagro</span>
<span class="w">                           </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_parcelas_proagro</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">parcelas</span><span class="p">,</span>
<span class="w">                                </span><span class="n">naturezaproagro</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">natureza</span>
<span class="w">                          </span><span class="k">WHERE</span><span class="w"> </span><span class="n">parcelas</span><span class="p">.</span><span class="n">cd_natureza_parcela</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">natureza</span><span class="p">.</span><span class="n">cd_natureza_parcela</span>
<span class="w">                       </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ref_bacen</span><span class="p">,</span><span class="w"> </span><span class="n">nu_ordem</span>
<span class="w">                     </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">pedidos_proagro</span><span class="p">,</span>
<span class="w">                     </span><span class="n">sicor_operacao_basica_estado</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">op</span><span class="p">,</span>
<span class="w">                     </span><span class="n">empreendimento</span>
<span class="w">               </span><span class="k">WHERE</span><span class="w"> </span><span class="n">pedidos_proagro</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">pedidos_proagro</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">op</span><span class="p">.</span><span class="n">cd_empreendimento</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">empreendimento</span><span class="p">.</span><span class="n">cd_empreendimento</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">empreendimento</span><span class="p">.</span><span class="n">finalidade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;custeio&#39;</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">empreendimento</span><span class="p">.</span><span class="n">atividade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;agrícola&#39;</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">empreendimento</span><span class="p">.</span><span class="n">modalidade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;lavoura&#39;</span>
<span class="w">            </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span><span class="w"> </span><span class="n">produto</span>

<span class="w">          </span><span class="p">)</span>
<span class="w">      </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span><span class="w"> </span><span class="n">rank_valor</span>
<span class="w">  </span><span class="p">)</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">rank_valor</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">rank_pedidos</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">rank_valor_medio</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Dica</p>
<p>Para exportar o resultado da consulta acima para um arquivo CSV, utilize o comando <code class="docutils literal notranslate"><span class="pre">\copy</span></code>:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="kp">\copy</span><span class="w"> </span><span class="ss">(consulta)</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="s1">&#39;/tmp/culturas-proagro.csv&#39;</span><span class="w"> </span><span class="ss">WITH</span><span class="w"> </span><span class="ss">(FORMAT</span><span class="w"> </span><span class="ss">CSV,</span><span class="w"> </span><span class="ss">HEADER,</span><span class="w"> </span><span class="ss">DELIMITER</span><span class="w"> </span><span class="s1">&#39;;&#39;</span><span class="ss">,</span><span class="w"> </span><span class="ss">ENCODING</span><span class="w"> </span><span class="s1">&#39;UTF8&#39;</span><span class="ss">);</span>
</pre></div>
</div>
</div>
</div></div>
</details><details class="summary-resultado">
<summary>Resultado:</summary><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-9-9-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-9-9-0" name="9-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-9-9-0" class="sphinx-tabs-panel" id="panel-9-9-0" name="9-0" role="tabpanel" tabindex="0"><div class="highlight-text notranslate"><div class="highlight"><pre><span></span> ano  |             produto              | num_pedidos_proagro |  valor_total   |  valor_medio_proagro   | rank_valor | rank_pedidos | rank_valor_medio
------+----------------------------------+---------------------+----------------+------------------------+------------+--------------+------------------
 2013 | milho                            |              173309 |  269125887.990 |  1552.8673524744819946 |          1 |            1 |               16
 2013 | trigo                            |               33561 |  199561956.860 |  5946.2458466672625965 |          2 |            4 |                3
 2013 | soja                             |              117458 |  196530639.730 |  1673.1992689301707845 |          3 |            2 |               14
 2013 | café                             |               55310 |   25000912.950 |   452.0143364671849575 |          4 |            3 |               57
 2013 | feijão                           |               12127 |   20172009.850 |  1663.3965407767790880 |          5 |            6 |               15
 2013 | mandioca (aipim, macaxeira)      |               18008 |   17532771.480 |   973.6101443802754331 |          6 |            5 |               24
 2013 | cebola                           |                5090 |   10884551.030 |  2138.4186699410609037 |          7 |            8 |               13
  ... | ...                              |                 ... |            ... |                    ... |        ... |          ... |              ...
 2024 | abóbora-moranga                  |                 178 |    1639524.420 |  9210.8113483146067416 |         17 |           25 |                9
 2024 | pepino                           |                 116 |    1105571.120 |  9530.7855172413793103 |         21 |           33 |                7
 2024 | maçã                             |                  70 |     707403.920 | 10105.7702857142857143 |         26 |           41 |                6
 2024 | gergelim                         |                   4 |      57170.670 |     14292.667500000000 |         68 |           71 |                3
 2024 | oliva (azeitona)                 |                   1 |      18881.860 | 18881.8600000000000000 |         84 |           74 |                2
 2024 | girassol                         |                   1 |       9210.640 |  9210.6400000000000000 |         97 |           74 |               10
(217 rows)
</pre></div>
</div>
<p>O resultado acima encontra-se disponível no formato CSV no seguinte arquivo: <a class="reference download internal" download="" href="../../_downloads/26c2e1263f0e927f69024b4365ef9187/culturas-proagro.csv"><code class="xref download docutils literal notranslate"><span class="pre">culturas-proagro.csv</span></code></a>.</p>
</div></div>
</details><hr class="docutils" />
<p><strong>Consulta 6.</strong> Qual o tamanho médio das áreas associadas a pedidos de Proagro e os valores dos contratos?</p>
<details class="summary-solucao">
<summary>Solução:</summary><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-10-10-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-10-10-0" name="10-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-10-10-0" class="sphinx-tabs-panel" id="panel-10-10-0" name="10-0" role="tabpanel" tabindex="0"><p>Nessa consulta iremos utilizar a tabela <code class="docutils literal notranslate"><span class="pre">statuscopproagro</span></code>, que possui o seguinte conteúdo:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">statuscopproagro</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">descricao</span><span class="p">;</span>
</pre></div>
</div>
<p>Saída:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> cd_status | descricao
-----------+------------
         5 | cancelada
         2 | deferida
         4 | desistida
         1 | em análise
         3 | indeferida
         6 | inválida
(6 rows)
</pre></div>
</div>
<p>Além, da tabela acima, iremos utilizar as tabelas <code class="docutils literal notranslate"><span class="pre">sicor_cop_basico</span></code>, <code class="docutils literal notranslate"><span class="pre">sicor_operacao_basica_estado</span></code> e <code class="docutils literal notranslate"><span class="pre">empreendimento</span></code>, como mostrado na consulta abaixo:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span>
<span class="w">         </span><span class="n">produto</span><span class="p">,</span>
<span class="w">         </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_pedidos_proagro</span><span class="p">,</span>
<span class="w">         </span><span class="k">MIN</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">menor_valor_emprestado</span><span class="p">,</span>
<span class="w">         </span><span class="k">MAX</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">maior_valor_emprestado</span><span class="p">,</span>
<span class="w">         </span><span class="k">AVG</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">media_valor_emprestado</span><span class="p">,</span>
<span class="w">         </span><span class="k">MIN</span><span class="p">(</span><span class="n">area</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">menor_area</span><span class="p">,</span>
<span class="w">         </span><span class="k">MAX</span><span class="p">(</span><span class="n">area</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">maior_area</span><span class="p">,</span>
<span class="w">         </span><span class="k">AVG</span><span class="p">(</span><span class="n">area</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">media_area</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="k">ON</span><span class="p">(</span><span class="n">sicor_operacao_basica_estado</span><span class="p">.</span><span class="n">ref_bacen</span><span class="p">,</span><span class="w"> </span><span class="n">sicor_operacao_basica_estado</span><span class="p">.</span><span class="n">nu_ordem</span><span class="p">)</span>
<span class="w">               </span><span class="n">sicor_operacao_basica_estado</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ref_bacen</span><span class="p">,</span>
<span class="w">               </span><span class="n">sicor_operacao_basica_estado</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">nu_ordem</span><span class="p">,</span>
<span class="w">               </span><span class="n">sicor_operacao_basica_estado</span><span class="p">.</span><span class="n">vl_parc_credito</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">valor</span><span class="p">,</span>
<span class="w">               </span><span class="n">sicor_operacao_basica_estado</span><span class="p">.</span><span class="n">vl_area_informada</span><span class="w"> </span><span class="k">As</span><span class="w"> </span><span class="n">area</span><span class="p">,</span>
<span class="w">               </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_operacao_basica_estado</span><span class="p">.</span><span class="n">dt_emissao</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span>
<span class="w">               </span><span class="n">empreendimento</span><span class="p">.</span><span class="n">produto</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">produto</span><span class="p">,</span>
<span class="w">               </span><span class="n">empreendimento</span><span class="p">.</span><span class="n">variedade</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">variedade</span><span class="p">,</span>
<span class="w">               </span><span class="n">empreendimento</span><span class="p">.</span><span class="n">cesta</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">cesta</span>
<span class="w">          </span><span class="k">FROM</span><span class="w"> </span><span class="n">statuscopproagro</span><span class="p">,</span>
<span class="w">               </span><span class="n">sicor_cop_basico</span><span class="p">,</span>
<span class="w">               </span><span class="n">sicor_operacao_basica_estado</span><span class="p">,</span>
<span class="w">               </span><span class="n">empreendimento</span>
<span class="w">         </span><span class="k">WHERE</span><span class="w"> </span><span class="n">statuscopproagro</span><span class="p">.</span><span class="n">descricao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;deferida&#39;</span>
<span class="w">           </span><span class="k">AND</span><span class="w"> </span><span class="n">statuscopproagro</span><span class="p">.</span><span class="n">cd_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sicor_cop_basico</span><span class="p">.</span><span class="n">cd_status</span>
<span class="w">           </span><span class="k">AND</span><span class="w"> </span><span class="n">sicor_cop_basico</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sicor_operacao_basica_estado</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">           </span><span class="k">AND</span><span class="w"> </span><span class="n">sicor_cop_basico</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sicor_operacao_basica_estado</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="w">           </span><span class="k">AND</span><span class="w"> </span><span class="n">sicor_operacao_basica_estado</span><span class="p">.</span><span class="n">cd_empreendimento</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">empreendimento</span><span class="p">.</span><span class="n">cd_empreendimento</span>
<span class="w">           </span><span class="k">AND</span><span class="w"> </span><span class="n">empreendimento</span><span class="p">.</span><span class="n">finalidade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;custeio&#39;</span>
<span class="w">           </span><span class="k">AND</span><span class="w"> </span><span class="n">empreendimento</span><span class="p">.</span><span class="n">atividade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;agrícola&#39;</span>
<span class="w">           </span><span class="k">AND</span><span class="w"> </span><span class="n">empreendimento</span><span class="p">.</span><span class="n">modalidade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;lavoura&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span><span class="w"> </span><span class="n">produto</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ano</span><span class="p">,</span><span class="w"> </span><span class="n">media_area</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</pre></div>
</div>
</div></div>
</details><details class="summary-resultado">
<summary>Resultado:</summary><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-11-11-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-11-11-0" name="11-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-11-11-0" class="sphinx-tabs-panel" id="panel-11-11-0" name="11-0" role="tabpanel" tabindex="0"><div class="highlight-text notranslate"><div class="highlight"><pre><span></span> ano  |                    produto                    | num_pedidos_proagro | menor_valor_emprestado | maior_valor_emprestado | media_valor_emprestado | menor_area | maior_area |       media_area
------+-----------------------------------------------+---------------------+------------------------+------------------------+------------------------+------------+------------+------------------------
 2013 | sorgo                                         |                   4 |               20000.00 |              151258.20 |     62567.300000000000 |      35.00 |     240.00 |    96.2500000000000000
 2013 | amendoim                                      |                   2 |               74134.52 |              300000.00 |    187067.260000000000 |      24.00 |      91.00 |    57.5000000000000000
 2013 | algodão                                       |                   1 |              100000.00 |              100000.00 |    100000.000000000000 |      55.00 |      55.00 |    55.0000000000000000
 2013 | trigo                                         |                6824 |                1445.00 |              300000.00 |     37778.650781066823 |       1.70 |     392.00 |    37.2841984173505275
 2013 | aveia                                         |                  13 |                1982.88 |              102891.34 |     28646.108461538462 |       2.70 |     125.00 |    37.0000000000000000
 2013 | girassol                                      |                   3 |               12596.18 |               78786.43 |     36477.413333333333 |      13.00 |      72.00 |    34.6333333333333333
 2013 | canola                                        |                  92 |                3065.08 |              189288.00 |     28773.830326086957 |       4.00 |     220.00 |    32.7082608695652174
 2013 | cacau                                         |                   1 |               35595.56 |               35595.56 |     35595.560000000000 |      28.60 |      28.60 |    28.6000000000000000
 2013 | cana-de-açucar                                |                   9 |               16113.68 |              152002.62 |     59680.486666666667 |       8.00 |      56.00 |    23.8055555555555556
 2013 | arroz                                         |                  94 |                3200.00 |              175001.97 |     40832.886063829787 |       2.00 |     208.00 |    21.0656382978723404
 2013 | soja                                          |                8341 |                 850.00 |              300000.00 |     22765.472341445870 |       1.00 |    1000.00 |    20.3837585421412301
 2013 | cevada                                        |                  15 |                2490.00 |               63105.11 |     17998.629333333333 |       3.00 |      62.00 |    18.9666666666666667
 2013 | milho                                         |               12792 |                1000.00 |              300000.00 |     23248.158010475297 |       0.80 |     309.00 |    17.9366197623514697
 2013 | mandioca (aipim, macaxeira)                   |                 335 |                1845.96 |              300000.00 |     47686.844447761194 |       1.00 |     124.09 |    16.6392835820895522
 2013 | feijão                                        |                1313 |                 418.23 |              300000.00 |     15721.824691546078 |       0.30 |     200.00 |    10.5115689261233816
 2013 | manga                                         |                   2 |               31500.00 |               80000.00 |     55750.000000000000 |       6.00 |      15.00 |    10.5000000000000000
 2013 | tangerina                                     |                   3 |                7920.00 |               12600.00 | 10573.3333333333333333 |       6.00 |       9.00 |     7.6666666666666667
 2013 | banana                                        |                  43 |                5940.83 |              162277.71 |     33801.447209302326 |       1.50 |      26.00 |     6.1334883720930233
  ... | ...                                           |                 ... |                    ... |                    ... |                    ... |        ... |        ... |
 2024 | soja                                          |                 146 |                5000.00 |              321723.73 |     56505.768904109589 |       1.76 |      87.69 |    12.9967808219178082
 2024 | milho                                         |                 548 |                3120.00 |              331679.97 |     35064.199343065693 |       0.73 |      84.70 |     7.8008211678832117
 2024 | milho silagem                                 |                   9 |                9243.00 |               55788.11 |     29505.624444444444 |       1.58 |       8.50 |     4.9377777777777778
 2024 | melancia                                      |                   1 |               36501.00 |               36501.00 |     36501.000000000000 |       4.60 |       4.60 |     4.6000000000000000
 2024 | beterraba                                     |                  31 |               19000.00 |              248400.00 |     72732.137741935484 |       0.84 |      10.83 |     3.5812903225806452
 2024 | café                                          |                  18 |               33782.91 |              180156.79 |     86608.560000000000 |       1.05 |       8.92 |     3.3883333333333333
 2024 | abóbora-moranga                               |                  28 |                6000.00 |               85800.00 |     34254.451785714286 |       1.00 |       8.00 |     3.3371428571428571
 2024 | sorgo                                         |                   1 |               17580.00 |               17580.00 | 17580.0000000000000000 |       2.99 |       2.99 |     2.9900000000000000
 2024 | couve-flor                                    |                   2 |               18000.00 |               78400.00 |     48200.000000000000 |       1.50 |       3.91 |     2.7050000000000000
 2024 | caqui                                         |                   2 |               43048.23 |               55000.00 |     49024.115000000000 |       2.60 |       2.74 |     2.6700000000000000
 2024 | repolho                                       |                   2 |               23867.35 |               33488.06 |     28677.705000000000 |       1.00 |       3.60 |     2.3000000000000000
 2024 | cenoura                                       |                   2 |               68000.00 |               70525.00 |     69262.500000000000 |       2.00 |       2.18 |     2.0900000000000000
 2024 | brócolos (brócolis)                           |                   5 |               16000.00 |               32053.88 |     24039.116000000000 |       1.31 |       2.99 |     1.9600000000000000
 2024 | tomate                                        |                  38 |               10194.87 |              247500.00 |     91838.797368421053 |       0.11 |       4.49 |     1.5828947368421053
 2024 | batata-doce                                   |                   1 |               15000.00 |               15000.00 | 15000.0000000000000000 |       1.50 |       1.50 | 1.50000000000000000000
 2024 | uva                                           |                   2 |                9819.52 |               21105.00 |     15462.260000000000 |       0.87 |       2.06 | 1.46500000000000000000
 2024 | pimentão                                      |                   4 |               31383.33 |               71500.00 |     47432.587500000000 |       0.19 |       1.30 | 0.89500000000000000000
 2024 | berinjela                                     |                   1 |               28428.47 |               28428.47 |     28428.470000000000 |       0.60 |       0.60 | 0.60000000000000000000
 2024 | pepino                                        |                  10 |                6218.09 |              110000.00 |     48276.933000000000 |       0.15 |       1.00 | 0.49100000000000000000
(763 rows)
</pre></div>
</div>
</div></div>
</details><hr class="docutils" />
<p><strong>Consulta 7.</strong> Qual a localização das glebas associadas a pedidos de Proagro nos últimos três anos?</p>
<details class="summary-solucao">
<summary>Solução:</summary><p>A tabela <code class="docutils literal notranslate"><span class="pre">sicor_complemento_operacao_basica</span></code> contém uma coluna que possui o código do IBGE associado ao município da operação contratada. Dessa forma, vamos começar pela construção de uma consulta que calcule o número de pedidos de Proagro por municipio.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-12-12-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-12-12-0" name="12-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-12-12-0" class="sphinx-tabs-panel" id="panel-12-12-0" name="12-0" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">geocodigo</span><span class="p">,</span>
<span class="w">         </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_pedidos_proagro</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="w">      </span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">cop</span><span class="p">.</span><span class="n">ref_bacen</span><span class="p">,</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">nu_ordem</span><span class="p">)</span>
<span class="w">             </span><span class="n">cd_ibge_municipio</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">geocodigo</span>
<span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_cop_basico</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">cop</span><span class="p">,</span>
<span class="w">             </span><span class="n">sicor_complemento_operacao_basica</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">op_complemento</span>
<span class="w">       </span><span class="k">WHERE</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">         </span><span class="k">AND</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="w">         </span><span class="k">AND</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">dt_comunicacao</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2022</span>
<span class="w">    </span><span class="p">)</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">geocodigo</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">num_pedidos_proagro</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</pre></div>
</div>
</div></div>
<p>Agora, vamos acrescentar quatro novas colunas à tabela <code class="docutils literal notranslate"><span class="pre">municipios_2022</span></code>:</p>
<ul class="open">
<li><p><code class="docutils literal notranslate"><span class="pre">num_pedidos_proagro</span></code>: número total de pedidos de Proagro associado ao município.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valor_financiamento</span></code>: valor total associado aos contratos de finaciamento no município.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_pedidos_deferidos_proagro</span></code>: número total de pedidos deferidos de Proagro no município.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valor_financiamento_pedidos_deferidos</span></code>: valor total dos contratos que tiveream pedidos deferidos de Proagro no município.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valor_pago_proagro</span></code>: valor total pago de Proagro no município.</p></li>
</ul>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-13-13-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-13-13-0" name="13-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-13-13-0" class="sphinx-tabs-panel" id="panel-13-13-0" name="13-0" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">municipios_2022</span>
<span class="w">    </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">num_pedidos_proagro</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">valor_financiamento</span><span class="w"> </span><span class="nb">NUMERIC</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">num_pedidos_deferidos_proagro</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">valor_financiamento_pedidos_deferidos</span><span class="w"> </span><span class="nb">NUMERIC</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">valor_pago_proagro</span><span class="w"> </span><span class="nb">NUMERIC</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
</div></div>
<p>Agora podemos atualizar as colunas <code class="docutils literal notranslate"><span class="pre">num_pedidos_proagro</span></code> e <code class="docutils literal notranslate"><span class="pre">valor_financiamento</span></code> com o seguinte comando SQL:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-14-14-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-14-14-0" name="14-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-14-14-0" class="sphinx-tabs-panel" id="panel-14-14-0" name="14-0" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">municipios_2022</span>
<span class="w">   </span><span class="k">SET</span><span class="w"> </span><span class="n">num_pedidos_proagro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resultado</span><span class="p">.</span><span class="n">num_pedidos_proagro</span><span class="p">,</span>
<span class="w">       </span><span class="n">valor_financiamento</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resultado</span><span class="p">.</span><span class="n">valor_financiamento</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="k">SELECT</span><span class="w"> </span><span class="n">geocodigo</span><span class="p">,</span>
<span class="w">                 </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_pedidos_proagro</span><span class="p">,</span>
<span class="w">                 </span><span class="k">SUM</span><span class="p">(</span><span class="n">valor_financiamento</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">valor_financiamento</span>
<span class="w">            </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="w">              </span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">cop</span><span class="p">.</span><span class="n">ref_bacen</span><span class="p">,</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">nu_ordem</span><span class="p">)</span>
<span class="w">                     </span><span class="n">cd_ibge_municipio</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">geocodigo</span><span class="p">,</span>
<span class="w">                     </span><span class="n">op</span><span class="p">.</span><span class="n">vl_parc_credito</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">valor_financiamento</span>
<span class="w">                </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_cop_basico</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">cop</span><span class="p">,</span>
<span class="w">                     </span><span class="n">sicor_complemento_operacao_basica</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">,</span>
<span class="w">                     </span><span class="n">sicor_operacao_basica_estado</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">op</span>
<span class="w">               </span><span class="k">WHERE</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">dt_comunicacao</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2022</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">geocodigo</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">resultado</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">municipios_2022</span><span class="p">.</span><span class="n">cd_mun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resultado</span><span class="p">.</span><span class="n">geocodigo</span><span class="p">;</span>
</pre></div>
</div>
</div></div>
<p>Em seguida, podemos atualizar as colunas <code class="docutils literal notranslate"><span class="pre">num_pedidos_deferidos_proagro</span></code> e <code class="docutils literal notranslate"><span class="pre">valor_financiamento_pedidos_deferidos</span></code>:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-15-15-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-15-15-0" name="15-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-15-15-0" class="sphinx-tabs-panel" id="panel-15-15-0" name="15-0" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">municipios_2022</span>
<span class="w">   </span><span class="k">SET</span><span class="w"> </span><span class="n">num_pedidos_deferidos_proagro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resultado</span><span class="p">.</span><span class="n">num_pedidos_deferidos_proagro</span><span class="p">,</span>
<span class="w">       </span><span class="n">valor_financiamento_pedidos_deferidos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resultado</span><span class="p">.</span><span class="n">valor_financiamento_pedidos_deferidos</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="k">SELECT</span><span class="w"> </span><span class="n">geocodigo</span><span class="p">,</span>
<span class="w">                 </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_pedidos_deferidos_proagro</span><span class="p">,</span>
<span class="w">                 </span><span class="k">SUM</span><span class="p">(</span><span class="n">valor_financiamento</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">valor_financiamento_pedidos_deferidos</span>
<span class="w">            </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="w">              </span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">cop</span><span class="p">.</span><span class="n">ref_bacen</span><span class="p">,</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">nu_ordem</span><span class="p">)</span>
<span class="w">                     </span><span class="n">cd_ibge_municipio</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">geocodigo</span><span class="p">,</span>
<span class="w">                     </span><span class="n">op</span><span class="p">.</span><span class="n">vl_parc_credito</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">valor_financiamento</span>
<span class="w">                </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_cop_basico</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">cop</span><span class="p">,</span>
<span class="w">                     </span><span class="n">statuscopproagro</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">status</span><span class="p">,</span>
<span class="w">                     </span><span class="n">sicor_complemento_operacao_basica</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">,</span>
<span class="w">                     </span><span class="n">sicor_operacao_basica_estado</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">op</span>
<span class="w">               </span><span class="k">WHERE</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">dt_comunicacao</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2022</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">cop</span><span class="p">.</span><span class="n">cd_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">.</span><span class="n">cd_status</span>
<span class="w">                 </span><span class="k">AND</span><span class="w"> </span><span class="n">status</span><span class="p">.</span><span class="n">descricao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;deferida&#39;</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">geocodigo</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">resultado</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">municipios_2022</span><span class="p">.</span><span class="n">cd_mun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resultado</span><span class="p">.</span><span class="n">geocodigo</span><span class="p">;</span>
</pre></div>
</div>
</div></div>
<p>Por último, podemos calcular o valor pago de Proagro por município, atualizando a coluna <code class="docutils literal notranslate"><span class="pre">valor_pago_proagro</span></code>:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-16-16-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-16-16-0" name="16-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-16-16-0" class="sphinx-tabs-panel" id="panel-16-16-0" name="16-0" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">municipios_2022</span>
<span class="w">   </span><span class="k">SET</span><span class="w"> </span><span class="n">valor_pago_proagro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resultado</span><span class="p">.</span><span class="n">valor_pago_proagro</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="w">          </span><span class="k">SELECT</span><span class="w"> </span><span class="n">cd_ibge_municipio</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">geocodigo</span><span class="p">,</span>
<span class="w">                 </span><span class="k">SUM</span><span class="p">(</span><span class="n">parcelas</span><span class="p">.</span><span class="n">vl_pago</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">natureza</span><span class="p">.</span><span class="n">sinal</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">valor_pago_proagro</span>
<span class="w">            </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="w">              </span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">ref_bacen</span><span class="p">,</span><span class="w"> </span><span class="n">nu_ordem</span><span class="p">)</span>
<span class="w">                     </span><span class="n">ref_bacen</span><span class="p">,</span>
<span class="w">                     </span><span class="n">nu_ordem</span>
<span class="w">                </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_cop_basico</span>
<span class="w">               </span><span class="k">WHERE</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dt_comunicacao</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2022</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">pedidos_proagro</span><span class="p">,</span>
<span class="w">                 </span><span class="n">sicor_parcelas_proagro</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">parcelas</span><span class="p">,</span>
<span class="w">                 </span><span class="n">sicor_complemento_operacao_basica</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">,</span>
<span class="w">                 </span><span class="n">naturezaproagro</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">natureza</span>
<span class="w">           </span><span class="k">WHERE</span><span class="w"> </span><span class="n">pedidos_proagro</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parcelas</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">             </span><span class="k">AND</span><span class="w"> </span><span class="n">pedidos_proagro</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parcelas</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="w">             </span><span class="k">AND</span><span class="w"> </span><span class="n">pedidos_proagro</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">             </span><span class="k">AND</span><span class="w"> </span><span class="n">pedidos_proagro</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="w">             </span><span class="k">AND</span><span class="w"> </span><span class="n">parcelas</span><span class="p">.</span><span class="n">cd_natureza_parcela</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">natureza</span><span class="p">.</span><span class="n">cd_natureza_parcela</span>
<span class="w">        </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">geocodigo</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">resultado</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">municipios_2022</span><span class="p">.</span><span class="n">cd_mun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resultado</span><span class="p">.</span><span class="n">geocodigo</span><span class="p">;</span>
</pre></div>
</div>
</div></div>
<p>O resultado dos cálculos realizados pode ser visto nos mapas apresentados nas figuras da <a class="reference internal" href="#tbl-sicor-microdados-proagro-numero-pedidos-x-valor-pago"><span class="std std-numref">Tabela 3.25</span></a>.</p>
<table class="styled-table docutils align-center" id="tbl-sicor-microdados-proagro-numero-pedidos-x-valor-pago" style="width: 100%">
<caption><span class="caption-number">Tabela 3.25 - </span><span class="caption-text">Mapa da distribuição dos pedidos de Proagro.</span><a class="headerlink" href="#tbl-sicor-microdados-proagro-numero-pedidos-x-valor-pago" title="Link Permanente para essa tabela"></a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td class="center-align"><p><strong>(a) Número de pedidos de Proagro por município</strong></p></td>
<td class="center-align"><p><strong>(b) Valor pago pelo Proagro em cada município</strong></p></td>
</tr>
<tr class="row-even"><td class="center-align"><p><img alt="fig:sicor:microdados:proagro:proagro-numero-pedidos-municipio" src="../../_images/proagro-numero-pedidos-municipio.png" /></p></td>
<td class="center-align"><p><img alt="fig:sicor:microdados:proagro:proagro-valor-pago-municipio" src="../../_images/proagro-valor-pago-municipio.png" /></p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Dica</p>
<p>Sempre que construimos uma consulta, é importante fazer uma checagem do seu resultado. No caso acima, uma boa base é saber o número de municípios entre 2022 e 2024 que estão associados aos pedidos de Proagro. Para saber o número de municípios, podemos construir uma ocnsulta como:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">cd_ibge_municipio</span>

<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_cop_basico</span><span class="p">,</span>
<span class="w">       </span><span class="n">sicor_complemento_operacao_basica</span>

<span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sicor_cop_basico</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sicor_complemento_operacao_basica</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">   </span><span class="k">AND</span><span class="w"> </span><span class="n">sicor_cop_basico</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sicor_complemento_operacao_basica</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="w">   </span><span class="k">AND</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dt_comunicacao</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2022</span><span class="p">;</span>
</pre></div>
</div>
</div>
</details><hr class="docutils" />
<p><strong>Consulta 8.</strong> Qual o percentual de pedidos de Proagro por município em relação ao número de financiamentos?</p>
<details class="summary-solucao">
<summary>Solução:</summary><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-17-17-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-17-17-0" name="17-0" role="tab" tabindex="0">SQL</button></div><div aria-labelledby="tab-17-17-0" class="sphinx-tabs-panel" id="panel-17-17-0" name="17-0" role="tabpanel" tabindex="0"><p>Vamos acrescentar uma coluna chamada <code class="docutils literal notranslate"><span class="pre">num_contratos</span></code> na tabela <code class="docutils literal notranslate"><span class="pre">municipios_2022</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">municipios_2022</span>
<span class="w">    </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">num_contratos</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>Para preencher essa nova coluna podemos utilizar a seguinte sentença SQL:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">municipios_2022</span>
<span class="w">   </span><span class="k">SET</span><span class="w"> </span><span class="n">num_contratos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resultado</span><span class="p">.</span><span class="n">num_contratos</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">.</span><span class="n">cd_ibge_municipio</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">geocodigo</span><span class="p">,</span>
<span class="w">               </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_contratos</span>
<span class="w">          </span><span class="k">FROM</span><span class="w"> </span><span class="n">sicor_operacao_basica_estado</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">op</span><span class="p">,</span>
<span class="w">               </span><span class="n">sicor_complemento_operacao_basica</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">op_complemento</span>
<span class="w">         </span><span class="k">WHERE</span><span class="w"> </span><span class="n">op</span><span class="p">.</span><span class="n">ref_bacen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">.</span><span class="n">ref_bacen</span>
<span class="w">           </span><span class="k">AND</span><span class="w"> </span><span class="n">op</span><span class="p">.</span><span class="n">nu_ordem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">.</span><span class="n">nu_ordem</span>
<span class="w">           </span><span class="k">AND</span><span class="w"> </span><span class="k">extract</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">op</span><span class="p">.</span><span class="n">dt_emissao</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2022</span>
<span class="w">      </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">op_complemento</span><span class="p">.</span><span class="n">cd_ibge_municipio</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">resultado</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">municipios_2022</span><span class="p">.</span><span class="n">cd_mun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resultado</span><span class="p">.</span><span class="n">geocodigo</span><span class="p">;</span>
</pre></div>
</div>
<p>Agora, podemos fazer uma consulta envolvendo as colunas <code class="docutils literal notranslate"><span class="pre">num_pedidos_proagro</span></code> e <code class="docutils literal notranslate"><span class="pre">num_contratos</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">cd_mun</span><span class="p">,</span><span class="w"> </span><span class="n">nm_mun</span><span class="p">,</span><span class="w"> </span><span class="n">sigla_uf</span><span class="p">,</span>
<span class="w">         </span><span class="n">num_pedidos_proagro</span><span class="p">,</span>
<span class="w">         </span><span class="n">num_contratos</span><span class="p">,</span>
<span class="w">         </span><span class="n">num_pedidos_proagro</span><span class="p">::</span><span class="nb">numeric</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">num_contratos</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">proporcao_pedidos</span>

<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">municipios_2022</span>

<span class="w">   </span><span class="k">WHERE</span><span class="w"> </span><span class="n">num_contratos</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span>

<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">proporcao_pedidos</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</pre></div>
</div>
<p>Resultado:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> cd_mun  |              nm_mun              | sigla_uf | num_pedidos_proagro | num_contratos |     proporcao_pedidos
---------+----------------------------------+----------+---------------------+---------------+----------------------------
 3106705 | Betim                            | MG       |                   2 |             2 |     1.00000000000000000000
 4119004 | Pérola d&#39;Oeste                   | PR       |                2623 |          3639 |     0.72080241824677109096
 4106571 | Cruzeiro do Iguaçu               | PR       |                 930 |          1408 |     0.66051136363636363636
 4124806 | São João                         | PR       |                2459 |          3824 |     0.64304393305439330544
 4128609 | Verê                             | PR       |                2916 |          4592 |     0.63501742160278745645
 4309753 | Ibarama                          | RS       |                 738 |          1164 |     0.63402061855670103093
 4322152 | Tunas                            | RS       |                 802 |          1268 |     0.63249211356466876972
 4103024 | Boa Esperança do Iguaçu          | PR       |                1168 |          1856 |     0.62931034482758620690
 4102752 | Bela Vista da Caroba             | PR       |                 944 |          1506 |     0.62682602921646746348
 4103222 | Bom Sucesso do Sul               | PR       |                 931 |          1502 |     0.61984021304926764314
 4301206 | Arroio do Tigre                  | RS       |                3007 |          4857 |     0.61910644430718550546
 4125209 | São Jorge d&#39;Oeste                | PR       |                2347 |          3792 |     0.61893459915611814346
 4311254 | Lagoão                           | RS       |                1064 |          1721 |     0.61824520627542126671
     ... | ...                              | ...      |                 ... |           ... |                        ...
</pre></div>
</div>
</div></div>
</details></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Rodapé">
        <a href="glebas-forma.html" class="btn btn-neutral float-left" title="3.1.12. Avaliação da Forma das Glebas" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="mutuarios.html" class="btn btn-neutral float-right" title="3.1.14. Mutuários" accesskey="n" rel="next">Próximo <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Time.</p>
  </div>

  
<jinja2.runtime.BlockReference object at 0x7fbc2aaafa90>
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-nc-sa.png" width="117" height="41"/></a> This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons “Attribution-NonCommercial-ShareAlike 4.0 International” license</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>